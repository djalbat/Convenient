"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = onETX;

var _constants = require("../../constants");

function onETX(handler) {
  var event = _constants.DATA_EVENT;

  if (process.stdin.setRawMode) {
    var rawMode = true,
        encoding = _constants.UTF8_ENCODING;
    process.stdin.setRawMode(rawMode);
    process.stdin.setEncoding(encoding);
    process.stdin.resume();
    process.stdin.addListener(event, dataHandler);
    return offExt;
  }

  function offExt() {
    process.stdin.removeListener(event, dataHandler);
  }

  function dataHandler(character) {
    if (character === _constants.ETX_CHARACTER) {
      handler();
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9uRVRYLmpzIl0sIm5hbWVzIjpbIm9uRVRYIiwiaGFuZGxlciIsImV2ZW50IiwiREFUQV9FVkVOVCIsInByb2Nlc3MiLCJzdGRpbiIsInNldFJhd01vZGUiLCJyYXdNb2RlIiwiZW5jb2RpbmciLCJVVEY4X0VOQ09ESU5HIiwic2V0RW5jb2RpbmciLCJyZXN1bWUiLCJhZGRMaXN0ZW5lciIsImRhdGFIYW5kbGVyIiwib2ZmRXh0IiwicmVtb3ZlTGlzdGVuZXIiLCJjaGFyYWN0ZXIiLCJFVFhfQ0hBUkFDVEVSIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQUVBOztBQUVlLFNBQVNBLEtBQVQsQ0FBZUMsT0FBZixFQUF3QjtBQUNyQyxNQUFNQyxLQUFLLEdBQUdDLHFCQUFkOztBQUVBLE1BQUlDLE9BQU8sQ0FBQ0MsS0FBUixDQUFjQyxVQUFsQixFQUE4QjtBQUM1QixRQUFNQyxPQUFPLEdBQUcsSUFBaEI7QUFBQSxRQUNNQyxRQUFRLEdBQUdDLHdCQURqQjtBQUdBTCxJQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBY0MsVUFBZCxDQUF5QkMsT0FBekI7QUFDQUgsSUFBQUEsT0FBTyxDQUFDQyxLQUFSLENBQWNLLFdBQWQsQ0FBMEJGLFFBQTFCO0FBRUFKLElBQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjTSxNQUFkO0FBRUFQLElBQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjTyxXQUFkLENBQTBCVixLQUExQixFQUFpQ1csV0FBakM7QUFFQSxXQUFPQyxNQUFQO0FBQ0Q7O0FBRUQsV0FBU0EsTUFBVCxHQUFrQjtBQUNoQlYsSUFBQUEsT0FBTyxDQUFDQyxLQUFSLENBQWNVLGNBQWQsQ0FBNkJiLEtBQTdCLEVBQW9DVyxXQUFwQztBQUNEOztBQUVELFdBQVNBLFdBQVQsQ0FBcUJHLFNBQXJCLEVBQWdDO0FBQzlCLFFBQUlBLFNBQVMsS0FBS0Msd0JBQWxCLEVBQWlDO0FBQy9CaEIsTUFBQUEsT0FBTztBQUNSO0FBQ0Y7QUFDRiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgeyBEQVRBX0VWRU5ULCBFVFhfQ0hBUkFDVEVSLCBVVEY4X0VOQ09ESU5HIH0gZnJvbSBcIi4uLy4uL2NvbnN0YW50c1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBvbkVUWChoYW5kbGVyKSB7XG4gIGNvbnN0IGV2ZW50ID0gREFUQV9FVkVOVDtcblxuICBpZiAocHJvY2Vzcy5zdGRpbi5zZXRSYXdNb2RlKSB7XG4gICAgY29uc3QgcmF3TW9kZSA9IHRydWUsXG4gICAgICAgICAgZW5jb2RpbmcgPSBVVEY4X0VOQ09ESU5HO1xuXG4gICAgcHJvY2Vzcy5zdGRpbi5zZXRSYXdNb2RlKHJhd01vZGUpO1xuICAgIHByb2Nlc3Muc3RkaW4uc2V0RW5jb2RpbmcoZW5jb2RpbmcpO1xuXG4gICAgcHJvY2Vzcy5zdGRpbi5yZXN1bWUoKTtcblxuICAgIHByb2Nlc3Muc3RkaW4uYWRkTGlzdGVuZXIoZXZlbnQsIGRhdGFIYW5kbGVyKTtcblxuICAgIHJldHVybiBvZmZFeHQ7XG4gIH1cblxuICBmdW5jdGlvbiBvZmZFeHQoKSB7XG4gICAgcHJvY2Vzcy5zdGRpbi5yZW1vdmVMaXN0ZW5lcihldmVudCwgZGF0YUhhbmRsZXIpO1xuICB9XG5cbiAgZnVuY3Rpb24gZGF0YUhhbmRsZXIoY2hhcmFjdGVyKSB7XG4gICAgaWYgKGNoYXJhY3RlciA9PT0gRVRYX0NIQVJBQ1RFUikge1xuICAgICAgaGFuZGxlcigpO1xuICAgIH1cbiAgfVxufVxuIl19