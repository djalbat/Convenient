'use strict';

var array = require('./array');

var first = array.first,
    second = array.second,
    last = array.last;


function isPathRelativePath(path) {
  var position = path.search(/^\.{1,2}\//),
      pathRelativePath = position !== -1;

  return pathRelativePath;
}

function isPathAbsolutePath(path) {
  var pathRelativePath = isPathRelativePath(path),
      pathAbsolutePath = !pathRelativePath; ///

  return pathAbsolutePath;
}

function isPathTopmostDirectoryName(path) {
  var position = path.search(/^[^\/]+\/?$/),
      pathTopmostDirectoryName = position !== -1;

  return pathTopmostDirectoryName;
}

function isTopmostDirectoryNameContainedInPath(topmostDirectoryName, path) {
  topmostDirectoryName = topmostDirectoryName.replace(/\/$/, ''); ///

  var regExp = new RegExp('^' + topmostDirectoryName + '(?:\\/.+)?$'),
      position = path.search(regExp),
      topmostDirectoryNameContainedInFilePath = position !== -1;

  return topmostDirectoryNameContainedInFilePath;
}

function combinePaths(directoryPath, relativePath) {
  var absolutePath = null;

  var directoryPathSubEntryNames = directoryPath.split('/'),
      relativeFilePathSubEntryNames = relativePath.split('/');

  var firstRelativeFilePathSubEntryName = first(relativeFilePathSubEntryNames),
      lastDirectoryPathSubEntryName = void 0;

  if (firstRelativeFilePathSubEntryName === '.') {
    relativeFilePathSubEntryNames.shift();
  }

  firstRelativeFilePathSubEntryName = first(relativeFilePathSubEntryNames);
  lastDirectoryPathSubEntryName = last(directoryPathSubEntryNames);

  while (firstRelativeFilePathSubEntryName === '..' && lastDirectoryPathSubEntryName !== undefined) {
    relativeFilePathSubEntryNames.shift();
    directoryPathSubEntryNames.pop();

    firstRelativeFilePathSubEntryName = first(relativeFilePathSubEntryNames);
    lastDirectoryPathSubEntryName = last(directoryPathSubEntryNames);
  }

  if (lastDirectoryPathSubEntryName !== undefined) {
    var absoluteFilePathSubEntryNames = [].concat(directoryPathSubEntryNames).concat(relativeFilePathSubEntryNames);

    absolutePath = absoluteFilePathSubEntryNames.join('/');
  }

  return absolutePath;
}

function concatenatePaths(path1, path2) {
  path1 = pathWithoutTrailingSlashFromPath(path1); ///

  var combinedPath = path1 + '/' + path2;

  return combinedPath;
}

function bottommostNameFromPath(path) {
  var bottommostName = null;

  var matches = path.match(/^.*\/([^\/]+\/?)$/);

  if (matches !== null) {
    var secondMatch = second(matches);

    bottommostName = secondMatch; ///
  }

  return bottommostName;
}

function topmostDirectoryPathFromPath(path) {
  var matches = path.match(/^(.*)\/[^\/]+\/?$/),
      secondMatch = second(matches),
      directoryPath = secondMatch; ///

  return directoryPath;
}

function topmostDirectoryNameFromPath(path) {
  var topmostDirectoryName = null;

  var matches = path.match(/^([^\/]*)\//);

  if (matches !== null) {
    var secondMatch = second(matches);

    topmostDirectoryName = secondMatch; ///
  }

  return topmostDirectoryName;
}

function pathWithoutTrailingSlashFromPath(path) {
  var pathWithoutTrailingSlash = path.replace(/\/$/, '');

  return pathWithoutTrailingSlash;
}

function pathWithoutBottommostNameFromPath(path) {
  var pathWithoutBottommostName = null;

  var matches = path.match(/(^.*)\/[^\/]*$/);

  if (matches !== null) {
    var secondMatch = second(matches);

    pathWithoutBottommostName = secondMatch; ///
  }

  return pathWithoutBottommostName;
}

function pathWithoutTopmostDirectoryNameFromPath(path) {
  var pathWithoutTopmostDirectoryName = null;

  var matches = path.match(/^[^\/]*\/(.*)$/);

  if (matches !== null) {
    var secondMatch = second(matches);

    pathWithoutTopmostDirectoryName = secondMatch;
  }

  return pathWithoutTopmostDirectoryName;
}

module.exports = {
  isPathRelativePath: isPathRelativePath,
  isPathAbsolutePath: isPathAbsolutePath,
  isPathTopmostDirectoryName: isPathTopmostDirectoryName,
  isTopmostDirectoryNameContainedInPath: isTopmostDirectoryNameContainedInPath,
  combinePaths: combinePaths,
  concatenatePaths: concatenatePaths,
  bottommostNameFromPath: bottommostNameFromPath,
  topmostDirectoryPathFromPath: topmostDirectoryPathFromPath,
  topmostDirectoryNameFromPath: topmostDirectoryNameFromPath,
  pathWithoutTrailingSlashFromPath: pathWithoutTrailingSlashFromPath,
  pathWithoutBottommostNameFromPath: pathWithoutBottommostNameFromPath,
  pathWithoutTopmostDirectoryNameFromPath: pathWithoutTopmostDirectoryNameFromPath
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2VzNi9wYXRoLmpzIl0sIm5hbWVzIjpbImFycmF5IiwicmVxdWlyZSIsImZpcnN0Iiwic2Vjb25kIiwibGFzdCIsImlzUGF0aFJlbGF0aXZlUGF0aCIsInBhdGgiLCJwb3NpdGlvbiIsInNlYXJjaCIsInBhdGhSZWxhdGl2ZVBhdGgiLCJpc1BhdGhBYnNvbHV0ZVBhdGgiLCJwYXRoQWJzb2x1dGVQYXRoIiwiaXNQYXRoVG9wbW9zdERpcmVjdG9yeU5hbWUiLCJwYXRoVG9wbW9zdERpcmVjdG9yeU5hbWUiLCJpc1RvcG1vc3REaXJlY3RvcnlOYW1lQ29udGFpbmVkSW5QYXRoIiwidG9wbW9zdERpcmVjdG9yeU5hbWUiLCJyZXBsYWNlIiwicmVnRXhwIiwiUmVnRXhwIiwidG9wbW9zdERpcmVjdG9yeU5hbWVDb250YWluZWRJbkZpbGVQYXRoIiwiY29tYmluZVBhdGhzIiwiZGlyZWN0b3J5UGF0aCIsInJlbGF0aXZlUGF0aCIsImFic29sdXRlUGF0aCIsImRpcmVjdG9yeVBhdGhTdWJFbnRyeU5hbWVzIiwic3BsaXQiLCJyZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lcyIsImZpcnN0UmVsYXRpdmVGaWxlUGF0aFN1YkVudHJ5TmFtZSIsImxhc3REaXJlY3RvcnlQYXRoU3ViRW50cnlOYW1lIiwic2hpZnQiLCJ1bmRlZmluZWQiLCJwb3AiLCJhYnNvbHV0ZUZpbGVQYXRoU3ViRW50cnlOYW1lcyIsImNvbmNhdCIsImpvaW4iLCJjb25jYXRlbmF0ZVBhdGhzIiwicGF0aDEiLCJwYXRoMiIsInBhdGhXaXRob3V0VHJhaWxpbmdTbGFzaEZyb21QYXRoIiwiY29tYmluZWRQYXRoIiwiYm90dG9tbW9zdE5hbWVGcm9tUGF0aCIsImJvdHRvbW1vc3ROYW1lIiwibWF0Y2hlcyIsIm1hdGNoIiwic2Vjb25kTWF0Y2giLCJ0b3Btb3N0RGlyZWN0b3J5UGF0aEZyb21QYXRoIiwidG9wbW9zdERpcmVjdG9yeU5hbWVGcm9tUGF0aCIsInBhdGhXaXRob3V0VHJhaWxpbmdTbGFzaCIsInBhdGhXaXRob3V0Qm90dG9tbW9zdE5hbWVGcm9tUGF0aCIsInBhdGhXaXRob3V0Qm90dG9tbW9zdE5hbWUiLCJwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lRnJvbVBhdGgiLCJwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBTUEsUUFBUUMsUUFBUSxTQUFSLENBQWQ7O0lBRVFDLEssR0FBd0JGLEssQ0FBeEJFLEs7SUFBT0MsTSxHQUFpQkgsSyxDQUFqQkcsTTtJQUFRQyxJLEdBQVNKLEssQ0FBVEksSTs7O0FBRXZCLFNBQVNDLGtCQUFULENBQTRCQyxJQUE1QixFQUFrQztBQUNoQyxNQUFNQyxXQUFXRCxLQUFLRSxNQUFMLENBQVksWUFBWixDQUFqQjtBQUFBLE1BQ01DLG1CQUFvQkYsYUFBYSxDQUFDLENBRHhDOztBQUdBLFNBQU9FLGdCQUFQO0FBQ0Q7O0FBRUQsU0FBU0Msa0JBQVQsQ0FBNEJKLElBQTVCLEVBQWtDO0FBQ2hDLE1BQU1HLG1CQUFtQkosbUJBQW1CQyxJQUFuQixDQUF6QjtBQUFBLE1BQ01LLG1CQUFtQixDQUFDRixnQkFEMUIsQ0FEZ0MsQ0FFWTs7QUFFNUMsU0FBT0UsZ0JBQVA7QUFDRDs7QUFFRCxTQUFTQywwQkFBVCxDQUFvQ04sSUFBcEMsRUFBMEM7QUFDeEMsTUFBTUMsV0FBV0QsS0FBS0UsTUFBTCxDQUFZLGFBQVosQ0FBakI7QUFBQSxNQUNNSywyQkFBNEJOLGFBQWEsQ0FBQyxDQURoRDs7QUFHQSxTQUFPTSx3QkFBUDtBQUNEOztBQUVELFNBQVNDLHFDQUFULENBQStDQyxvQkFBL0MsRUFBcUVULElBQXJFLEVBQTJFO0FBQ3pFUyx5QkFBdUJBLHFCQUFxQkMsT0FBckIsQ0FBNkIsS0FBN0IsRUFBb0MsRUFBcEMsQ0FBdkIsQ0FEeUUsQ0FDVDs7QUFFaEUsTUFBTUMsU0FBUyxJQUFJQyxNQUFKLE9BQWVILG9CQUFmLGlCQUFmO0FBQUEsTUFDTVIs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QUVBLE1BQU1QLFVBQVVwQyxLQUFLcUMsS0FBTCxDQUFXLGdCQUFYLENBQWhCOztBQUVBLE1BQUlELFlBQVksSUFBaEIsRUFBc0I7QUFDcEIsUUFBTUUsY0FBY3pDLE9BQU91QyxPQUFQLENBQXBCOztBQUVBTyxnQ0FBNEJMLFdBQTVCLENBSG9CLENBR3FCO0FBQzFDOztBQUVELFNBQU9LLHlCQUFQO0FBQ0Q7O0FBRUQsU0FBU0MsdUNBQVQsQ0FBaUQ1QyxJQUFqRCxFQUF1RDtBQUNyRCxNQUFJNkMsa0NBQWtDLElBQXRDOztBQUVBLE1BQU1ULFVBQVVwQyxLQUFLcUMsS0FBTCxDQUFXLGdCQUFYLENBQWhCOztBQUVBLE1BQUlELFlBQVksSUFBaEIsRUFBc0I7QUFDcEIsUUFBTUUsY0FBY3pDLE9BQU91QyxPQUFQLENBQXBCOztBQUVBUyxzQ0FBa0NQLFdBQWxDO0FBQ0Q7O0FBRUQsU0FBT08sK0JBQVA7QUFDRDs7QUFFREMsT0FBT0MsT0FBUCxHQUFpQjtBQUNmaEQsc0JBQW9CQSxrQkFETDtBQUVmSyxzQkFBb0JBLGtCQUZMO0FBR2ZFLDhCQUE0QkEsMEJBSGI7QUFJZkUseUNBQXVDQSxxQ0FKeEI7QUFLZk0sZ0JBQWNBLFlBTEM7QUFNZmUsb0JBQWtCQSxnQkFOSDtBQU9mSywwQkFBd0JBLHNCQVBUO0FBUWZLLGdDQUE4QkEsNEJBUmY7QUFTZkMsZ0NBQThCQSw0QkFUZjtBQVVmUixvQ0FBa0NBLGdDQVZuQjtBQVdmVSxxQ0FBbUNBLGlDQVhwQjtBQVlmRSwyQ0FBeUNBO0FBWjFCLENBQWpCIiwiZmlsZSI6InBhdGguanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IGFycmF5ID0gcmVxdWlyZSgnLi9hcnJheScpO1xuXG5jb25zdCB7IGZpcnN0LCBzZWNvbmQsIGxhc3QgfSA9IGFycmF5O1xuXG5mdW5jdGlvbiBpc1BhdGhSZWxhdGl2ZVBhdGgocGF0aCkge1xuICBjb25zdCBwb3NpdGlvbiA9IHBhdGguc2VhcmNoKC9eXFwuezEsMn1cXC8vKSxcbiAgICAgICAgcGF0aFJlbGF0aXZlUGF0aCA9IChwb3NpdGlvbiAhPT0gLTEpO1xuXG4gIHJldHVybiBwYXRoUmVsYXRpdmVQYXRoO1xufVxuXG5mdW5jdGlvbiBpc1BhdGhBYnNvbHV0ZVBhdGgocGF0aCkge1xuICBjb25zdCBwYXRoUmVsYXRpdmVQYXRoID0gaXNQYXRoUmVsYXRpdmVQYXRoKHBhdGgpLFxuICAgICAgICBwYXRoQWJzb2x1dGVQYXRoID0gIXBhdGhSZWxhdGl2ZVBhdGg7IC8vL1xuXG4gIHJldHVybiBwYXRoQWJzb2x1dGVQYXRoO1xufVxuXG5mdW5jdGlvbiBpc1BhdGhUb3Btb3N0RGlyZWN0b3J5TmFtZShwYXRoKSB7XG4gIGNvbnN0IHBvc2l0aW9uID0gcGF0aC5zZWFyY2goL15bXlxcL10rXFwvPyQvKSxcbiAgICAgICAgcGF0aFRvcG1vc3REaXJlY3RvcnlOYW1lID0gKHBvc2l0aW9uICE9PSAtMSk7XG5cbiAgcmV0dXJuIHBhdGhUb3Btb3N0RGlyZWN0b3J5TmFtZTtcbn1cblxuZnVuY3Rpb24gaXNUb3Btb3N0RGlyZWN0b3J5TmFtZUNvbnRhaW5lZEluUGF0aCh0b3Btb3N0RGlyZWN0b3J5TmFtZSwgcGF0aCkge1xuICB0b3Btb3N0RGlyZWN0b3J5TmFtZSA9IHRvcG1vc3REaXJlY3RvcnlOYW1lLnJlcGxhY2UoL1xcLyQvLCAnJyk7IC8vL1xuXG4gIGNvbnN0IHJlZ0V4cCA9IG5ldyBSZWdFeHAoYF4ke3RvcG1vc3REaXJlY3RvcnlOYW1lfSg/OlxcXFwvLispPyRgKSxcbiAgICAgICAgcG9zaXRpb24gPSBwYXRoLnNlYXJjaChyZWdFeHApLFxuICAgICAgICB0b3Btb3N0RGlyZWN0b3J5TmFtZUNvbnRhaW5lZEluRmlsZVBhdGggPSAocG9zaXRpb24gIT09IC0xKTtcblxuICByZXR1cm4gdG9wbW9zdERpcmVjdG9yeU5hbWVDb250YWluZWRJbkZpbGVQYXRoO1xufVxuXG5mdW5jdGlvbiBjb21iaW5lUGF0aHMoZGlyZWN0b3J5UGF0aCwgcmVsYXRpdmVQYXRoKSB7XG4gIGxldCBhYnNvbHV0ZVBhdGggPSBudWxsO1xuXG4gIGNvbnN0IGRpcmVjdG9yeVBhdGhTdWJFbnRyeU5hbWVzID0gZGlyZWN0b3J5UGF0aC5zcGxpdCgnLycpLFxuICAgICAgICByZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lcyA9IHJlbGF0aXZlUGF0aC5zcGxpdCgnLycpO1xuXG4gIGxldCBmaXJzdFJlbGF0aXZlRmlsZVBhdGhTdWJFbnRyeU5hbWUgPSBmaXJzdChyZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lcyksXG4gICAgICBsYXN0RGlyZWN0b3J5UGF0aFN1YkVudHJ5TmFtZTtcblxuICBpZiAoZmlyc3RSZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lID09PSAnLicpIHtcbiAgICByZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lcy5zaGlmdCgpO1xuICB9XG5cbiAgZmlyc3RSZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lID0gZmlyc3QocmVsYXRpdmVGaWxlUGF0aFN1YkVudHJ5TmFtZXMpO1xuICBsYXN0RGlyZWN0b3J5UGF0aFN1YkVudHJ5TmFtZSA9IGxhc3QoZGlyZWN0b3J5UGF0aFN1YkVudHJ5TmFtZXMpO1xuXG4gIHdoaWxlICgoZmlyc3RSZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lID09PSAnLi4nKSAmJiAobGFzdERpcmVjdG9yeVBhdGhTdWJFbnRyeU5hbWUgIT09IHVuZGVmaW5lZCkpIHtcbiAgICByZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lcy5zaGlmdCgpO1xuICAgIGRpcmVjdG9yeVBhdGhTdWJFbnRyeU5hbWVzLnBvcCgpO1xuXG4gICAgZmlyc3RSZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lID0gZmlyc3QocmVsYXRpdmVGaWxlUGF0aFN1YkVudHJ5TmFtZXMpO1xuICAgIGxhc3REaXJlY3RvcnlQYXRoU3ViRW50cnlOYW1lID0gbGFzdChkaXJlY3RvcnlQYXRoU3ViRW50cnlOYW1lcyk7XG4gIH1cblxuICBpZiAobGFzdERpcmVjdG9yeVBhdGhTdWJFbnRyeU5hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgIGNvbnN0IGFic29sdXRlRmlsZVBhdGhTdWJFbnRyeU5hbWVzID0gW10uY29uY2F0KGRpcmVjdG9yeVBhdGhTdWJFbnRyeU5hbWVzKS5jb25jYXQocmVsYXRpdmVGaWxlUGF0aFN1YkVudHJ5TmFtZXMpO1xuXG4gICAgYWJzb2x1dGVQYXRoID0gYWJzb2x1dGVGaWxlUGF0aFN1YkVudHJ5TmFtZXMuam9pbignLycpO1xuICB9XG5cbiAgcmV0dXJuIGFic29sdXRlUGF0aDtcbn1cblxuZnVuY3Rpb24gY29uY2F0ZW5hdGVQYXRocyhwYXRoMSwgcGF0aDIpIHtcbiAgcGF0aDEgPSBwYXRoV2l0aG91dFRyYWlsaW5nU2xhc2hGcm9tUGF0aChwYXRoMSk7ICAvLy9cblxuICBjb25zdCBjb21iaW5lZFBhdGggPSBgJHtwYXRoMX0vJHtwYXRoMn1gO1xuXG4gIHJldHVybiBjb21iaW5lZFBhdGg7XG59XG5cbmZ1bmN0aW9uIGJvdHRvbW1vc3ROYW1lRnJvbVBhdGgocGF0aCkge1xuICBsZXQgYm90dG9tbW9zdE5hbWUgPSBudWxsO1xuXG4gIGNvbnN0IG1hdGNoZXMgPSBwYXRoLm1hdGNoKC9eLipcXC8oW15cXC9dK1xcLz8pJC8pO1xuXG4gIGlmIChtYXRjaGVzICE9PSBudWxsKSB7XG4gICAgY29uc3Qgc2Vjb25kTWF0Y2ggPSBzZWNvbmQobWF0Y2hlcyk7XG5cbiAgICBib3R0b21tb3N0TmFtZSA9IHNlY29uZE1hdGNoOyAgLy8vXG4gIH1cblxuICByZXR1cm4gYm90dG9tbW9zdE5hbWU7XG59XG5cbmZ1bmN0aW9uIHRvcG1vc3REaXJlY3RvcnlQYXRoRnJvbVBhdGgocGF0aCkge1xuICBjb25zdCBtYXRjaGVzID0gcGF0aC5tYXRjaCgvXiguKilcXC9bXlxcL10rXFwvPyQvKSxcbiAgICAgICAgc2Vjb25kTWF0Y2ggPSBzZWNvbmQobWF0Y2hlcyksXG4gICAgICAgIGRpcmVjdG9yeVBhdGggPSBzZWNvbmRNYXRjaDsgLy8vXG5cbiAgcmV0dXJuIGRpcmVjdG9yeVBhdGg7XG59XG5cbmZ1bmN0aW9uIHRvcG1vc3REaXJlY3RvcnlOYW1lRnJvbVBhdGgocGF0aCkge1xuICBsZXQgdG9wbW9zdERpcmVjdG9yeU5hbWUgPSBudWxsO1xuXG4gIGNvbnN0IG1hdGNoZXMgPSBwYXRoLm1hdGNoKC9eKFteXFwvXSopXFwvLyk7XG5cbiAgaWYgKG1hdGNoZXMgIT09IG51bGwpIHtcbiAgICBjb25zdCBzZWNvbmRNYXRjaCA9IHNlY29uZChtYXRjaGVzKTtcblxuICAgIHRvcG1vc3REaXJlY3RvcnlOYW1lID0gc2Vjb25kTWF0Y2g7ICAvLy9cbiAgfVxuXG4gIHJldHVybiB0b3Btb3N0RGlyZWN0b3J5TmFtZTtcbn1cblxuZnVuY3Rpb24gcGF0aFdpdGhvdXRUcmFpbGluZ1NsYXNoRnJvbVBhdGgocGF0aCkge1xuICBjb25zdCBwYXRoV2l0aG91dFRyYWlsaW5nU2xhc2ggPSBwYXRoLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG5cbiAgcmV0dXJuIHBhdGhXaXRob3V0VHJhaWxpbmdTbGFzaDtcbn1cblxuZnVuY3Rpb24gcGF0aFdpdGhvdXRCb3R0b21tb3N0TmFtZUZyb21QYXRoKHBhdGgpIHtcbiAgbGV0IHBhdGhXaXRob3V0Qm90dG9tbW9zdE5hbWUgPSBudWxsO1xuXG4gIGNvbnN0IG1hdGNoZXMgPSBwYXRoLm1hdGNoKC8oXi4qKVxcL1teXFwvXSokLyk7XG5cbiAgaWYgKG1hdGNoZXMgIT09IG51bGwpIHtcbiAgICBjb25zdCBzZWNvbmRNYXRjaCA9IHNlY29uZChtYXRjaGVzKTtcblxuICAgIHBhdGhXaXRob3V0Qm90dG9tbW9zdE5hbWUgPSBzZWNvbmRNYXRjaDsgLy8vXG4gIH1cblxuICByZXR1cm4gcGF0aFdpdGhvdXRCb3R0b21tb3N0TmFtZTtcbn1cblxuZnVuY3Rpb24gcGF0aFdpdGhvdXRUb3Btb3N0RGlyZWN0b3J5TmFtZUZyb21QYXRoKHBhdGgpIHtcbiAgbGV0IHBhdGhXaXRob3V0VG9wbW9zdERpcmVjdG9yeU5hbWUgPSBudWxsO1xuXG4gIGNvbnN0IG1hdGNoZXMgPSBwYXRoLm1hdGNoKC9eW15cXC9dKlxcLyguKikkLyk7XG5cbiAgaWYgKG1hdGNoZXMgIT09IG51bGwpIHtcbiAgICBjb25zdCBzZWNvbmRNYXRjaCA9IHNlY29uZChtYXRjaGVzKTtcblxuICAgIHBhdGhXaXRob3V0VG9wbW9zdERpcmVjdG9yeU5hbWUgPSBzZWNvbmRNYXRjaDtcbiAgfVxuXG4gIHJldHVybiBwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgaXNQYXRoUmVsYXRpdmVQYXRoOiBpc1BhdGhSZWxhdGl2ZVBhdGgsXG4gIGlzUGF0aEFic29sdXRlUGF0aDogaXNQYXRoQWJzb2x1dGVQYXRoLFxuICBpc1BhdGhUb3Btb3N0RGlyZWN0b3J5TmFtZTogaXNQYXRoVG9wbW9zdERpcmVjdG9yeU5hbWUsXG4gIGlzVG9wbW9zdERpcmVjdG9yeU5hbWVDb250YWluZWRJblBhdGg6IGlzVG9wbW9zdERpcmVjdG9yeU5hbWVDb250YWluZWRJblBhdGgsXG4gIGNvbWJpbmVQYXRoczogY29tYmluZVBhdGhzLFxuICBjb25jYXRlbmF0ZVBhdGhzOiBjb25jYXRlbmF0ZVBhdGhzLFxuICBib3R0b21tb3N0TmFtZUZyb21QYXRoOiBib3R0b21tb3N0TmFtZUZyb21QYXRoLFxuICB0b3Btb3N0RGlyZWN0b3J5UGF0aEZyb21QYXRoOiB0b3Btb3N0RGlyZWN0b3J5UGF0aEZyb21QYXRoLFxuICB0b3Btb3N0RGlyZWN0b3J5TmFtZUZyb21QYXRoOiB0b3Btb3N0RGlyZWN0b3J5TmFtZUZyb21QYXRoLFxuICBwYXRoV2l0aG91dFRyYWlsaW5nU2xhc2hGcm9tUGF0aDogcGF0aFdpdGhvdXRUcmFpbGluZ1NsYXNoRnJvbVBhdGgsXG4gIHBhdGhXaXRob3V0Qm90dG9tbW9zdE5hbWVGcm9tUGF0aDogcGF0aFdpdGhvdXRCb3R0b21tb3N0TmFtZUZyb21QYXRoLFxuICBwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lRnJvbVBhdGg6IHBhdGhXaXRob3V0VG9wbW9zdERpcmVjdG9yeU5hbWVGcm9tUGF0aFxufTtcbiJdfQ==