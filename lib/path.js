'use strict';

var array = require('./array');

var second = array.second;


function isPathRelativePath(path) {
  var position = path.search(/^\.{1,2}\//),
      pathRelativePath = position !== -1;

  return pathRelativePath;
}

function isPathAbsolutePath(path) {
  var pathRelativePath = isPathRelativePath(path),
      pathAbsolutePath = !pathRelativePath; ///

  return pathAbsolutePath;
}

function isPathTopmostDirectoryName(path) {
  var topmostDirectoryName = topmostDirectoryNameFromPath(path),
      pathTopmostDirectoryName = topmostDirectoryName === null; ///

  return pathTopmostDirectoryName;
}

function isTopmostDirectoryNameContainedInPath(topmostDirectoryName, path) {
  var regExp = new RegExp('^' + topmostDirectoryName),
      position = path.search(regExp),
      topmostDirectoryNameContainedInFilePath = position !== -1;

  return topmostDirectoryNameContainedInFilePath;
}

function combinePaths(directoryPath, relativePath) {
  var absolutePath = null;

  var directoryPathSubEntryNames = directoryPath.split('/'),
      relativeFilePathSubEntryNames = relativePath.split('/');

  var firstRelativeFilePathSubEntryName = first(relativeFilePathSubEntryNames),
      lastDirectoryPathSubEntryName = void 0;

  if (firstRelativeFilePathSubEntryName === '.') {
    relativeFilePathSubEntryNames.shift();
  }

  firstRelativeFilePathSubEntryName = first(relativeFilePathSubEntryNames);
  lastDirectoryPathSubEntryName = last(directoryPathSubEntryNames);

  while (firstRelativeFilePathSubEntryName === '..' && lastDirectoryPathSubEntryName !== undefined) {
    relativeFilePathSubEntryNames.shift();
    directoryPathSubEntryNames.pop();

    firstRelativeFilePathSubEntryName = first(relativeFilePathSubEntryNames);
    lastDirectoryPathSubEntryName = last(directoryPathSubEntryNames);
  }

  if (lastDirectoryPathSubEntryName !== undefined) {
    var absoluteFilePathSubEntryNames = [].concat(directoryPathSubEntryNames).concat(relativeFilePathSubEntryNames);

    absolutePath = absoluteFilePathSubEntryNames.join('/');
  }

  return absolutePath;
}

function concatenatePaths(path1, path2) {
  path1 = pathWithoutTrailingSlashFromPath(path1); ///

  var combinedPath = path1 + '/' + path2;

  return combinedPath;
}

function bottommostNameFromPath(path) {
  var bottommostName = null;

  var matches = path.match(/^.*\/([^\/]*$)/);

  if (matches !== null) {
    var secondMatch = second(matches);

    bottommostName = secondMatch; ///
  }

  return bottommostName;
}

function directoryPathFromPath(path) {
  var matches = path.match(/^(.*)\/[^\/]*$/),
      secondMatch = second(matches),
      directoryPath = secondMatch; ///

  return directoryPath;
}

function topmostDirectoryNameFromPath(path) {
  var topmostDirectoryName = null;

  var matches = path.match(/^([^\/]*)\//);

  if (matches !== null) {
    var secondMatch = second(matches);

    topmostDirectoryName = secondMatch; ///
  }

  return topmostDirectoryName;
}

function pathWithoutTopmostDirectoryName(path) {
  var matches = path.match(/^[^\/]*\/(.*$)/),
      second = second(matches),
      pathWithoutTopmostDirectoryName = second;

  return pathWithoutTopmostDirectoryName;
}

function pathWithoutTrailingSlashFromPath(path) {
  var pathWithoutTrailingSlash = path.replace(/\/$/, '');

  return pathWithoutTrailingSlash;
}

function pathWithoutBottommostNameFromPath(path) {
  var pathWithoutBottommostName = null;

  var matches = path.match(/(^.*)\/[^\/]*$/);

  if (matches !== null) {
    var secondMatch = second(matches);

    pathWithoutBottommostName = secondMatch; ///
  }

  return pathWithoutBottommostName;
}

function pathWithoutTopmostDirectoryNameFromPath(path) {
  var pathWithoutTopmostDirectoryName = null;

  var matches = path.match(/^[^\/]*\/(.*$)/);

  if (matches !== null) {
    var secondMatch = second(matches);

    pathWithoutTopmostDirectoryName = secondMatch;
  }

  return pathWithoutTopmostDirectoryName;
}

module.exports = {
  isPathRelativePath: isPathRelativePath,
  isPathAbsolutePath: isPathAbsolutePath,
  isPathTopmostDirectoryName: isPathTopmostDirectoryName,
  isTopmostDirectoryNameContainedInPath: isTopmostDirectoryNameContainedInPath,
  combinePaths: combinePaths,
  concatenatePaths: concatenatePaths,
  bottommostNameFromPath: bottommostNameFromPath,
  directoryPathFromPath: directoryPathFromPath,
  topmostDirectoryNameFromPath: topmostDirectoryNameFromPath,
  pathWithoutTopmostDirectoryName: pathWithoutTopmostDirectoryName,
  pathWithoutTrailingSlashFromPath: pathWithoutTrailingSlashFromPath,
  pathWithoutBottommostNameFromPath: pathWithoutBottommostNameFromPath,
  pathWithoutTopmostDirectoryNameFromPath: pathWithoutTopmostDirectoryNameFromPath
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2VzNi9wYXRoLmpzIl0sIm5hbWVzIjpbImFycmF5IiwicmVxdWlyZSIsInNlY29uZCIsImlzUGF0aFJlbGF0aXZlUGF0aCIsInBhdGgiLCJwb3NpdGlvbiIsInNlYXJjaCIsInBhdGhSZWxhdGl2ZVBhdGgiLCJpc1BhdGhBYnNvbHV0ZVBhdGgiLCJwYXRoQWJzb2x1dGVQYXRoIiwiaXNQYXRoVG9wbW9zdERpcmVjdG9yeU5hbWUiLCJ0b3Btb3N0RGlyZWN0b3J5TmFtZSIsInRvcG1vc3REaXJlY3RvcnlOYW1lRnJvbVBhdGgiLCJwYXRoVG9wbW9zdERpcmVjdG9yeU5hbWUiLCJpc1RvcG1vc3REaXJlY3RvcnlOYW1lQ29udGFpbmVkSW5QYXRoIiwicmVnRXhwIiwiUmVnRXhwIiwidG9wbW9zdERpcmVjdG9yeU5hbWVDb250YWluZWRJbkZpbGVQYXRoIiwiY29tYmluZVBhdGhzIiwiZGlyZWN0b3J5UGF0aCIsInJlbGF0aXZlUGF0aCIsImFic29sdXRlUGF0aCIsImRpcmVjdG9yeVBhdGhTdWJFbnRyeU5hbWVzIiwic3BsaXQiLCJyZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lcyIsImZpcnN0UmVsYXRpdmVGaWxlUGF0aFN1YkVudHJ5TmFtZSIsImZpcnN0IiwibGFzdERpcmVjdG9yeVBhdGhTdWJFbnRyeU5hbWUiLCJzaGlmdCIsImxhc3QiLCJ1bmRlZmluZWQiLCJwb3AiLCJhYnNvbHV0ZUZpbGVQYXRoU3ViRW50cnlOYW1lcyIsImNvbmNhdCIsImpvaW4iLCJjb25jYXRlbmF0ZVBhdGhzIiwicGF0aDEiLCJwYXRoMiIsInBhdGhXaXRob3V0VHJhaWxpbmdTbGFzaEZyb21QYXRoIiwiY29tYmluZWRQYXRoIiwiYm90dG9tbW9zdE5hbWVGcm9tUGF0aCIsImJvdHRvbW1vc3ROYW1lIiwibWF0Y2hlcyIsIm1hdGNoIiwic2Vjb25kTWF0Y2giLCJkaXJlY3RvcnlQYXRoRnJvbVBhdGgiLCJwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lIiwicGF0aFdpdGhvdXRUcmFpbGluZ1NsYXNoIiwicmVwbGFjZSIsInBhdGhXaXRob3V0Qm90dG9tbW9zdE5hbWVGcm9tUGF0aCIsInBhdGhXaXRob3V0Qm90dG9tbW9zdE5hbWUiLCJwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lRnJvbVBhdGgiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFNQSxRQUFRQyxRQUFRLFNBQVIsQ0FBZDs7SUFFUUMsTSxHQUFXRixLLENBQVhFLE07OztBQUVSLFNBQVNDLGtCQUFULENBQTRCQyxJQUE1QixFQUFrQztBQUNoQyxNQUFNQyxXQUFXRCxLQUFLRSxNQUFMLENBQVksWUFBWixDQUFqQjtBQUFBLE1BQ01DLG1CQUFvQkYsYUFBYSxDQUFDLENBRHhDOztBQUdBLFNBQU9FLGdCQUFQO0FBQ0Q7O0FBRUQsU0FBU0Msa0JBQVQsQ0FBNEJKLElBQTVCLEVBQWtDO0FBQ2hDLE1BQU1HLG1CQUFtQkosbUJBQW1CQyxJQUFuQixDQUF6QjtBQUFBLE1BQ01LLG1CQUFtQixDQUFDRixnQkFEMUIsQ0FEZ0MsQ0FFWTs7QUFFNUMsU0FBT0UsZ0JBQVA7QUFDRDs7QUFFRCxTQUFTQywwQkFBVCxDQUFvQ04sSUFBcEMsRUFBMEM7QUFDeEMsTUFBTU8sdUJBQXVCQyw2QkFBNkJSLElBQTdCLENBQTdCO0FBQUEsTUFDTVMsMkJBQTRCRix5QkFBeUIsSUFEM0QsQ0FEd0MsQ0FFMEI7O0FBRWxFLFNBQU9FLHdCQUFQO0FBQ0Q7O0FBRUQsU0FBU0MscUNBQVQsQ0FBK0NILG9CQUEvQyxFQUFxRVAsSUFBckUsRUFBMkU7QUFDekUsTUFBTVcsU0FBUyxJQUFJQyxNQUFKLE9BQWVMLG9CQUFmLENBQWY7QUFBQSxNQUNNTixXQUFXRCxLQUFLRSxNQUFMLENBQVlTLE1BQVosQ0FEakI7QUFBQSxNQUVNRSwwQ0FBMkNaLGFBQWEsQ0FBQyxDQUYvRDs7QUFJQSxTQUFPWSx1Q0FBUDtBQUNEOztBQUVELFNBQVNDLFlBQVQsQ0FBc0JDLGFBQXRCLEVBQXFD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QUFpRDtBQUMvQyxNQUFJOEMsNEJBQTRCLElBQWhDOztBQUVBLE1BQU1SLFVBQVV0QyxLQUFLdUMsS0FBTCxDQUFXLGdCQUFYLENBQWhCOztBQUVBLE1BQUlELFlBQVksSUFBaEIsRUFBc0I7QUFDcEIsUUFBTUUsY0FBYzFDLE9BQU93QyxPQUFQLENBQXBCOztBQUVBUSxnQ0FBNEJOLFdBQTVCLENBSG9CLENBR3FCO0FBQzFDOztBQUVELFNBQU9NLHlCQUFQO0FBQ0Q7O0FBRUQsU0FBU0MsdUNBQVQsQ0FBaUQvQyxJQUFqRCxFQUF1RDtBQUNyRCxNQUFJMEMsa0NBQWtDLElBQXRDOztBQUVBLE1BQU1KLFVBQVV0QyxLQUFLdUMsS0FBTCxDQUFXLGdCQUFYLENBQWhCOztBQUVBLE1BQUlELFlBQVksSUFBaEIsRUFBc0I7QUFDcEIsUUFBTUUsY0FBYzFDLE9BQU93QyxPQUFQLENBQXBCOztBQUVBSSxzQ0FBa0NGLFdBQWxDO0FBQ0Q7O0FBRUQsU0FBT0UsK0JBQVA7QUFDRDs7QUFFRE0sT0FBT0MsT0FBUCxHQUFpQjtBQUNmbEQsc0JBQW9CQSxrQkFETDtBQUVmSyxzQkFBb0JBLGtCQUZMO0FBR2ZFLDhCQUE0QkEsMEJBSGI7QUFJZkkseUNBQXVDQSxxQ0FKeEI7QUFLZkksZ0JBQWNBLFlBTEM7QUFNZmlCLG9CQUFrQkEsZ0JBTkg7QUFPZkssMEJBQXdCQSxzQkFQVDtBQVFmSyx5QkFBdUJBLHFCQVJSO0FBU2ZqQyxnQ0FBOEJBLDRCQVRmO0FBVWZrQyxtQ0FBaUNBLCtCQVZsQjtBQVdmUixvQ0FBa0NBLGdDQVhuQjtBQVlmVyxxQ0FBbUNBLGlDQVpwQjtBQWFmRSwyQ0FBeUNBO0FBYjFCLENBQWpCIiwiZmlsZSI6InBhdGguanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IGFycmF5ID0gcmVxdWlyZSgnLi9hcnJheScpO1xuXG5jb25zdCB7IHNlY29uZCB9ID0gYXJyYXk7XG5cbmZ1bmN0aW9uIGlzUGF0aFJlbGF0aXZlUGF0aChwYXRoKSB7XG4gIGNvbnN0IHBvc2l0aW9uID0gcGF0aC5zZWFyY2goL15cXC57MSwyfVxcLy8pLFxuICAgICAgICBwYXRoUmVsYXRpdmVQYXRoID0gKHBvc2l0aW9uICE9PSAtMSk7XG5cbiAgcmV0dXJuIHBhdGhSZWxhdGl2ZVBhdGg7XG59XG5cbmZ1bmN0aW9uIGlzUGF0aEFic29sdXRlUGF0aChwYXRoKSB7XG4gIGNvbnN0IHBhdGhSZWxhdGl2ZVBhdGggPSBpc1BhdGhSZWxhdGl2ZVBhdGgocGF0aCksXG4gICAgICAgIHBhdGhBYnNvbHV0ZVBhdGggPSAhcGF0aFJlbGF0aXZlUGF0aDsgLy8vXG5cbiAgcmV0dXJuIHBhdGhBYnNvbHV0ZVBhdGg7XG59XG5cbmZ1bmN0aW9uIGlzUGF0aFRvcG1vc3REaXJlY3RvcnlOYW1lKHBhdGgpIHtcbiAgY29uc3QgdG9wbW9zdERpcmVjdG9yeU5hbWUgPSB0b3Btb3N0RGlyZWN0b3J5TmFtZUZyb21QYXRoKHBhdGgpLFxuICAgICAgICBwYXRoVG9wbW9zdERpcmVjdG9yeU5hbWUgPSAodG9wbW9zdERpcmVjdG9yeU5hbWUgPT09IG51bGwpOyAvLy9cblxuICByZXR1cm4gcGF0aFRvcG1vc3REaXJlY3RvcnlOYW1lO1xufVxuXG5mdW5jdGlvbiBpc1RvcG1vc3REaXJlY3RvcnlOYW1lQ29udGFpbmVkSW5QYXRoKHRvcG1vc3REaXJlY3RvcnlOYW1lLCBwYXRoKSB7XG4gIGNvbnN0IHJlZ0V4cCA9IG5ldyBSZWdFeHAoYF4ke3RvcG1vc3REaXJlY3RvcnlOYW1lfWApLFxuICAgICAgICBwb3NpdGlvbiA9IHBhdGguc2VhcmNoKHJlZ0V4cCksXG4gICAgICAgIHRvcG1vc3REaXJlY3RvcnlOYW1lQ29udGFpbmVkSW5GaWxlUGF0aCA9IChwb3NpdGlvbiAhPT0gLTEpO1xuXG4gIHJldHVybiB0b3Btb3N0RGlyZWN0b3J5TmFtZUNvbnRhaW5lZEluRmlsZVBhdGg7XG59XG5cbmZ1bmN0aW9uIGNvbWJpbmVQYXRocyhkaXJlY3RvcnlQYXRoLCByZWxhdGl2ZVBhdGgpIHtcbiAgbGV0IGFic29sdXRlUGF0aCA9IG51bGw7XG5cbiAgY29uc3QgZGlyZWN0b3J5UGF0aFN1YkVudHJ5TmFtZXMgPSBkaXJlY3RvcnlQYXRoLnNwbGl0KCcvJyksXG4gICAgICAgIHJlbGF0aXZlRmlsZVBhdGhTdWJFbnRyeU5hbWVzID0gcmVsYXRpdmVQYXRoLnNwbGl0KCcvJyk7XG5cbiAgbGV0IGZpcnN0UmVsYXRpdmVGaWxlUGF0aFN1YkVudHJ5TmFtZSA9IGZpcnN0KHJlbGF0aXZlRmlsZVBhdGhTdWJFbnRyeU5hbWVzKSxcbiAgICAgIGxhc3REaXJlY3RvcnlQYXRoU3ViRW50cnlOYW1lO1xuXG4gIGlmIChmaXJzdFJlbGF0aXZlRmlsZVBhdGhTdWJFbnRyeU5hbWUgPT09ICcuJykge1xuICAgIHJlbGF0aXZlRmlsZVBhdGhTdWJFbnRyeU5hbWVzLnNoaWZ0KCk7XG4gIH1cblxuICBmaXJzdFJlbGF0aXZlRmlsZVBhdGhTdWJFbnRyeU5hbWUgPSBmaXJzdChyZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lcyk7XG4gIGxhc3REaXJlY3RvcnlQYXRoU3ViRW50cnlOYW1lID0gbGFzdChkaXJlY3RvcnlQYXRoU3ViRW50cnlOYW1lcyk7XG5cbiAgd2hpbGUgKChmaXJzdFJlbGF0aXZlRmlsZVBhdGhTdWJFbnRyeU5hbWUgPT09ICcuLicpICYmIChsYXN0RGlyZWN0b3J5UGF0aFN1YkVudHJ5TmFtZSAhPT0gdW5kZWZpbmVkKSkge1xuICAgIHJlbGF0aXZlRmlsZVBhdGhTdWJFbnRyeU5hbWVzLnNoaWZ0KCk7XG4gICAgZGlyZWN0b3J5UGF0aFN1YkVudHJ5TmFtZXMucG9wKCk7XG5cbiAgICBmaXJzdFJlbGF0aXZlRmlsZVBhdGhTdWJFbnRyeU5hbWUgPSBmaXJzdChyZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lcyk7XG4gICAgbGFzdERpcmVjdG9yeVBhdGhTdWJFbnRyeU5hbWUgPSBsYXN0KGRpcmVjdG9yeVBhdGhTdWJFbnRyeU5hbWVzKTtcbiAgfVxuXG4gIGlmIChsYXN0RGlyZWN0b3J5UGF0aFN1YkVudHJ5TmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3QgYWJzb2x1dGVGaWxlUGF0aFN1YkVudHJ5TmFtZXMgPSBbXS5jb25jYXQoZGlyZWN0b3J5UGF0aFN1YkVudHJ5TmFtZXMpLmNvbmNhdChyZWxhdGl2ZUZpbGVQYXRoU3ViRW50cnlOYW1lcyk7XG5cbiAgICBhYnNvbHV0ZVBhdGggPSBhYnNvbHV0ZUZpbGVQYXRoU3ViRW50cnlOYW1lcy5qb2luKCcvJyk7XG4gIH1cblxuICByZXR1cm4gYWJzb2x1dGVQYXRoO1xufVxuXG5mdW5jdGlvbiBjb25jYXRlbmF0ZVBhdGhzKHBhdGgxLCBwYXRoMikge1xuICBwYXRoMSA9IHBhdGhXaXRob3V0VHJhaWxpbmdTbGFzaEZyb21QYXRoKHBhdGgxKTsgIC8vL1xuXG4gIGNvbnN0IGNvbWJpbmVkUGF0aCA9IGAke3BhdGgxfS8ke3BhdGgyfWA7XG5cbiAgcmV0dXJuIGNvbWJpbmVkUGF0aDtcbn1cblxuZnVuY3Rpb24gYm90dG9tbW9zdE5hbWVGcm9tUGF0aChwYXRoKSB7XG4gIGxldCBib3R0b21tb3N0TmFtZSA9IG51bGw7XG5cbiAgY29uc3QgbWF0Y2hlcyA9IHBhdGgubWF0Y2goL14uKlxcLyhbXlxcL10qJCkvKTtcblxuICBpZiAobWF0Y2hlcyAhPT0gbnVsbCkge1xuICAgIGNvbnN0IHNlY29uZE1hdGNoID0gc2Vjb25kKG1hdGNoZXMpO1xuXG4gICAgYm90dG9tbW9zdE5hbWUgPSBzZWNvbmRNYXRjaDsgIC8vL1xuICB9XG5cbiAgcmV0dXJuIGJvdHRvbW1vc3ROYW1lO1xufVxuXG5mdW5jdGlvbiBkaXJlY3RvcnlQYXRoRnJvbVBhdGgocGF0aCkge1xuICBjb25zdCBtYXRjaGVzID0gcGF0aC5tYXRjaCgvXiguKilcXC9bXlxcL10qJC8pLFxuICAgICAgICBzZWNvbmRNYXRjaCA9IHNlY29uZChtYXRjaGVzKSxcbiAgICAgICAgZGlyZWN0b3J5UGF0aCA9IHNlY29uZE1hdGNoOyAvLy9cblxuICByZXR1cm4gZGlyZWN0b3J5UGF0aDtcbn1cblxuZnVuY3Rpb24gdG9wbW9zdERpcmVjdG9yeU5hbWVGcm9tUGF0aChwYXRoKSB7XG4gIGxldCB0b3Btb3N0RGlyZWN0b3J5TmFtZSA9IG51bGw7XG5cbiAgY29uc3QgbWF0Y2hlcyA9IHBhdGgubWF0Y2goL14oW15cXC9dKilcXC8vKTtcblxuICBpZiAobWF0Y2hlcyAhPT0gbnVsbCkge1xuICAgIGNvbnN0IHNlY29uZE1hdGNoID0gc2Vjb25kKG1hdGNoZXMpO1xuXG4gICAgdG9wbW9zdERpcmVjdG9yeU5hbWUgPSBzZWNvbmRNYXRjaDsgIC8vL1xuICB9XG5cbiAgcmV0dXJuIHRvcG1vc3REaXJlY3RvcnlOYW1lO1xufVxuXG5mdW5jdGlvbiBwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lKHBhdGgpIHtcbiAgY29uc3QgbWF0Y2hlcyA9IHBhdGgubWF0Y2goL15bXlxcL10qXFwvKC4qJCkvKSxcbiAgICAgICAgc2Vjb25kID0gc2Vjb25kKG1hdGNoZXMpLFxuICAgICAgICBwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lID0gc2Vjb25kO1xuXG4gIHJldHVybiBwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lO1xufVxuXG5mdW5jdGlvbiBwYXRoV2l0aG91dFRyYWlsaW5nU2xhc2hGcm9tUGF0aChwYXRoKSB7XG4gIGNvbnN0IHBhdGhXaXRob3V0VHJhaWxpbmdTbGFzaCA9IHBhdGgucmVwbGFjZSgvXFwvJC8sICcnKTtcblxuICByZXR1cm4gcGF0aFdpdGhvdXRUcmFpbGluZ1NsYXNoO1xufVxuXG5mdW5jdGlvbiBwYXRoV2l0aG91dEJvdHRvbW1vc3ROYW1lRnJvbVBhdGgocGF0aCkge1xuICBsZXQgcGF0aFdpdGhvdXRCb3R0b21tb3N0TmFtZSA9IG51bGw7XG5cbiAgY29uc3QgbWF0Y2hlcyA9IHBhdGgubWF0Y2goLyheLiopXFwvW15cXC9dKiQvKTtcblxuICBpZiAobWF0Y2hlcyAhPT0gbnVsbCkge1xuICAgIGNvbnN0IHNlY29uZE1hdGNoID0gc2Vjb25kKG1hdGNoZXMpO1xuXG4gICAgcGF0aFdpdGhvdXRCb3R0b21tb3N0TmFtZSA9IHNlY29uZE1hdGNoOyAvLy9cbiAgfVxuXG4gIHJldHVybiBwYXRoV2l0aG91dEJvdHRvbW1vc3ROYW1lO1xufVxuXG5mdW5jdGlvbiBwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lRnJvbVBhdGgocGF0aCkge1xuICBsZXQgcGF0aFdpdGhvdXRUb3Btb3N0RGlyZWN0b3J5TmFtZSA9IG51bGw7XG5cbiAgY29uc3QgbWF0Y2hlcyA9IHBhdGgubWF0Y2goL15bXlxcL10qXFwvKC4qJCkvKTtcblxuICBpZiAobWF0Y2hlcyAhPT0gbnVsbCkge1xuICAgIGNvbnN0IHNlY29uZE1hdGNoID0gc2Vjb25kKG1hdGNoZXMpO1xuXG4gICAgcGF0aFdpdGhvdXRUb3Btb3N0RGlyZWN0b3J5TmFtZSA9IHNlY29uZE1hdGNoO1xuICB9XG5cbiAgcmV0dXJuIHBhdGhXaXRob3V0VG9wbW9zdERpcmVjdG9yeU5hbWU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpc1BhdGhSZWxhdGl2ZVBhdGg6IGlzUGF0aFJlbGF0aXZlUGF0aCxcbiAgaXNQYXRoQWJzb2x1dGVQYXRoOiBpc1BhdGhBYnNvbHV0ZVBhdGgsXG4gIGlzUGF0aFRvcG1vc3REaXJlY3RvcnlOYW1lOiBpc1BhdGhUb3Btb3N0RGlyZWN0b3J5TmFtZSxcbiAgaXNUb3Btb3N0RGlyZWN0b3J5TmFtZUNvbnRhaW5lZEluUGF0aDogaXNUb3Btb3N0RGlyZWN0b3J5TmFtZUNvbnRhaW5lZEluUGF0aCxcbiAgY29tYmluZVBhdGhzOiBjb21iaW5lUGF0aHMsXG4gIGNvbmNhdGVuYXRlUGF0aHM6IGNvbmNhdGVuYXRlUGF0aHMsXG4gIGJvdHRvbW1vc3ROYW1lRnJvbVBhdGg6IGJvdHRvbW1vc3ROYW1lRnJvbVBhdGgsXG4gIGRpcmVjdG9yeVBhdGhGcm9tUGF0aDogZGlyZWN0b3J5UGF0aEZyb21QYXRoLFxuICB0b3Btb3N0RGlyZWN0b3J5TmFtZUZyb21QYXRoOiB0b3Btb3N0RGlyZWN0b3J5TmFtZUZyb21QYXRoLFxuICBwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lOiBwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lLFxuICBwYXRoV2l0aG91dFRyYWlsaW5nU2xhc2hGcm9tUGF0aDogcGF0aFdpdGhvdXRUcmFpbGluZ1NsYXNoRnJvbVBhdGgsXG4gIHBhdGhXaXRob3V0Qm90dG9tbW9zdE5hbWVGcm9tUGF0aDogcGF0aFdpdGhvdXRCb3R0b21tb3N0TmFtZUZyb21QYXRoLFxuICBwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lRnJvbVBhdGg6IHBhdGhXaXRob3V0VG9wbW9zdERpcmVjdG9yeU5hbWVGcm9tUGF0aFxufTtcbiJdfQ==