'use strict';

var ETX_CHARACTER = '\x03';

function onETX(handler) {
  var _process = process,
      stdin = _process.stdin,
      setRawMode = stdin.setRawMode;


  if (setRawMode) {
    var rawMode = true,
        encoding = 'utf8';

    stdin.setRawMode(rawMode);
    stdin.setEncoding(encoding);

    stdin.resume();

    stdin.addListener('data', dataHandler);

    return offExt;
  }

  function offExt() {
    stdin.removeListener('data', dataHandler);
  }

  function dataHandler(character) {
    if (character === ETX_CHARACTER) {
      handler();
    }
  }
}

module.exports = {
  onETX: onETX
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsaXRpZXMvbWlzY2VsbGFuZW91cy5qcyJdLCJuYW1lcyI6WyJFVFhfQ0hBUkFDVEVSIiwib25FVFgiLCJoYW5kbGVyIiwicHJvY2VzcyIsInN0ZGluIiwic2V0UmF3TW9kZSIsInJhd01vZGUiLCJlbmNvZGluZyIsInNldEVuY29kaW5nIiwicmVzdW1lIiwiYWRkTGlzdGVuZXIiLCJkYXRhSGFuZGxlciIsIm9mZkV4dCIsInJlbW92ZUxpc3RlbmVyIiwiY2hhcmFjdGVyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBTUEsZ0JBQWdCLE1BQXRCOztBQUVBLFNBQVNDLEtBQVQsQ0FBZUMsT0FBZixFQUF3QjtBQUFBLGlCQUNKQyxPQURJO0FBQUEsTUFDZEMsS0FEYyxZQUNkQSxLQURjO0FBQUEsTUFFZEMsVUFGYyxHQUVDRCxLQUZELENBRWRDLFVBRmM7OztBQUl0QixNQUFJQSxVQUFKLEVBQWdCO0FBQ2QsUUFBTUMsVUFBVSxJQUFoQjtBQUFBLFFBQ01DLFdBQVcsTUFEakI7O0FBR0FILFVBQU1DLFVBQU4sQ0FBaUJDLE9BQWpCO0FBQ0FGLFVBQU1JLFdBQU4sQ0FBa0JELFFBQWxCOztBQUVBSCxVQUFNSyxNQUFOOztBQUVBTCxVQUFNTSxXQUFOLENBQWtCLE1BQWxCLEVBQTBCQyxXQUExQjs7QUFFQSxXQUFPQyxNQUFQO0FBQ0Q7O0FBRUQsV0FBU0EsTUFBVCxHQUFrQjtBQUNoQlIsVUFBTVMsY0FBTixDQUFxQixNQUFyQixFQUE2QkYsV0FBN0I7QUFDRDs7QUFFRCxXQUFTQSxXQUFULENBQXFCRyxTQUFyQixFQUFnQztBQUM5QixRQUFJQSxjQUFjZCxhQUFsQixFQUFpQztBQUMvQkU7QUFDRDtBQUNGO0FBQ0Y7O0FBRURhLE9BQU9DLE9BQVAsR0FBaUI7QUFDZmYsU0FBT0E7QUFEUSxDQUFqQiIsImZpbGUiOiJtaXNjZWxsYW5lb3VzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBFVFhfQ0hBUkFDVEVSID0gJ1xcdTAwMDMnO1xuXG5mdW5jdGlvbiBvbkVUWChoYW5kbGVyKSB7XG4gIGNvbnN0IHsgc3RkaW4gfSA9IHByb2Nlc3MsXG4gICAgICAgIHsgc2V0UmF3TW9kZSB9ID0gc3RkaW47XG5cbiAgaWYgKHNldFJhd01vZGUpIHtcbiAgICBjb25zdCByYXdNb2RlID0gdHJ1ZSxcbiAgICAgICAgICBlbmNvZGluZyA9ICd1dGY4JztcblxuICAgIHN0ZGluLnNldFJhd01vZGUocmF3TW9kZSk7XG4gICAgc3RkaW4uc2V0RW5jb2RpbmcoZW5jb2RpbmcpO1xuXG4gICAgc3RkaW4ucmVzdW1lKCk7XG5cbiAgICBzdGRpbi5hZGRMaXN0ZW5lcignZGF0YScsIGRhdGFIYW5kbGVyKTtcblxuICAgIHJldHVybiBvZmZFeHQ7XG4gIH1cblxuICBmdW5jdGlvbiBvZmZFeHQoKSB7XG4gICAgc3RkaW4ucmVtb3ZlTGlzdGVuZXIoJ2RhdGEnLCBkYXRhSGFuZGxlcik7XG4gIH1cblxuICBmdW5jdGlvbiBkYXRhSGFuZGxlcihjaGFyYWN0ZXIpIHtcbiAgICBpZiAoY2hhcmFjdGVyID09PSBFVFhfQ0hBUkFDVEVSKSB7XG4gICAgICBoYW5kbGVyKCk7XG4gICAgfVxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBvbkVUWDogb25FVFhcbn07XG4iXX0=