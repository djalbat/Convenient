"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _path = _interopRequireDefault(require("path"));

var _array = require("../utilities/array");

var _constants = require("../constants");

var _fileSystem = require("../utilities/fileSystem");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

if (!globalThis.rc) {
  globalThis.rc = _rc;
}

var rc = globalThis.rc;
var _default = rc;
exports["default"] = _default;
var pathResolver = _path["default"].resolve,
    baseExtension = _constants.DEFAULT_RC_BASE_EXTENSION;

function _rc() {
  var environmentNameOrArgv = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
  var environment,
      environmentName,
      environmentNameOrArgvArgv = environmentNameOrArgv instanceof Array;

  if (environmentNameOrArgvArgv) {
    var argv = environmentNameOrArgv; ///

    environmentName = environmentNameFromArgv(argv);
  } else {
    environmentName = environmentNameOrArgv; ///
  }

  var json = readRCFile(),
      environments = json.environments;

  if (environmentName === null) {
    var firstEnvironment = (0, _array.first)(environments);
    environment = firstEnvironment; ///
  } else {
    environment = environments.find(function (environment) {
      var name = environment.name,
          found = name === environmentName;
      return found;
    });
  }

  delete environment.name;
  Object.assign(rc, environment);
  return environment;
}

function readRCFile() {
  var absoluteRCFilePath = absoluteRCFilePathFromNothing(),
      fileContent = (0, _fileSystem.readFile)(absoluteRCFilePath),
      json = JSON.parse(fileContent);
  return json;
}

function writeRCFile(json) {
  var absoluteRCFilePath = absoluteRCFilePathFromNothing(),
      fileContent = JSON.stringify(json, null, "\t");
  (0, _fileSystem.writeFile)(absoluteRCFilePath, fileContent);
}

function updateRCFile(addedProperties) {
  var json = readRCFile();

  if (addedProperties) {
    Object.assign(json, addedProperties);
  }

  for (var _len = arguments.length, deletedPropertyNames = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    deletedPropertyNames[_key - 1] = arguments[_key];
  }

  deletedPropertyNames.forEach(function (deletedPropertyName) {
    delete json[deletedPropertyName];
  });
  writeRCFile(json);
}

function checkRCFileExists() {
  var absoluteRCFilePath = absoluteRCFilePathFromNothing(),
      rcFileExists = (0, _fileSystem.checkFileExists)(absoluteRCFilePath);
  return rcFileExists;
}

function createVacuousRCFile() {
  var json = {
    "environments": [{}]
  };
  writeRCFile(json);
}

function setRCBaseExtension(rcBaseExtension) {
  baseExtension = rcBaseExtension;
}

function setRCPathResolver(rcPathResolver) {
  pathResolver = rcPathResolver;
}

Object.assign(_rc, {
  readRCFile: readRCFile,
  writeRCFile: writeRCFile,
  updateRCFile: updateRCFile,
  checkRCFileExists: checkRCFileExists,
  createVacuousRCFile: createVacuousRCFile,
  setRCBaseExtension: setRCBaseExtension,
  setRCPathResolver: setRCPathResolver
});

function environmentNameFromArgv(argv) {
  var environmentName = null;
  argv.find(function (argument) {
    ///
    var matches = argument.match(/--environment=(.+)/),
        found = matches !== null;

    if (found) {
      var secondMatch = (0, _array.second)(matches);
      environmentName = secondMatch;
    }

    return found;
  });
  return environmentName;
}

function absoluteRCFilePathFromNothing() {
  var filePath = "./.".concat(baseExtension, "rc"),
      absoluteRCFilePath = pathResolver(filePath);
  return absoluteRCFilePath;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZpZ3VyYXRpb24uanMiXSwibmFtZXMiOlsiZ2xvYmFsVGhpcyIsInJjIiwiX3JjIiwicGF0aFJlc29sdmVyIiwicGF0aCIsInJlc29sdmUiLCJiYXNlRXh0ZW5zaW9uIiwiREVGQVVMVF9SQ19CQVNFX0VYVEVOU0lPTiIsImVudmlyb25tZW50TmFtZU9yQXJndiIsImVudmlyb25tZW50IiwiZW52aXJvbm1lbnROYW1lIiwiZW52aXJvbm1lbnROYW1lT3JBcmd2QXJndiIsIkFycmF5IiwiYXJndiIsImVudmlyb25tZW50TmFtZUZyb21Bcmd2IiwianNvbiIsInJlYWRSQ0ZpbGUiLCJlbnZpcm9ubWVudHMiLCJmaXJzdEVudmlyb25tZW50IiwiZmluZCIsIm5hbWUiLCJmb3VuZCIsIk9iamVjdCIsImFzc2lnbiIsImFic29sdXRlUkNGaWxlUGF0aCIsImFic29sdXRlUkNGaWxlUGF0aEZyb21Ob3RoaW5nIiwiZmlsZUNvbnRlbnQiLCJKU09OIiwicGFyc2UiLCJ3cml0ZVJDRmlsZSIsInN0cmluZ2lmeSIsInVwZGF0ZVJDRmlsZSIsImFkZGVkUHJvcGVydGllcyIsImRlbGV0ZWRQcm9wZXJ0eU5hbWVzIiwiZm9yRWFjaCIsImRlbGV0ZWRQcm9wZXJ0eU5hbWUiLCJjaGVja1JDRmlsZUV4aXN0cyIsInJjRmlsZUV4aXN0cyIsImNyZWF0ZVZhY3VvdXNSQ0ZpbGUiLCJzZXRSQ0Jhc2VFeHRlbnNpb24iLCJyY0Jhc2VFeHRlbnNpb24iLCJzZXRSQ1BhdGhSZXNvbHZlciIsInJjUGF0aFJlc29sdmVyIiwiYXJndW1lbnQiLCJtYXRjaGVzIiwibWF0Y2giLCJzZWNvbmRNYXRjaCIsImZpbGVQYXRoIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQUVBOztBQUVBOztBQUNBOztBQUNBOzs7O0FBRUEsSUFBSSxDQUFDQSxVQUFVLENBQUNDLEVBQWhCLEVBQW9CO0FBQ2xCRCxFQUFBQSxVQUFVLENBQUNDLEVBQVgsR0FBZ0JDLEdBQWhCO0FBQ0Q7O0lBRU9ELEUs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QyxRQUFELENBRHZDO0FBR0EsU0FBT3ZCLGtCQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcblxuaW1wb3J0IHsgZmlyc3QsIHNlY29uZCB9IGZyb20gXCIuLi91dGlsaXRpZXMvYXJyYXlcIjtcbmltcG9ydCB7IERFRkFVTFRfUkNfQkFTRV9FWFRFTlNJT04gfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyByZWFkRmlsZSwgd3JpdGVGaWxlLCBjaGVja0ZpbGVFeGlzdHMgfSBmcm9tIFwiLi4vdXRpbGl0aWVzL2ZpbGVTeXN0ZW1cIjtcblxuaWYgKCFnbG9iYWxUaGlzLnJjKSB7XG4gIGdsb2JhbFRoaXMucmMgPSBfcmM7XG59XG5cbmNvbnN0IHsgcmMgfSA9IGdsb2JhbFRoaXM7XG5cbmV4cG9ydCBkZWZhdWx0IHJjO1xuXG5sZXQgcGF0aFJlc29sdmVyID0gcGF0aC5yZXNvbHZlLFxuICAgIGJhc2VFeHRlbnNpb24gPSBERUZBVUxUX1JDX0JBU0VfRVhURU5TSU9OO1xuXG5mdW5jdGlvbiBfcmMoZW52aXJvbm1lbnROYW1lT3JBcmd2ID0gbnVsbCkge1xuICBsZXQgZW52aXJvbm1lbnQsXG4gICAgICBlbnZpcm9ubWVudE5hbWUsXG4gICAgICBlbnZpcm9ubWVudE5hbWVPckFyZ3ZBcmd2ID0gKGVudmlyb25tZW50TmFtZU9yQXJndiBpbnN0YW5jZW9mIEFycmF5KTtcblxuICBpZiAoZW52aXJvbm1lbnROYW1lT3JBcmd2QXJndikge1xuICAgIGNvbnN0IGFyZ3YgPSBlbnZpcm9ubWVudE5hbWVPckFyZ3Y7IC8vL1xuXG4gICAgZW52aXJvbm1lbnROYW1lID0gZW52aXJvbm1lbnROYW1lRnJvbUFyZ3YoYXJndik7XG4gIH0gZWxzZSB7XG4gICAgZW52aXJvbm1lbnROYW1lID0gZW52aXJvbm1lbnROYW1lT3JBcmd2OyAgLy8vXG4gIH1cblxuICBjb25zdCBqc29uID0gcmVhZFJDRmlsZSgpLFxuICAgICAgICB7IGVudmlyb25tZW50cyB9ID0ganNvbjtcblxuICBpZiAoZW52aXJvbm1lbnROYW1lID09PSBudWxsKSB7XG4gICAgY29uc3QgZmlyc3RFbnZpcm9ubWVudCA9IGZpcnN0KGVudmlyb25tZW50cyk7XG5cbiAgICBlbnZpcm9ubWVudCA9IGZpcnN0RW52aXJvbm1lbnQ7IC8vL1xuICB9IGVsc2Uge1xuICAgIGVudmlyb25tZW50ID0gZW52aXJvbm1lbnRzLmZpbmQoKGVudmlyb25tZW50KSA9PiB7XG4gICAgICBjb25zdCB7IG5hbWUgfSA9IGVudmlyb25tZW50LFxuICAgICAgICAgICAgZm91bmQgPSAobmFtZSA9PT0gZW52aXJvbm1lbnROYW1lKTtcblxuICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlIGVudmlyb25tZW50Lm5hbWU7XG5cbiAgT2JqZWN0LmFzc2lnbihyYywgZW52aXJvbm1lbnQpO1xuXG4gIHJldHVybiBlbnZpcm9ubWVudDtcbn1cblxuZnVuY3Rpb24gcmVhZFJDRmlsZSgpIHtcbiAgY29uc3QgYWJzb2x1dGVSQ0ZpbGVQYXRoID0gYWJzb2x1dGVSQ0ZpbGVQYXRoRnJvbU5vdGhpbmcoKSxcbiAgICAgICAgZmlsZUNvbnRlbnQgPSByZWFkRmlsZShhYnNvbHV0ZVJDRmlsZVBhdGgpLFxuICAgICAgICBqc29uID0gSlNPTi5wYXJzZShmaWxlQ29udGVudCk7XG5cbiAgcmV0dXJuIGpzb247ICAgICAgXG59XG5cbmZ1bmN0aW9uIHdyaXRlUkNGaWxlKGpzb24pIHtcbiAgY29uc3QgYWJzb2x1dGVSQ0ZpbGVQYXRoID0gYWJzb2x1dGVSQ0ZpbGVQYXRoRnJvbU5vdGhpbmcoKSxcbiAgICAgICAgZmlsZUNvbnRlbnQgPSBKU09OLnN0cmluZ2lmeShqc29uLCBudWxsLCBgXFx0YCk7XG5cbiAgd3JpdGVGaWxlKGFic29sdXRlUkNGaWxlUGF0aCwgZmlsZUNvbnRlbnQpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVSQ0ZpbGUoYWRkZWRQcm9wZXJ0aWVzLCAuLi5kZWxldGVkUHJvcGVydHlOYW1lcykge1xuICBsZXQganNvbiA9IHJlYWRSQ0ZpbGUoKTtcblxuICBpZiAoYWRkZWRQcm9wZXJ0aWVzKSB7XG4gICAgT2JqZWN0LmFzc2lnbihqc29uLCBhZGRlZFByb3BlcnRpZXMpO1xuICB9XG5cbiAgZGVsZXRlZFByb3BlcnR5TmFtZXMuZm9yRWFjaCgoZGVsZXRlZFByb3BlcnR5TmFtZSkgPT4ge1xuICAgIGRlbGV0ZSBqc29uW2RlbGV0ZWRQcm9wZXJ0eU5hbWVdO1xuICB9KTtcblxuICB3cml0ZVJDRmlsZShqc29uKTsgICAgICBcbn1cblxuZnVuY3Rpb24gY2hlY2tSQ0ZpbGVFeGlzdHMoKSB7XG4gIGNvbnN0IGFic29sdXRlUkNGaWxlUGF0aCA9IGFic29sdXRlUkNGaWxlUGF0aEZyb21Ob3RoaW5nKCksXG4gICAgICAgIHJjRmlsZUV4aXN0cyA9IGNoZWNrRmlsZUV4aXN0cyhhYnNvbHV0ZVJDRmlsZVBhdGgpO1xuXG4gIHJldHVybiByY0ZpbGVFeGlzdHM7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVZhY3VvdXNSQ0ZpbGUoKSB7XG4gIGNvbnN0IGpzb24gPSB7XG4gICAgXCJlbnZpcm9ubWVudHNcIjogW1xuICAgICAge31cbiAgICBdXG4gIH07XG5cbiAgd3JpdGVSQ0ZpbGUoanNvbik7XG59XG5cbmZ1bmN0aW9uIHNldFJDQmFzZUV4dGVuc2lvbihyY0Jhc2VFeHRlbnNpb24pIHsgYmFzZUV4dGVuc2lvbiA9IHJjQmFzZUV4dGVuc2lvbjsgfVxuXG5mdW5jdGlvbiBzZXRSQ1BhdGhSZXNvbHZlcihyY1BhdGhSZXNvbHZlcikgeyBwYXRoUmVzb2x2ZXIgPSByY1BhdGhSZXNvbHZlcjsgfVxuXG5PYmplY3QuYXNzaWduKF9yYywge1xuICByZWFkUkNGaWxlLFxuICB3cml0ZVJDRmlsZSxcbiAgdXBkYXRlUkNGaWxlLFxuICBjaGVja1JDRmlsZUV4aXN0cyxcbiAgY3JlYXRlVmFjdW91c1JDRmlsZSxcbiAgc2V0UkNCYXNlRXh0ZW5zaW9uLFxuICBzZXRSQ1BhdGhSZXNvbHZlclxufSk7XG5cbmZ1bmN0aW9uIGVudmlyb25tZW50TmFtZUZyb21Bcmd2KGFyZ3YpIHtcbiAgbGV0IGVudmlyb25tZW50TmFtZSA9IG51bGw7XG5cbiAgYXJndi5maW5kKChhcmd1bWVudCkgPT4geyAgLy8vXG4gICAgY29uc3QgbWF0Y2hlcyA9IGFyZ3VtZW50Lm1hdGNoKC8tLWVudmlyb25tZW50PSguKykvKSxcbiAgICAgICAgICBmb3VuZCA9IChtYXRjaGVzICE9PSBudWxsKTtcblxuICAgIGlmIChmb3VuZCkge1xuICAgICAgY29uc3Qgc2Vjb25kTWF0Y2ggPSBzZWNvbmQobWF0Y2hlcyk7XG5cbiAgICAgIGVudmlyb25tZW50TmFtZSA9IHNlY29uZE1hdGNoO1xuICAgIH1cblxuICAgIHJldHVybiBmb3VuZDtcbiAgfSk7XG5cbiAgcmV0dXJuIGVudmlyb25tZW50TmFtZTtcbn1cblxuZnVuY3Rpb24gYWJzb2x1dGVSQ0ZpbGVQYXRoRnJvbU5vdGhpbmcoKSB7XG4gIGNvbnN0IGZpbGVQYXRoID0gYC4vLiR7YmFzZUV4dGVuc2lvbn1yY2AsXG4gICAgICAgIGFic29sdXRlUkNGaWxlUGF0aCA9IHBhdGhSZXNvbHZlcihmaWxlUGF0aCk7XG5cbiAgcmV0dXJuIGFic29sdXRlUkNGaWxlUGF0aDtcbn1cbiJdfQ==