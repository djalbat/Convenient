'use strict';

var ETX_CHARACTER = "\x03";

function onETX(handler) {
  var _process = process,
      stdin = _process.stdin,
      setRawMode = stdin.setRawMode;

  if (setRawMode) {
    var rawMode = true,
        encoding = 'utf8';
    stdin.setRawMode(rawMode);
    stdin.setEncoding(encoding);
    stdin.resume();
    stdin.addListener('data', dataHandler);
    return offExt;
  }

  function offExt() {
    stdin.removeListener('data', dataHandler);
  }

  function dataHandler(character) {
    if (character === ETX_CHARACTER) {
      handler();
    }
  }
}

module.exports = onETX;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9uRVRYLmpzIl0sIm5hbWVzIjpbIkVUWF9DSEFSQUNURVIiLCJvbkVUWCIsImhhbmRsZXIiLCJwcm9jZXNzIiwic3RkaW4iLCJzZXRSYXdNb2RlIiwicmF3TW9kZSIsImVuY29kaW5nIiwic2V0RW5jb2RpbmciLCJyZXN1bWUiLCJhZGRMaXN0ZW5lciIsImRhdGFIYW5kbGVyIiwib2ZmRXh0IiwicmVtb3ZlTGlzdGVuZXIiLCJjaGFyYWN0ZXIiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFNQSxhQUFhLEdBQUcsTUFBdEI7O0FBRUEsU0FBU0MsS0FBVCxDQUFlQyxPQUFmLEVBQXdCO0FBQUEsaUJBQ0pDLE9BREk7QUFBQSxNQUNkQyxLQURjLFlBQ2RBLEtBRGM7QUFBQSxNQUVkQyxVQUZjLEdBRUNELEtBRkQsQ0FFZEMsVUFGYzs7QUFJdEIsTUFBSUEsVUFBSixFQUFnQjtBQUNkLFFBQU1DLE9BQU8sR0FBRyxJQUFoQjtBQUFBLFFBQ01DLFFBQVEsR0FBRyxNQURqQjtBQUdBSCxJQUFBQSxLQUFLLENBQUNDLFVBQU4sQ0FBaUJDLE9BQWpCO0FBQ0FGLElBQUFBLEtBQUssQ0FBQ0ksV0FBTixDQUFrQkQsUUFBbEI7QUFFQUgsSUFBQUEsS0FBSyxDQUFDSyxNQUFOO0FBRUFMLElBQUFBLEtBQUssQ0FBQ00sV0FBTixDQUFrQixNQUFsQixFQUEwQkMsV0FBMUI7QUFFQSxXQUFPQyxNQUFQO0FBQ0Q7O0FBRUQsV0FBU0EsTUFBVCxHQUFrQjtBQUNoQlIsSUFBQUEsS0FBSyxDQUFDUyxjQUFOLENBQXFCLE1BQXJCLEVBQTZCRixXQUE3QjtBQUNEOztBQUVELFdBQVNBLFdBQVQsQ0FBcUJHLFNBQXJCLEVBQWdDO0FBQzlCLFFBQUlBLFNBQVMsS0FBS2QsYUFBbEIsRUFBaUM7QUFDL0JFLE1BQUFBLE9BQU87QUFDUjtBQUNGO0FBQ0Y7O0FBRURhLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQmYsS0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IEVUWF9DSEFSQUNURVIgPSAnXFx1MDAwMyc7XG5cbmZ1bmN0aW9uIG9uRVRYKGhhbmRsZXIpIHtcbiAgY29uc3QgeyBzdGRpbiB9ID0gcHJvY2VzcyxcbiAgICAgICAgeyBzZXRSYXdNb2RlIH0gPSBzdGRpbjtcblxuICBpZiAoc2V0UmF3TW9kZSkge1xuICAgIGNvbnN0IHJhd01vZGUgPSB0cnVlLFxuICAgICAgICAgIGVuY29kaW5nID0gJ3V0ZjgnO1xuXG4gICAgc3RkaW4uc2V0UmF3TW9kZShyYXdNb2RlKTtcbiAgICBzdGRpbi5zZXRFbmNvZGluZyhlbmNvZGluZyk7XG5cbiAgICBzdGRpbi5yZXN1bWUoKTtcblxuICAgIHN0ZGluLmFkZExpc3RlbmVyKCdkYXRhJywgZGF0YUhhbmRsZXIpO1xuXG4gICAgcmV0dXJuIG9mZkV4dDtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9mZkV4dCgpIHtcbiAgICBzdGRpbi5yZW1vdmVMaXN0ZW5lcignZGF0YScsIGRhdGFIYW5kbGVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRhdGFIYW5kbGVyKGNoYXJhY3Rlcikge1xuICAgIGlmIChjaGFyYWN0ZXIgPT09IEVUWF9DSEFSQUNURVIpIHtcbiAgICAgIGhhbmRsZXIoKTtcbiAgICB9XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBvbkVUWDtcbiJdfQ==