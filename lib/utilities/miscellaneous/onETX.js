"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.onETX = onETX;

var _constants = require("../../constants");

function onETX(handler) {
  var event = _constants.DATA_EVENT;

  if (process.stdin.setRawMode) {
    var rawMode = true,
        encoding = _constants.UTF8_ENCODING;
    process.stdin.setRawMode(rawMode);
    process.stdin.setEncoding(encoding);
    process.stdin.resume();
    process.stdin.addListener(event, dataHandler);
    return offExt;
  }

  function offExt() {
    process.stdin.removeListener(event, dataHandler);
  }

  function dataHandler(character) {
    if (character === _constants.ETX_CHARACTER) {
      handler();
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9uRVRYLmpzIl0sIm5hbWVzIjpbIm9uRVRYIiwiaGFuZGxlciIsImV2ZW50IiwiREFUQV9FVkVOVCIsInByb2Nlc3MiLCJzdGRpbiIsInNldFJhd01vZGUiLCJyYXdNb2RlIiwiZW5jb2RpbmciLCJVVEY4X0VOQ09ESU5HIiwic2V0RW5jb2RpbmciLCJyZXN1bWUiLCJhZGRMaXN0ZW5lciIsImRhdGFIYW5kbGVyIiwib2ZmRXh0IiwicmVtb3ZlTGlzdGVuZXIiLCJjaGFyYWN0ZXIiLCJFVFhfQ0hBUkFDVEVSIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQUVBOztBQUVPLFNBQVNBLEtBQVQsQ0FBZUMsT0FBZixFQUF3QjtBQUM3QixNQUFNQyxLQUFLLEdBQUdDLHFCQUFkOztBQUVBLE1BQUlDLE9BQU8sQ0FBQ0MsS0FBUixDQUFjQyxVQUFsQixFQUE4QjtBQUM1QixRQUFNQyxPQUFPLEdBQUcsSUFBaEI7QUFBQSxRQUNNQyxRQUFRLEdBQUdDLHdCQURqQjtBQUdBTCxJQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBY0MsVUFBZCxDQUF5QkMsT0FBekI7QUFDQUgsSUFBQUEsT0FBTyxDQUFDQyxLQUFSLENBQWNLLFdBQWQsQ0FBMEJGLFFBQTFCO0FBRUFKLElBQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjTSxNQUFkO0FBRUFQLElBQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjTyxXQUFkLENBQTBCVixLQUExQixFQUFpQ1csV0FBakM7QUFFQSxXQUFPQyxNQUFQO0FBQ0Q7O0FBRUQsV0FBU0EsTUFBVCxHQUFrQjtBQUNoQlYsSUFBQUEsT0FBTyxDQUFDQyxLQUFSLENBQWNVLGNBQWQsQ0FBNkJiLEtBQTdCLEVBQW9DVyxXQUFwQztBQUNEOztBQUVELFdBQVNBLFdBQVQsQ0FBcUJHLFNBQXJCLEVBQWdDO0FBQzlCLFFBQUlBLFNBQVMsS0FBS0Msd0JBQWxCLEVBQWlDO0FBQy9CaEIsTUFBQUEsT0FBTztBQUNSO0FBQ0Y7QUFDRiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgeyBEQVRBX0VWRU5ULCBFVFhfQ0hBUkFDVEVSLCBVVEY4X0VOQ09ESU5HIH0gZnJvbSBcIi4uLy4uL2NvbnN0YW50c1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gb25FVFgoaGFuZGxlcikge1xuICBjb25zdCBldmVudCA9IERBVEFfRVZFTlQ7XG5cbiAgaWYgKHByb2Nlc3Muc3RkaW4uc2V0UmF3TW9kZSkge1xuICAgIGNvbnN0IHJhd01vZGUgPSB0cnVlLFxuICAgICAgICAgIGVuY29kaW5nID0gVVRGOF9FTkNPRElORztcblxuICAgIHByb2Nlc3Muc3RkaW4uc2V0UmF3TW9kZShyYXdNb2RlKTtcbiAgICBwcm9jZXNzLnN0ZGluLnNldEVuY29kaW5nKGVuY29kaW5nKTtcblxuICAgIHByb2Nlc3Muc3RkaW4ucmVzdW1lKCk7XG5cbiAgICBwcm9jZXNzLnN0ZGluLmFkZExpc3RlbmVyKGV2ZW50LCBkYXRhSGFuZGxlcik7XG5cbiAgICByZXR1cm4gb2ZmRXh0O1xuICB9XG5cbiAgZnVuY3Rpb24gb2ZmRXh0KCkge1xuICAgIHByb2Nlc3Muc3RkaW4ucmVtb3ZlTGlzdGVuZXIoZXZlbnQsIGRhdGFIYW5kbGVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRhdGFIYW5kbGVyKGNoYXJhY3Rlcikge1xuICAgIGlmIChjaGFyYWN0ZXIgPT09IEVUWF9DSEFSQUNURVIpIHtcbiAgICAgIGhhbmRsZXIoKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==