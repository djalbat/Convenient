"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = onETX;
var ETX_CHARACTER = "\x03";

function onETX(handler) {
  var _process = process,
      stdin = _process.stdin,
      setRawMode = stdin.setRawMode;

  if (setRawMode) {
    var rawMode = true,
        encoding = "utf8";
    stdin.setRawMode(rawMode);
    stdin.setEncoding(encoding);
    stdin.resume();
    stdin.addListener("data", dataHandler);
    return offExt;
  }

  function offExt() {
    stdin.removeListener("data", dataHandler);
  }

  function dataHandler(character) {
    if (character === ETX_CHARACTER) {
      handler();
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9uRVRYLmpzIl0sIm5hbWVzIjpbIkVUWF9DSEFSQUNURVIiLCJvbkVUWCIsImhhbmRsZXIiLCJwcm9jZXNzIiwic3RkaW4iLCJzZXRSYXdNb2RlIiwicmF3TW9kZSIsImVuY29kaW5nIiwic2V0RW5jb2RpbmciLCJyZXN1bWUiLCJhZGRMaXN0ZW5lciIsImRhdGFIYW5kbGVyIiwib2ZmRXh0IiwicmVtb3ZlTGlzdGVuZXIiLCJjaGFyYWN0ZXIiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7QUFFQSxJQUFNQSxhQUFhLEdBQUcsTUFBdEI7O0FBRWUsU0FBU0MsS0FBVCxDQUFlQyxPQUFmLEVBQXdCO0FBQUEsaUJBQ25CQyxPQURtQjtBQUFBLE1BQzdCQyxLQUQ2QixZQUM3QkEsS0FENkI7QUFBQSxNQUU3QkMsVUFGNkIsR0FFZEQsS0FGYyxDQUU3QkMsVUFGNkI7O0FBSXJDLE1BQUlBLFVBQUosRUFBZ0I7QUFDZCxRQUFNQyxPQUFPLEdBQUcsSUFBaEI7QUFBQSxRQUNNQyxRQUFRLEdBQUcsTUFEakI7QUFHQUgsSUFBQUEsS0FBSyxDQUFDQyxVQUFOLENBQWlCQyxPQUFqQjtBQUNBRixJQUFBQSxLQUFLLENBQUNJLFdBQU4sQ0FBa0JELFFBQWxCO0FBRUFILElBQUFBLEtBQUssQ0FBQ0ssTUFBTjtBQUVBTCxJQUFBQSxLQUFLLENBQUNNLFdBQU4sQ0FBa0IsTUFBbEIsRUFBMEJDLFdBQTFCO0FBRUEsV0FBT0MsTUFBUDtBQUNEOztBQUVELFdBQVNBLE1BQVQsR0FBa0I7QUFDaEJSLElBQUFBLEtBQUssQ0FBQ1MsY0FBTixDQUFxQixNQUFyQixFQUE2QkYsV0FBN0I7QUFDRDs7QUFFRCxXQUFTQSxXQUFULENBQXFCRyxTQUFyQixFQUFnQztBQUM5QixRQUFJQSxTQUFTLEtBQUtkLGFBQWxCLEVBQWlDO0FBQy9CRSxNQUFBQSxPQUFPO0FBQ1I7QUFDRjtBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmNvbnN0IEVUWF9DSEFSQUNURVIgPSBcIlxcdTAwMDNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gb25FVFgoaGFuZGxlcikge1xuICBjb25zdCB7IHN0ZGluIH0gPSBwcm9jZXNzLFxuICAgICAgICB7IHNldFJhd01vZGUgfSA9IHN0ZGluO1xuXG4gIGlmIChzZXRSYXdNb2RlKSB7XG4gICAgY29uc3QgcmF3TW9kZSA9IHRydWUsXG4gICAgICAgICAgZW5jb2RpbmcgPSBcInV0ZjhcIjtcblxuICAgIHN0ZGluLnNldFJhd01vZGUocmF3TW9kZSk7XG4gICAgc3RkaW4uc2V0RW5jb2RpbmcoZW5jb2RpbmcpO1xuXG4gICAgc3RkaW4ucmVzdW1lKCk7XG5cbiAgICBzdGRpbi5hZGRMaXN0ZW5lcihcImRhdGFcIiwgZGF0YUhhbmRsZXIpO1xuXG4gICAgcmV0dXJuIG9mZkV4dDtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9mZkV4dCgpIHtcbiAgICBzdGRpbi5yZW1vdmVMaXN0ZW5lcihcImRhdGFcIiwgZGF0YUhhbmRsZXIpO1xuICB9XG5cbiAgZnVuY3Rpb24gZGF0YUhhbmRsZXIoY2hhcmFjdGVyKSB7XG4gICAgaWYgKGNoYXJhY3RlciA9PT0gRVRYX0NIQVJBQ1RFUikge1xuICAgICAgaGFuZGxlcigpO1xuICAgIH1cbiAgfVxufVxuIl19