"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.onETX = onETX;

var _constants = require("../../constants");

function onETX(handler) {
  var event = _constants.DATA_EVENT;

  if (process.stdin.setRawMode) {
    var rawMode = true,
        encoding = _constants.UTF8_ENCODING;
    process.stdin.setRawMode(rawMode);
    process.stdin.setEncoding(encoding);
    process.stdin.resume();
    process.stdin.addListener(event, dataHandler);
    return offExt;
  }

  function offExt() {
    process.stdin.removeListener(event, dataHandler);
  }

  function dataHandler(character) {
    if (character === _constants.ETX_CHARACTER) {
      handler();
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2VzNi91dGlsaXRpZXMvbWlzY2VsbGFuZW91cy9vbkVUWC5qcyJdLCJuYW1lcyI6WyJvbkVUWCIsImhhbmRsZXIiLCJldmVudCIsIkRBVEFfRVZFTlQiLCJwcm9jZXNzIiwic3RkaW4iLCJzZXRSYXdNb2RlIiwicmF3TW9kZSIsImVuY29kaW5nIiwiVVRGOF9FTkNPRElORyIsInNldEVuY29kaW5nIiwicmVzdW1lIiwiYWRkTGlzdGVuZXIiLCJkYXRhSGFuZGxlciIsIm9mZkV4dCIsInJlbW92ZUxpc3RlbmVyIiwiY2hhcmFjdGVyIiwiRVRYX0NIQVJBQ1RFUiJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUFFQTs7QUFFTyxTQUFTQSxLQUFULENBQWVDLE9BQWYsRUFBd0I7QUFDN0IsTUFBTUMsS0FBSyxHQUFHQyxxQkFBZDs7QUFFQSxNQUFJQyxPQUFPLENBQUNDLEtBQVIsQ0FBY0MsVUFBbEIsRUFBOEI7QUFDNUIsUUFBTUMsT0FBTyxHQUFHLElBQWhCO0FBQUEsUUFDTUMsUUFBUSxHQUFHQyx3QkFEakI7QUFHQUwsSUFBQUEsT0FBTyxDQUFDQyxLQUFSLENBQWNDLFVBQWQsQ0FBeUJDLE9BQXpCO0FBQ0FILElBQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjSyxXQUFkLENBQTBCRixRQUExQjtBQUVBSixJQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBY00sTUFBZDtBQUVBUCxJQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBY08sV0FBZCxDQUEwQlYsS0FBMUIsRUFBaUNXLFdBQWpDO0FBRUEsV0FBT0MsTUFBUDtBQUNEOztBQUVELFdBQVNBLE1BQVQsR0FBa0I7QUFDaEJWLElBQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjVSxjQUFkLENBQTZCYixLQUE3QixFQUFvQ1csV0FBcEM7QUFDRDs7QUFFRCxXQUFTQSxXQUFULENBQXFCRyxTQUFyQixFQUFnQztBQUM5QixRQUFJQSxTQUFTLEtBQUtDLHdCQUFsQixFQUFpQztBQUMvQmhCLE1BQUFBLE9BQU87QUFDUjtBQUNGO0FBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IHsgREFUQV9FVkVOVCwgRVRYX0NIQVJBQ1RFUiwgVVRGOF9FTkNPRElORyB9IGZyb20gXCIuLi8uLi9jb25zdGFudHNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIG9uRVRYKGhhbmRsZXIpIHtcbiAgY29uc3QgZXZlbnQgPSBEQVRBX0VWRU5UO1xuXG4gIGlmIChwcm9jZXNzLnN0ZGluLnNldFJhd01vZGUpIHtcbiAgICBjb25zdCByYXdNb2RlID0gdHJ1ZSxcbiAgICAgICAgICBlbmNvZGluZyA9IFVURjhfRU5DT0RJTkc7XG5cbiAgICBwcm9jZXNzLnN0ZGluLnNldFJhd01vZGUocmF3TW9kZSk7XG4gICAgcHJvY2Vzcy5zdGRpbi5zZXRFbmNvZGluZyhlbmNvZGluZyk7XG5cbiAgICBwcm9jZXNzLnN0ZGluLnJlc3VtZSgpO1xuXG4gICAgcHJvY2Vzcy5zdGRpbi5hZGRMaXN0ZW5lcihldmVudCwgZGF0YUhhbmRsZXIpO1xuXG4gICAgcmV0dXJuIG9mZkV4dDtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9mZkV4dCgpIHtcbiAgICBwcm9jZXNzLnN0ZGluLnJlbW92ZUxpc3RlbmVyKGV2ZW50LCBkYXRhSGFuZGxlcik7XG4gIH1cblxuICBmdW5jdGlvbiBkYXRhSGFuZGxlcihjaGFyYWN0ZXIpIHtcbiAgICBpZiAoY2hhcmFjdGVyID09PSBFVFhfQ0hBUkFDVEVSKSB7XG4gICAgICBoYW5kbGVyKCk7XG4gICAgfVxuICB9XG59XG4iXX0=