"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = onETX;

var _constants = require("../../constants");

function onETX(handler) {
  var event = _constants.DATA_EVENT;

  if (process.stdin.setRawMode) {
    var rawMode = true,
        encoding = _constants.UTF8_ENCODING;
    process.stdin.setRawMode(rawMode);
    process.stdin.setEncoding(encoding);
    process.stdin.resume();
    process.stdin.addListener(event, dataHandler);
    return offExt;
  }

  function offExt() {
    process.stdin.removeListener(event, dataHandler);
  }

  function dataHandler(character) {
    if (character === _constants.ETX_CHARACTER) {
      handler();
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL2VzNi91dGlsaXRpZXMvbWlzY2VsbGFuZW91cy9vbkVUWC5qcyJdLCJuYW1lcyI6WyJvbkVUWCIsImhhbmRsZXIiLCJldmVudCIsIkRBVEFfRVZFTlQiLCJwcm9jZXNzIiwic3RkaW4iLCJzZXRSYXdNb2RlIiwicmF3TW9kZSIsImVuY29kaW5nIiwiVVRGOF9FTkNPRElORyIsInNldEVuY29kaW5nIiwicmVzdW1lIiwiYWRkTGlzdGVuZXIiLCJkYXRhSGFuZGxlciIsIm9mZkV4dCIsInJlbW92ZUxpc3RlbmVyIiwiY2hhcmFjdGVyIiwiRVRYX0NIQVJBQ1RFUiJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUFFQTs7QUFFZSxTQUFTQSxLQUFULENBQWVDLE9BQWYsRUFBd0I7QUFDckMsTUFBTUMsS0FBSyxHQUFHQyxxQkFBZDs7QUFFQSxNQUFJQyxPQUFPLENBQUNDLEtBQVIsQ0FBY0MsVUFBbEIsRUFBOEI7QUFDNUIsUUFBTUMsT0FBTyxHQUFHLElBQWhCO0FBQUEsUUFDTUMsUUFBUSxHQUFHQyx3QkFEakI7QUFHQUwsSUFBQUEsT0FBTyxDQUFDQyxLQUFSLENBQWNDLFVBQWQsQ0FBeUJDLE9BQXpCO0FBQ0FILElBQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjSyxXQUFkLENBQTBCRixRQUExQjtBQUVBSixJQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBY00sTUFBZDtBQUVBUCxJQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBY08sV0FBZCxDQUEwQlYsS0FBMUIsRUFBaUNXLFdBQWpDO0FBRUEsV0FBT0MsTUFBUDtBQUNEOztBQUVELFdBQVNBLE1BQVQsR0FBa0I7QUFDaEJWLElBQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjVSxjQUFkLENBQTZCYixLQUE3QixFQUFvQ1csV0FBcEM7QUFDRDs7QUFFRCxXQUFTQSxXQUFULENBQXFCRyxTQUFyQixFQUFnQztBQUM5QixRQUFJQSxTQUFTLEtBQUtDLHdCQUFsQixFQUFpQztBQUMvQmhCLE1BQUFBLE9BQU87QUFDUjtBQUNGO0FBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IHsgREFUQV9FVkVOVCwgRVRYX0NIQVJBQ1RFUiwgVVRGOF9FTkNPRElORyB9IGZyb20gXCIuLi8uLi9jb25zdGFudHNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gb25FVFgoaGFuZGxlcikge1xuICBjb25zdCBldmVudCA9IERBVEFfRVZFTlQ7XG5cbiAgaWYgKHByb2Nlc3Muc3RkaW4uc2V0UmF3TW9kZSkge1xuICAgIGNvbnN0IHJhd01vZGUgPSB0cnVlLFxuICAgICAgICAgIGVuY29kaW5nID0gVVRGOF9FTkNPRElORztcblxuICAgIHByb2Nlc3Muc3RkaW4uc2V0UmF3TW9kZShyYXdNb2RlKTtcbiAgICBwcm9jZXNzLnN0ZGluLnNldEVuY29kaW5nKGVuY29kaW5nKTtcblxuICAgIHByb2Nlc3Muc3RkaW4ucmVzdW1lKCk7XG5cbiAgICBwcm9jZXNzLnN0ZGluLmFkZExpc3RlbmVyKGV2ZW50LCBkYXRhSGFuZGxlcik7XG5cbiAgICByZXR1cm4gb2ZmRXh0O1xuICB9XG5cbiAgZnVuY3Rpb24gb2ZmRXh0KCkge1xuICAgIHByb2Nlc3Muc3RkaW4ucmVtb3ZlTGlzdGVuZXIoZXZlbnQsIGRhdGFIYW5kbGVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRhdGFIYW5kbGVyKGNoYXJhY3Rlcikge1xuICAgIGlmIChjaGFyYWN0ZXIgPT09IEVUWF9DSEFSQUNURVIpIHtcbiAgICAgIGhhbmRsZXIoKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==