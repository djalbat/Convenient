"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = prompt;

var _onETX = _interopRequireDefault(require("./onETX"));

var _asynchronous = require("../../utilities/asynchronous");

var _constants = require("../../constants");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function prompt(options, callback) {
  var force = options.force;

  if (force) {
    var _value = force; ///

    callback(_value);
    return;
  }

  var value = null,
      _options$attempts = options.attempts,
      attempts = _options$attempts === void 0 ? _constants.DEFAULT_ATTEMPTS : _options$attempts,
      context = {
    value: value,
    attempts: attempts,
    options: options
  };
  (0, _asynchronous.whilst)(attempt, function () {
    var value = context.value;
    callback(value);
  }, context);
}

function attempt(next, done, context) {
  var attempts = context.attempts;
  var terminate = attempts-- === 0;

  if (terminate) {
    done();
    return;
  }

  var options = context.options,
      _options$hidden = options.hidden,
      hidden = _options$hidden === void 0 ? false : _options$hidden,
      _options$encoding = options.encoding,
      encoding = _options$encoding === void 0 ? "utf8" : _options$encoding,
      description = options.description,
      _options$initialValue = options.initialValue,
      initialValue = _options$initialValue === void 0 ? "" : _options$initialValue,
      errorMessage = options.errorMessage,
      validationPattern = options.validationPattern,
      validationFunction = options.validationFunction;
  input(description, initialValue, encoding, hidden, callback);

  function callback(value) {
    var valid = validationFunction ? ///
    validationFunction(value) : validationPattern.test(value);

    if (valid) {
      Object.assign(context, {
        value: value
      });
      done();
    } else {
      console.log(errorMessage);
      Object.assign(context, {
        attempts: attempts
      });
      next();
    }
  }
}

function input(description, initialValue, encoding, hidden, callback) {
  var value = initialValue; ///

  var event = _constants.DATA_EVENT,
      rawMode = true,
      offETX = (0, _onETX["default"])(function () {
    console.log(_constants.CTRL_C);
    process.exit();
  });
  process.stdin.setEncoding(encoding);
  process.stdin.setRawMode(rawMode);
  process.stdout.write(description);

  if (!hidden) {
    process.stdout.write(value);
  }

  process.stdin.resume();
  process.stdin.on(event, listener);

  function listener(chunk) {
    var character = chunk.toString(encoding);

    switch (character) {
      case _constants.LINE_FEED_CHARACTER:
      case _constants.CARRIAGE_RETURN_CHARACTER:
        process.stdout.write(_constants.LINE_FEED_CHARACTER);
        process.stdin.removeListener(event, listener);
        process.stdin.pause();
        offETX();
        callback(value);
        break;

      case _constants.BACKSPACE_CHARACTER:
        value = value.slice(0, value.length - 1);
        process.stdout.clearLine();
        process.stdout.cursorTo(0);
        process.stdout.write(description);

        if (!hidden) {
          process.stdout.write(value);
        }

        break;

      default:
        value += character;

        if (!hidden) {
          process.stdout.clearLine();
          process.stdout.cursorTo(0);
          process.stdout.write(description);
          process.stdout.write(value);
        }

        break;
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb21wdC5qcyJdLCJuYW1lcyI6WyJwcm9tcHQiLCJvcHRpb25zIiwiY2FsbGJhY2siLCJmb3JjZSIsInZhbHVlIiwiYXR0ZW1wdHMiLCJERUZBVUxUX0FUVEVNUFRTIiwiY29udGV4dCIsImF0dGVtcHQiLCJuZXh0IiwiZG9uZSIsInRlcm1pbmF0ZSIsImhpZGRlbiIsImVuY29kaW5nIiwiZGVzY3JpcHRpb24iLCJpbml0aWFsVmFsdWUiLCJlcnJvck1lc3NhZ2UiLCJ2YWxpZGF0aW9uUGF0dGVybiIsInZhbGlkYXRpb25GdW5jdGlvbiIsImlucHV0IiwidmFsaWQiLCJ0ZXN0IiwiT2JqZWN0IiwiYXNzaWduIiwiY29uc29sZSIsImxvZyIsImV2ZW50IiwiREFUQV9FVkVOVCIsInJhd01vZGUiLCJvZmZFVFgiLCJDVFJMX0MiLCJwcm9jZXNzIiwiZXhpdCIsInN0ZGluIiwic2V0RW5jb2RpbmciLCJzZXRSYXdNb2RlIiwic3Rkb3V0Iiwid3JpdGUiLCJyZXN1bWUiLCJvbiIsImxpc3RlbmVyIiwiY2h1bmsiLCJjaGFyYWN0ZXIiLCJ0b1N0cmluZyIsIkxJTkVfRkVFRF9DSEFSQUNURVIiLCJDQVJSSUFHRV9SRVRVUk5fQ0hBUkFDVEVSIiwicmVtb3ZlTGlzdGVuZXIiLCJwYXVzZSIsIkJBQ0tTUEFDRV9DSEFSQUNURVIiLCJzbGljZSIsImxlbmd0aCIsImNsZWFyTGluZSIsImN1cnNvclRvIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQUVBOztBQUVBOztBQUVBOzs7O0FBRWUsU0FBU0EsTUFBVCxDQUFnQkMsT0FBaEIsRUFBeUJDLFFBQXpCLEVBQW1DO0FBQUEsTUFDeENDLEtBRHdDLEdBQzlCRixPQUQ4QixDQUN4Q0UsS0FEd0M7O0FBR2hELE1BQUlBLEtBQUosRUFBVztBQUNULFFBQU1DLE1BQUssR0FBR0QsS0FBZCxDQURTLENBQ2E7O0FBRXRCRCxJQUFBQSxRQUFRLENBQUNFLE1BQUQsQ0FBUjtBQUVBO0FBQ0Q7O0FBRUssTUFBQUEsS0FBSyxH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WG1CLFVBQUFBLE9BQU8sQ0FBQ0ssTUFBUixDQUFlQyxLQUFmLENBQXFCakMsS0FBckI7QUFDRDs7QUFFRDs7QUFFRjtBQUNFQSxRQUFBQSxLQUFLLElBQUlzQyxTQUFUOztBQUVBLFlBQUksQ0FBQzlCLE1BQUwsRUFBYTtBQUNYbUIsVUFBQUEsT0FBTyxDQUFDSyxNQUFSLENBQWVlLFNBQWY7QUFFQXBCLFVBQUFBLE9BQU8sQ0FBQ0ssTUFBUixDQUFlZ0IsUUFBZixDQUF3QixDQUF4QjtBQUVBckIsVUFBQUEsT0FBTyxDQUFDSyxNQUFSLENBQWVDLEtBQWYsQ0FBcUJ2QixXQUFyQjtBQUVBaUIsVUFBQUEsT0FBTyxDQUFDSyxNQUFSLENBQWVDLEtBQWYsQ0FBcUJqQyxLQUFyQjtBQUNEOztBQUVEO0FBM0NKO0FBNkNEO0FBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IG9uRVRYIGZyb20gXCIuL29uRVRYXCI7XG5cbmltcG9ydCB7IHdoaWxzdCB9IGZyb20gXCIuLi8uLi91dGlsaXRpZXMvYXN5bmNocm9ub3VzXCI7XG5cbmltcG9ydCB7IENUUkxfQywgREFUQV9FVkVOVCwgREVGQVVMVF9BVFRFTVBUUywgQkFDS1NQQUNFX0NIQVJBQ1RFUiwgTElORV9GRUVEX0NIQVJBQ1RFUiwgQ0FSUklBR0VfUkVUVVJOX0NIQVJBQ1RFUiB9IGZyb20gXCIuLi8uLi9jb25zdGFudHNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcHJvbXB0KG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IHsgZm9yY2UgfSA9IG9wdGlvbnM7XG5cbiAgaWYgKGZvcmNlKSB7XG4gICAgY29uc3QgdmFsdWUgPSBmb3JjZTsgIC8vL1xuXG4gICAgY2FsbGJhY2sodmFsdWUpO1xuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgdmFsdWUgPSBudWxsLFxuICAgICAgICB7IGF0dGVtcHRzID0gREVGQVVMVF9BVFRFTVBUUyB9ID0gb3B0aW9ucyxcbiAgICAgICAgY29udGV4dCA9IHtcbiAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICBhdHRlbXB0cyxcbiAgICAgICAgICBvcHRpb25zXG4gICAgICAgIH07XG5cbiAgd2hpbHN0KGF0dGVtcHQsICgpID0+IHtcbiAgICBjb25zdCB7IHZhbHVlIH0gPSBjb250ZXh0O1xuICAgIFxuICAgIGNhbGxiYWNrKHZhbHVlKTtcbiAgfSwgY29udGV4dCk7XG59XG5cbmZ1bmN0aW9uIGF0dGVtcHQobmV4dCwgZG9uZSwgY29udGV4dCkge1xuICBsZXQgeyBhdHRlbXB0cyB9ID0gY29udGV4dDtcblxuICBjb25zdCB0ZXJtaW5hdGUgPSAoYXR0ZW1wdHMtLSA9PT0gMCk7XG4gIFxuICBpZiAodGVybWluYXRlKSB7XG4gICAgZG9uZSgpO1xuICAgIFxuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHsgb3B0aW9ucyB9ID0gY29udGV4dCxcbiAgICAgICAgeyBoaWRkZW4gPSBmYWxzZSxcbiAgICAgICAgICBlbmNvZGluZyA9IFwidXRmOFwiLFxuICAgICAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgICAgIGluaXRpYWxWYWx1ZSA9IFwiXCIsXG4gICAgICAgICAgZXJyb3JNZXNzYWdlLFxuICAgICAgICAgIHZhbGlkYXRpb25QYXR0ZXJuLFxuICAgICAgICAgIHZhbGlkYXRpb25GdW5jdGlvbiB9ID0gb3B0aW9ucztcblxuICBpbnB1dChkZXNjcmlwdGlvbiwgaW5pdGlhbFZhbHVlLCBlbmNvZGluZywgaGlkZGVuLCBjYWxsYmFjayk7XG5cbiAgZnVuY3Rpb24gY2FsbGJhY2sodmFsdWUpIHtcbiAgICBjb25zdCB2YWxpZCA9IHZhbGlkYXRpb25GdW5jdGlvbiA/ICAvLy9cbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGlvbkZ1bmN0aW9uKHZhbHVlKSA6XG4gICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGlvblBhdHRlcm4udGVzdCh2YWx1ZSk7XG5cbiAgICBpZiAodmFsaWQpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24oY29udGV4dCwge1xuICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgIH0pO1xuXG4gICAgICBkb25lKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yTWVzc2FnZSk7XG5cbiAgICAgIE9iamVjdC5hc3NpZ24oY29udGV4dCwge1xuICAgICAgICBhdHRlbXB0c1xuICAgICAgfSk7XG5cbiAgICAgIG5leHQoKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5wdXQoZGVzY3JpcHRpb24sIGluaXRpYWxWYWx1ZSwgZW5jb2RpbmcsIGhpZGRlbiwgY2FsbGJhY2spIHtcbiAgbGV0IHZhbHVlID0gaW5pdGlhbFZhbHVlOyAvLy9cblxuICBjb25zdCBldmVudCA9IERBVEFfRVZFTlQsXG4gICAgICAgIHJhd01vZGUgPSB0cnVlLFxuICAgICAgICBvZmZFVFggPSBvbkVUWCgoKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coQ1RSTF9DKTtcblxuICAgICAgICAgIHByb2Nlc3MuZXhpdCgpO1xuICAgICAgICB9KTtcblxuICBwcm9jZXNzLnN0ZGluLnNldEVuY29kaW5nKGVuY29kaW5nKTtcblxuICBwcm9jZXNzLnN0ZGluLnNldFJhd01vZGUocmF3TW9kZSk7XG5cbiAgcHJvY2Vzcy5zdGRvdXQud3JpdGUoZGVzY3JpcHRpb24pO1xuXG4gIGlmICghaGlkZGVuKSB7XG4gICAgcHJvY2Vzcy5zdGRvdXQud3JpdGUodmFsdWUpO1xuICB9XG5cbiAgcHJvY2Vzcy5zdGRpbi5yZXN1bWUoKTtcblxuICBwcm9jZXNzLnN0ZGluLm9uKGV2ZW50LCBsaXN0ZW5lcik7XG5cbiAgZnVuY3Rpb24gbGlzdGVuZXIoY2h1bmspIHtcbiAgICBjb25zdCBjaGFyYWN0ZXIgPSBjaHVuay50b1N0cmluZyhlbmNvZGluZyk7XG5cbiAgICBzd2l0Y2ggKGNoYXJhY3Rlcikge1xuICAgICAgY2FzZSBMSU5FX0ZFRURfQ0hBUkFDVEVSIDpcbiAgICAgIGNhc2UgQ0FSUklBR0VfUkVUVVJOX0NIQVJBQ1RFUiA6XG4gICAgICAgIHByb2Nlc3Muc3Rkb3V0LndyaXRlKExJTkVfRkVFRF9DSEFSQUNURVIpO1xuXG4gICAgICAgIHByb2Nlc3Muc3RkaW4ucmVtb3ZlTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcblxuICAgICAgICBwcm9jZXNzLnN0ZGluLnBhdXNlKCk7XG5cbiAgICAgICAgb2ZmRVRYKCk7XG5cbiAgICAgICAgY2FsbGJhY2sodmFsdWUpO1xuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIEJBQ0tTUEFDRV9DSEFSQUNURVIgOlxuICAgICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDAsIHZhbHVlLmxlbmd0aCAtIDEpO1xuXG4gICAgICAgIHByb2Nlc3Muc3Rkb3V0LmNsZWFyTGluZSgpO1xuXG4gICAgICAgIHByb2Nlc3Muc3Rkb3V0LmN1cnNvclRvKDApO1xuXG4gICAgICAgIHByb2Nlc3Muc3Rkb3V0LndyaXRlKGRlc2NyaXB0aW9uKTtcblxuICAgICAgICBpZiAoIWhpZGRlbikge1xuICAgICAgICAgIHByb2Nlc3Muc3Rkb3V0LndyaXRlKHZhbHVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB2YWx1ZSArPSBjaGFyYWN0ZXI7XG5cbiAgICAgICAgaWYgKCFoaWRkZW4pIHtcbiAgICAgICAgICBwcm9jZXNzLnN0ZG91dC5jbGVhckxpbmUoKTtcblxuICAgICAgICAgIHByb2Nlc3Muc3Rkb3V0LmN1cnNvclRvKDApO1xuXG4gICAgICAgICAgcHJvY2Vzcy5zdGRvdXQud3JpdGUoZGVzY3JpcHRpb24pO1xuXG4gICAgICAgICAgcHJvY2Vzcy5zdGRvdXQud3JpdGUodmFsdWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG59XG4iXX0=