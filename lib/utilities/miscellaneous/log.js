'use strict';

var path = require('path');

var pathUtilities = require('../../utilities/path'),
    arrayUtilities = require('../../utilities/array'),
    fileSystemUtilities = require('../../utilities/fileSystem');

var second = arrayUtilities.second,
    concatenatePaths = pathUtilities.concatenatePaths,
    checkFileExists = fileSystemUtilities.checkFileExists,
    readFile = fileSystemUtilities.readFile,
    appendToFile = fileSystemUtilities.appendToFile,
    renameFile = fileSystemUtilities.renameFile,
    getStats = fileSystemUtilities.getStats;


var TRACE = 'TRACE',
    DEBUG = 'DEBUG',
    INFO = 'INFO',
    WARNING = 'WARNING',
    ERROR = 'ERROR',
    FATAL = 'FATAL';

var logLevel = WARNING,
    logFileBaseName = 'default',
    logDirectoryPath = null;

function log(message) {
  var level = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';

  var pertinentStackMessageIndex = 2;

  var levels = [TRACE, DEBUG, INFO, WARNING, ERROR, FATAL];

  if (level) {
    ///
    var levelIndex = levels.indexOf(level),
        logLevelIndex = levels.indexOf(logLevel);

    if (levelIndex < logLevelIndex) {
      return;
    }

    pertinentStackMessageIndex += 1;

    level = level + ' '; ///
  }

  var error = new Error(),
      stack = error.stack,
      stackMessages = stack.split(/\r\n|\n/),
      pertinentStackMessage = stackMessages[pertinentStackMessageIndex],
      currentDateAndTimeString = getCurrentDateAndTimeString(),
      filePath = filePathFromStackMessage(pertinentStackMessage),
      lineNumber = lineNumberFromStackMessage(pertinentStackMessage),
      logMessage = '' + level + currentDateAndTimeString + ' ' + filePath + '(' + lineNumber + ') ' + message;


  console.log(logMessage);

  if (logDirectoryPath !== null) {
    rollOverLogFile();

    var logFilePath = getLogFilePath(),
        logFileContent = logMessage + '\n';

    appendToFile(logFilePath, logFileContent);
  }

  return logMessage;
}

function trace(message) {
  return log(message, TRACE);
}

function debug(message) {
  return log(message, DEBUG);
}

function info(message) {
  return log(message, INFO);
}

function warning(message) {
  return log(message, WARNING);
}

function error(message) {
  return log(message, ERROR);
}

function fatal(message) {
  return log(message, FATAL);
}

function setLogLevel(level) {
  logLevel = level;
}

function setLogFileBaseName(fileBaseName) {
  logFileBaseName = fileBaseName;
}

function setLogDirectoryPath(directoryPath) {
  logDirectoryPath = directoryPath;
}

function getLogFileContent() {
  var logFilePath = getLogFilePath(),
      logFileContent = readFile(logFilePath);

  return logFileContent;
}

Object.assign(log, {
  TRACE: TRACE,
  DEBUG: DEBUG,
  INFO: INFO,
  WARNING: WARNING,
  ERROR: ERROR,
  FATAL: FATAL,
  trace: trace,
  debug: debug,
  info: info,
  warning: warning,
  error: error,
  fatal: fatal,
  setLogLevel: setLogLevel,
  setLogFileBaseName: setLogFileBaseName,
  setLogDirectoryPath: setLogDirectoryPath,
  getLogFileContent: getLogFileContent
});

module.exports = log;

function getLogFilePath() {
  var logFileName = logFileBaseName + '.log',
      logFilePath = concatenatePaths(logDirectoryPath, logFileName);

  return logFilePath;
}

function getRolledOverLogFilePath() {
  var currentDateString = getCurrentDateString(),
      rolledOverLogFileName = logFileBaseName + '.' + currentDateString + '.log',
      rolledOverLogFilePath = concatenatePaths(logDirectoryPath, rolledOverLogFileName);

  return rolledOverLogFilePath;
}

function getLogFileLastModifiedDate() {
  var logFilePath = getLogFilePath(),
      logFileStats = getStats(logFilePath),
      mtime = logFileStats.mtime,
      logFileLastModifiedDate = new Date(mtime); ///

  return logFileLastModifiedDate;
}

function rollOverLogFile() {
  var logFilePath = getLogFilePath(),
      logFileExists = checkFileExists(logFilePath);

  if (!logFileExists) {
    return;
  }

  var logFileLastModifiedDate = getLogFileLastModifiedDate(),
      logFileLastModifiedDateCurrentDate = isDateCurrentDate(logFileLastModifiedDate);

  if (!logFileLastModifiedDateCurrentDate) {
    var rolledOverLogFilePath = getRolledOverLogFilePath();

    renameFile(logFilePath, rolledOverLogFilePath);
  }
}

function isDateCurrentDate(date) {
  var currentDate = new Date(),
      dateString = date.toDateString(),
      currentDateString = currentDate.toDateString(),
      dateCurrentDate = dateString === currentDateString;

  return dateCurrentDate;
}

function getCurrentDateString() {
  var date = new Date(),
      day = padStartWithZeroes(date.getDate(), 2),
      ///
  month = padStartWithZeroes(date.getMonth() + 1, 2),
      ///
  year = date.getFullYear(),
      currentDateAndTimeString = day + '-' + month + '-' + year;

  return currentDateAndTimeString;
}

function getCurrentDateAndTimeString() {
  var date = new Date(),
      day = padStartWithZeroes(date.getDate(), 2),
      ///
  month = padStartWithZeroes(date.getMonth() + 1, 2),
      ///
  year = date.getFullYear(),
      hours = padStartWithZeroes(date.getHours(), 2),
      minutes = padStartWithZeroes(date.getMinutes(), 2),
      seconds = padStartWithZeroes(date.getSeconds(), 2),
      milliseconds = padStartWithZeroes(date.getMilliseconds(), 3),
      currentDateAndTimeString = day + '-' + month + '-' + year + ' ' + hours + ':' + minutes + ':' + seconds + '.' + milliseconds;

  return currentDateAndTimeString;
}

function filePathFromStackMessage(stackMessage) {
  var matches = stackMessage.match(/(\/.+)\:\d+\:\d+/),
      secondMatch = second(matches),
      absoluteFilePath = secondMatch,
      ///
  currentWorkingDirectoryPath = path.resolve('.'),
      ///
  currentWorkingDirectoryPathLength = currentWorkingDirectoryPath.length,
      start = currentWorkingDirectoryPathLength + 1,
      ///
  filePath = absoluteFilePath.substr(start);

  return filePath;
}

function lineNumberFromStackMessage(stackMessage) {
  var matches = stackMessage.match(/\:(\d+)/),
      secondMatch = second(matches),
      lineNumber = secondMatch; ///

  return lineNumber;
}

function padStartWithZeroes(string, targetLength) {
  var padString = '0',
      paddedString = padStart(string, targetLength, padString);

  return paddedString;
}

function padStart(string, targetLength, padString) {
  var padding = '';

  for (var index = 0; index < targetLength; index++) {
    padding += padString;
  }

  var paddedString = ('' + padding + string).substr(-targetLength);

  return paddedString;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2VzNi91dGlsaXRpZXMvbWlzY2VsbGFuZW91cy9sb2cuanMiXSwibmFtZXMiOlsicGF0aCIsInJlcXVpcmUiLCJwYXRoVXRpbGl0aWVzIiwiYXJyYXlVdGlsaXRpZXMiLCJmaWxlU3lzdGVtVXRpbGl0aWVzIiwic2Vjb25kIiwiY29uY2F0ZW5hdGVQYXRocyIsImNoZWNrRmlsZUV4aXN0cyIsInJlYWRGaWxlIiwiYXBwZW5kVG9GaWxlIiwicmVuYW1lRmlsZSIsImdldFN0YXRzIiwiVFJBQ0UiLCJERUJVRyIsIklORk8iLCJXQVJOSU5HIiwiRVJST1IiLCJGQVRBTCIsImxvZ0xldmVsIiwibG9nRmlsZUJhc2VOYW1lIiwibG9nRGlyZWN0b3J5UGF0aCIsImxvZyIsIm1lc3NhZ2UiLCJsZXZlbCIsInBlcnRpbmVudFN0YWNrTWVzc2FnZUluZGV4IiwibGV2ZWxzIiwibGV2ZWxJbmRleCIsImluZGV4T2YiLCJsb2dMZXZlbEluZGV4IiwiRXJyb3IiLCJzdGFjayIsImVycm9yIiwic3RhY2tNZXNzYWdlcyIsInNwbGl0IiwicGVydGluZW50U3RhY2tNZXNzYWdlIiwiY3VycmVudERhdGVBbmRUaW1lU3RyaW5nIiwiZ2V0Q3VycmVudERhdGVBbmRUaW1lU3RyaW5nIiwiZmlsZVBhdGgiLCJmaWxlUGF0aEZyb21TdGFja01lc3NhZ2UiLCJsaW5lTnVtYmVyIiwibGluZU51bWJlckZyb21TdGFja01lc3NhZ2UiLCJsb2dNZXNzYWdlIiwiY29uc29sZSIsInJvbGxPdmVyTG9nRmlsZSIsImxvZ0ZpbGVQYXRoIiwiZ2V0TG9nRmlsZVBhdGgiLCJsb2dGaWxlQ29udGVudCIsInRyYWNlIiwiZGVidWciLCJpbmZvIiwid2FybmluZyIsImZhdGFsIiwic2V0TG9nTGV2ZWwiLCJzZXRMb2dGaWxlQmFzZU5hbWUiLCJmaWxlQmFzZU5hbWUiLCJzZXRMb2dEaXJlY3RvcnlQYXRoIiwiZGlyZWN0b3J5UGF0aCIsImdldExvZ0ZpbGVDb250ZW50IiwiT2JqZWN0IiwiYXNzaWduIiwibW9kdWxlIiwiZXhwb3J0cyIsImxvZ0ZpbGVOYW1lIiwiZ2V0Um9sbGVkT3ZlckxvZ0ZpbGVQYXRoIiwiY3VycmVudERhdGVTdHJpbmciLCJnZXRDdXJyZW50RGF0ZVN0cmluZyIsInJvbGxlZE92ZXJMb2dGaWxlTmFtZSIsInJvbGxlZE92ZXJMb2dGaWxlUGF0aCIsImdldExvZ0ZpbGVMYXN0TW9kaWZpZWREYXRlIiwibG9nRmlsZVN0YXRzIiwibXRpbWUiLCJsb2dGaWxlTGFzdE1vZGlmaWVkRGF0ZSIsIkRhdGUiLCJsb2dGaWxlRXhpc3RzIiwibG9nRmlsZUxhc3RNb2RpZmllZERhdGVDdXJyZW50RGF0ZSIsImlzRGF0ZUN1cnJlbnREYXRlIiwiZGF0ZSIsImN1cnJlbnREYXRlIiwiZGF0ZVN0cmluZyIsInRvRGF0ZVN0cmluZyIsImRhdGVDdXJyZW50RGF0ZSIsImRheSIsInBhZFN0YXJ0V2l0aFplcm9lcyIsImdldERhdGUiLCJtb250aCIsImdldE1vbnRoIiwieWVhciIsImdldEZ1bGxZZWFyIiwiaG91cnMiLCJnZXRIb3VycyIsIm1pbnV0ZXMiLCJnZXRNaW51dGVzIiwic2Vjb25kcyIsImdldFNlY29uZHMiLCJtaWxsaXNlY29uZHMiLCJnZXRNaWxsaXNlY29uZHMiLCJzdGFja01lc3NhZ2UiLCJtYXRjaGVzIiwibWF0Y2giLCJzZWNvbmRNYXRjaCIsImFic29sdXRlRmlsZVBhdGgiLCJjdXJyZW50V29ya2luZ0RpcmVjdG9yeVBhdGgiLCJyZXNvbHZlIiwiY3VycmVudFdvcmtpbmdEaXJlY3RvcnlQYXRoTGVuZ3RoIiwibGVuZ3RoIiwic3RhcnQiLCJzdWJzdHIiLCJzdHJpbmciLCJ0YXJnZXRMZW5ndGgiLCJwYWRTdHJpbmciLCJwYWRkZWRTdHJpbmciLCJwYWRTdGFydCIsInBhZGRpbmciLCJpbmRleCJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBTUEsT0FBT0MsUUFBUSxNQUFSLENBQWI7O0FBRUEsSUFBTUMsZ0JBQWdCRCxRQUFRLHNCQUFSLENBQXRCO0FB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SCxHQUFhTCxNQUFiLEVBQXNCRCxNQUF0QixDQUE2QixDQUFDRSxZQUE5QixDQUFyQjs7QUFFQSxTQUFPRSxZQUFQO0FBQ0QiLCJmaWxlIjoibG9nLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuXG5jb25zdCBwYXRoVXRpbGl0aWVzID0gcmVxdWlyZSgnLi4vLi4vdXRpbGl0aWVzL3BhdGgnKSxcbiAgICAgIGFycmF5VXRpbGl0aWVzID0gcmVxdWlyZSgnLi4vLi4vdXRpbGl0aWVzL2FycmF5JyksXG4gICAgICBmaWxlU3lzdGVtVXRpbGl0aWVzID0gcmVxdWlyZSgnLi4vLi4vdXRpbGl0aWVzL2ZpbGVTeXN0ZW0nKTtcblxuY29uc3QgeyBzZWNvbmQgfSA9IGFycmF5VXRpbGl0aWVzLFxuICAgICAgeyBjb25jYXRlbmF0ZVBhdGhzIH0gPSBwYXRoVXRpbGl0aWVzLFxuICAgICAgeyBjaGVja0ZpbGVFeGlzdHMsIHJlYWRGaWxlLCBhcHBlbmRUb0ZpbGUsIHJlbmFtZUZpbGUsIGdldFN0YXRzIH0gPSBmaWxlU3lzdGVtVXRpbGl0aWVzO1xuXG5jb25zdCBUUkFDRSA9ICdUUkFDRScsXG4gICAgICBERUJVRyA9ICdERUJVRycsXG4gICAgICBJTkZPID0gJ0lORk8nLFxuICAgICAgV0FSTklORyA9ICdXQVJOSU5HJyxcbiAgICAgIEVSUk9SID0gJ0VSUk9SJyxcbiAgICAgIEZBVEFMID0gJ0ZBVEFMJztcblxubGV0IGxvZ0xldmVsID0gV0FSTklORyxcbiAgICBsb2dGaWxlQmFzZU5hbWUgPSAnZGVmYXVsdCcsXG4gICAgbG9nRGlyZWN0b3J5UGF0aCA9IG51bGw7XG5cbmZ1bmN0aW9uIGxvZyhtZXNzYWdlLCBsZXZlbCA9ICcnKSB7XG4gIGxldCBwZXJ0aW5lbnRTdGFja01lc3NhZ2VJbmRleCA9IDI7XG5cbiAgY29uc3QgbGV2ZWxzID0gW1xuICAgIFRSQUNFLFxuICAgIERFQlVHLFxuICAgIElORk8sXG4gICAgV0FSTklORyxcbiAgICBFUlJPUixcbiAgICBGQVRBTFxuICBdO1xuXG4gIGlmIChsZXZlbCkgeyAvLy9cbiAgICBjb25zdCBsZXZlbEluZGV4ID0gbGV2ZWxzLmluZGV4T2YobGV2ZWwpLFxuICAgICAgICAgIGxvZ0xldmVsSW5kZXggPSBsZXZlbHMuaW5kZXhPZihsb2dMZXZlbCk7XG5cbiAgICBpZiAobGV2ZWxJbmRleCA8IGxvZ0xldmVsSW5kZXgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBwZXJ0aW5lbnRTdGFja01lc3NhZ2VJbmRleCArPSAxO1xuXG4gICAgbGV2ZWwgPSBgJHtsZXZlbH0gYDsgIC8vL1xuICB9XG5cbiAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoKSxcbiAgICAgICAgeyBzdGFjayB9ID0gZXJyb3IsXG4gICAgICAgIHN0YWNrTWVzc2FnZXMgPSBzdGFjay5zcGxpdCgvXFxyXFxufFxcbi8pLFxuICAgICAgICBwZXJ0aW5lbnRTdGFja01lc3NhZ2UgPSBzdGFja01lc3NhZ2VzW3BlcnRpbmVudFN0YWNrTWVzc2FnZUluZGV4XSxcbiAgICAgICAgY3VycmVudERhdGVBbmRUaW1lU3RyaW5nID0gZ2V0Q3VycmVudERhdGVBbmRUaW1lU3RyaW5nKCksXG4gICAgICAgIGZpbGVQYXRoID0gZmlsZVBhdGhGcm9tU3RhY2tNZXNzYWdlKHBlcnRpbmVudFN0YWNrTWVzc2FnZSksXG4gICAgICAgIGxpbmVOdW1iZXIgPSBsaW5lTnVtYmVyRnJvbVN0YWNrTWVzc2FnZShwZXJ0aW5lbnRTdGFja01lc3NhZ2UpLFxuICAgICAgICBsb2dNZXNzYWdlID0gYCR7bGV2ZWx9JHtjdXJyZW50RGF0ZUFuZFRpbWVTdHJpbmd9ICR7ZmlsZVBhdGh9KCR7bGluZU51bWJlcn0pICR7bWVzc2FnZX1gO1xuXG4gIGNvbnNvbGUubG9nKGxvZ01lc3NhZ2UpO1xuXG4gIGlmIChsb2dEaXJlY3RvcnlQYXRoICE9PSBudWxsKSB7XG4gICAgcm9sbE92ZXJMb2dGaWxlKCk7XG5cbiAgICBjb25zdCBsb2dGaWxlUGF0aCA9IGdldExvZ0ZpbGVQYXRoKCksXG4gICAgICAgICAgbG9nRmlsZUNvbnRlbnQgPSBgJHtsb2dNZXNzYWdlfVxcbmA7XG5cbiAgICBhcHBlbmRUb0ZpbGUobG9nRmlsZVBhdGgsIGxvZ0ZpbGVDb250ZW50KTtcbiAgfVxuXG4gIHJldHVybiBsb2dNZXNzYWdlO1xufVxuXG5mdW5jdGlvbiB0cmFjZShtZXNzYWdlKSB7IHJldHVybiBsb2cobWVzc2FnZSwgVFJBQ0UpOyB9XG5cbmZ1bmN0aW9uIGRlYnVnKG1lc3NhZ2UpIHsgcmV0dXJuIGxvZyhtZXNzYWdlLCBERUJVRyk7IH1cblxuZnVuY3Rpb24gaW5mbyhtZXNzYWdlKSB7IHJldHVybiBsb2cobWVzc2FnZSwgSU5GTyk7IH1cblxuZnVuY3Rpb24gd2FybmluZyhtZXNzYWdlKSB7IHJldHVybiBsb2cobWVzc2FnZSwgV0FSTklORyk7IH1cblxuZnVuY3Rpb24gZXJyb3IobWVzc2FnZSkgeyByZXR1cm4gbG9nKG1lc3NhZ2UsIEVSUk9SKTsgfVxuXG5mdW5jdGlvbiBmYXRhbChtZXNzYWdlKSB7IHJldHVybiBsb2cobWVzc2FnZSwgRkFUQUwpOyB9XG5cbmZ1bmN0aW9uIHNldExvZ0xldmVsKGxldmVsKSB7IGxvZ0xldmVsID0gbGV2ZWw7IH1cblxuZnVuY3Rpb24gc2V0TG9nRmlsZUJhc2VOYW1lKGZpbGVCYXNlTmFtZSkgeyBsb2dGaWxlQmFzZU5hbWUgPSBmaWxlQmFzZU5hbWU7IH1cblxuZnVuY3Rpb24gc2V0TG9nRGlyZWN0b3J5UGF0aChkaXJlY3RvcnlQYXRoKSB7IGxvZ0RpcmVjdG9yeVBhdGggPSBkaXJlY3RvcnlQYXRoOyB9XG5cbmZ1bmN0aW9uIGdldExvZ0ZpbGVDb250ZW50KCkge1xuICBjb25zdCBsb2dGaWxlUGF0aCA9IGdldExvZ0ZpbGVQYXRoKCksXG4gICAgICAgIGxvZ0ZpbGVDb250ZW50ID0gcmVhZEZpbGUobG9nRmlsZVBhdGgpO1xuXG4gIHJldHVybiBsb2dGaWxlQ29udGVudDtcbn1cblxuT2JqZWN0LmFzc2lnbihsb2csIHtcbiAgVFJBQ0UsXG4gIERFQlVHLFxuICBJTkZPLFxuICBXQVJOSU5HLFxuICBFUlJPUixcbiAgRkFUQUwsXG4gIHRyYWNlLFxuICBkZWJ1ZyxcbiAgaW5mbyxcbiAgd2FybmluZyxcbiAgZXJyb3IsXG4gIGZhdGFsLFxuICBzZXRMb2dMZXZlbCxcbiAgc2V0TG9nRmlsZUJhc2VOYW1lLFxuICBzZXRMb2dEaXJlY3RvcnlQYXRoLFxuICBnZXRMb2dGaWxlQ29udGVudFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gbG9nO1xuXG5mdW5jdGlvbiBnZXRMb2dGaWxlUGF0aCgpIHtcbiAgY29uc3QgbG9nRmlsZU5hbWUgPSBgJHtsb2dGaWxlQmFzZU5hbWV9LmxvZ2AsXG4gICAgICAgIGxvZ0ZpbGVQYXRoID0gY29uY2F0ZW5hdGVQYXRocyhsb2dEaXJlY3RvcnlQYXRoLCBsb2dGaWxlTmFtZSk7XG5cbiAgcmV0dXJuIGxvZ0ZpbGVQYXRoO1xufVxuXG5mdW5jdGlvbiBnZXRSb2xsZWRPdmVyTG9nRmlsZVBhdGgoKSB7XG4gIGNvbnN0IGN1cnJlbnREYXRlU3RyaW5nID0gZ2V0Q3VycmVudERhdGVTdHJpbmcoKSxcbiAgICAgICAgcm9sbGVkT3ZlckxvZ0ZpbGVOYW1lID0gYCR7bG9nRmlsZUJhc2VOYW1lfS4ke2N1cnJlbnREYXRlU3RyaW5nfS5sb2dgLFxuICAgICAgICByb2xsZWRPdmVyTG9nRmlsZVBhdGggPSBjb25jYXRlbmF0ZVBhdGhzKGxvZ0RpcmVjdG9yeVBhdGgsIHJvbGxlZE92ZXJMb2dGaWxlTmFtZSk7XG5cbiAgcmV0dXJuIHJvbGxlZE92ZXJMb2dGaWxlUGF0aDtcbn1cblxuZnVuY3Rpb24gZ2V0TG9nRmlsZUxhc3RNb2RpZmllZERhdGUoKSB7XG4gIGNvbnN0IGxvZ0ZpbGVQYXRoID0gZ2V0TG9nRmlsZVBhdGgoKSxcbiAgICAgICAgbG9nRmlsZVN0YXRzID0gZ2V0U3RhdHMobG9nRmlsZVBhdGgpLFxuICAgICAgICB7IG10aW1lIH0gPSBsb2dGaWxlU3RhdHMsXG4gICAgICAgIGxvZ0ZpbGVMYXN0TW9kaWZpZWREYXRlID0gbmV3IERhdGUobXRpbWUpOyAgLy8vXG5cbiAgcmV0dXJuIGxvZ0ZpbGVMYXN0TW9kaWZpZWREYXRlO1xufVxuXG5mdW5jdGlvbiByb2xsT3ZlckxvZ0ZpbGUoKSB7XG4gIGNvbnN0IGxvZ0ZpbGVQYXRoID0gZ2V0TG9nRmlsZVBhdGgoKSxcbiAgICAgICAgbG9nRmlsZUV4aXN0cyA9IGNoZWNrRmlsZUV4aXN0cyhsb2dGaWxlUGF0aCk7XG5cbiAgaWYgKCFsb2dGaWxlRXhpc3RzKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgbG9nRmlsZUxhc3RNb2RpZmllZERhdGUgPSBnZXRMb2dGaWxlTGFzdE1vZGlmaWVkRGF0ZSgpLFxuICAgICAgICBsb2dGaWxlTGFzdE1vZGlmaWVkRGF0ZUN1cnJlbnREYXRlID0gaXNEYXRlQ3VycmVudERhdGUobG9nRmlsZUxhc3RNb2RpZmllZERhdGUpO1xuXG4gIGlmICghbG9nRmlsZUxhc3RNb2RpZmllZERhdGVDdXJyZW50RGF0ZSkge1xuICAgIGNvbnN0IHJvbGxlZE92ZXJMb2dGaWxlUGF0aCA9IGdldFJvbGxlZE92ZXJMb2dGaWxlUGF0aCgpO1xuXG4gICAgcmVuYW1lRmlsZShsb2dGaWxlUGF0aCwgcm9sbGVkT3ZlckxvZ0ZpbGVQYXRoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpc0RhdGVDdXJyZW50RGF0ZShkYXRlKSB7XG4gIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKSxcbiAgICAgICAgZGF0ZVN0cmluZyA9IGRhdGUudG9EYXRlU3RyaW5nKCksXG4gICAgICAgIGN1cnJlbnREYXRlU3RyaW5nID0gY3VycmVudERhdGUudG9EYXRlU3RyaW5nKCksXG4gICAgICAgIGRhdGVDdXJyZW50RGF0ZSA9IChkYXRlU3RyaW5nID09PSBjdXJyZW50RGF0ZVN0cmluZyk7XG5cbiAgcmV0dXJuIGRhdGVDdXJyZW50RGF0ZTtcbn1cblxuZnVuY3Rpb24gZ2V0Q3VycmVudERhdGVTdHJpbmcoKSB7XG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpLFxuICAgICAgICBkYXkgPSBwYWRTdGFydFdpdGhaZXJvZXMoZGF0ZS5nZXREYXRlKCksIDIpLCAgLy8vXG4gICAgICAgIG1vbnRoID0gcGFkU3RhcnRXaXRoWmVyb2VzKGRhdGUuZ2V0TW9udGgoKSArIDEsIDIpLCAvLy9cbiAgICAgICAgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKSxcbiAgICAgICAgY3VycmVudERhdGVBbmRUaW1lU3RyaW5nID0gYCR7ZGF5fS0ke21vbnRofS0ke3llYXJ9YDtcblxuICByZXR1cm4gY3VycmVudERhdGVBbmRUaW1lU3RyaW5nO1xufVxuXG5mdW5jdGlvbiBnZXRDdXJyZW50RGF0ZUFuZFRpbWVTdHJpbmcoKSB7XG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpLFxuICAgICAgICBkYXkgPSBwYWRTdGFydFdpdGhaZXJvZXMoZGF0ZS5nZXREYXRlKCksIDIpLCAgLy8vXG4gICAgICAgIG1vbnRoID0gcGFkU3RhcnRXaXRoWmVyb2VzKGRhdGUuZ2V0TW9udGgoKSArIDEsIDIpLCAvLy9cbiAgICAgICAgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKSxcbiAgICAgICAgaG91cnMgPSBwYWRTdGFydFdpdGhaZXJvZXMoZGF0ZS5nZXRIb3VycygpLCAyKSxcbiAgICAgICAgbWludXRlcyA9IHBhZFN0YXJ0V2l0aFplcm9lcyhkYXRlLmdldE1pbnV0ZXMoKSwgMiksXG4gICAgICAgIHNlY29uZHMgPSBwYWRTdGFydFdpdGhaZXJvZXMoZGF0ZS5nZXRTZWNvbmRzKCksIDIpLFxuICAgICAgICBtaWxsaXNlY29uZHMgPSBwYWRTdGFydFdpdGhaZXJvZXMoZGF0ZS5nZXRNaWxsaXNlY29uZHMoKSwgMyksXG4gICAgICAgIGN1cnJlbnREYXRlQW5kVGltZVN0cmluZyA9IGAke2RheX0tJHttb250aH0tJHt5ZWFyfSAke2hvdXJzfToke21pbnV0ZXN9OiR7c2Vjb25kc30uJHttaWxsaXNlY29uZHN9YDtcblxuICByZXR1cm4gY3VycmVudERhdGVBbmRUaW1lU3RyaW5nO1xufVxuXG5mdW5jdGlvbiBmaWxlUGF0aEZyb21TdGFja01lc3NhZ2Uoc3RhY2tNZXNzYWdlKSB7XG4gIGNvbnN0IG1hdGNoZXMgPSBzdGFja01lc3NhZ2UubWF0Y2goLyhcXC8uKylcXDpcXGQrXFw6XFxkKy8pLFxuICAgICAgICBzZWNvbmRNYXRjaCA9IHNlY29uZChtYXRjaGVzKSxcbiAgICAgICAgYWJzb2x1dGVGaWxlUGF0aCA9IHNlY29uZE1hdGNoLCAgLy8vXG4gICAgICAgIGN1cnJlbnRXb3JraW5nRGlyZWN0b3J5UGF0aCA9IHBhdGgucmVzb2x2ZSgnLicpLCAgLy8vXG4gICAgICAgIGN1cnJlbnRXb3JraW5nRGlyZWN0b3J5UGF0aExlbmd0aCA9IGN1cnJlbnRXb3JraW5nRGlyZWN0b3J5UGF0aC5sZW5ndGgsXG4gICAgICAgIHN0YXJ0ID0gY3VycmVudFdvcmtpbmdEaXJlY3RvcnlQYXRoTGVuZ3RoICsgMSwgIC8vL1xuICAgICAgICBmaWxlUGF0aCA9IGFic29sdXRlRmlsZVBhdGguc3Vic3RyKHN0YXJ0KTtcblxuICByZXR1cm4gZmlsZVBhdGg7XG59XG5cbmZ1bmN0aW9uIGxpbmVOdW1iZXJGcm9tU3RhY2tNZXNzYWdlKHN0YWNrTWVzc2FnZSkge1xuICBjb25zdCBtYXRjaGVzID0gc3RhY2tNZXNzYWdlLm1hdGNoKC9cXDooXFxkKykvKSxcbiAgICAgICAgc2Vjb25kTWF0Y2ggPSBzZWNvbmQobWF0Y2hlcyksXG4gICAgICAgIGxpbmVOdW1iZXIgPSBzZWNvbmRNYXRjaDsgLy8vXG5cbiAgcmV0dXJuIGxpbmVOdW1iZXI7XG59XG5cbmZ1bmN0aW9uIHBhZFN0YXJ0V2l0aFplcm9lcyhzdHJpbmcsIHRhcmdldExlbmd0aCkge1xuICBjb25zdCBwYWRTdHJpbmcgPSAnMCcsXG4gICAgICAgIHBhZGRlZFN0cmluZyA9IHBhZFN0YXJ0KHN0cmluZywgdGFyZ2V0TGVuZ3RoLCBwYWRTdHJpbmcpO1xuXG4gIHJldHVybiBwYWRkZWRTdHJpbmc7XG59XG5cbmZ1bmN0aW9uIHBhZFN0YXJ0KHN0cmluZywgdGFyZ2V0TGVuZ3RoLCBwYWRTdHJpbmcpIHtcbiAgbGV0IHBhZGRpbmcgPSAnJztcblxuICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGFyZ2V0TGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgcGFkZGluZyArPSBwYWRTdHJpbmc7XG4gIH1cblxuICBjb25zdCBwYWRkZWRTdHJpbmcgPSBgJHtwYWRkaW5nfSR7c3RyaW5nfWAuc3Vic3RyKC10YXJnZXRMZW5ndGgpO1xuXG4gIHJldHVybiBwYWRkZWRTdHJpbmc7XG59XG5cbiJdfQ==