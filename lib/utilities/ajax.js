"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.get = get;
exports.post = post;
exports.request = request;
exports.default = void 0;
var _constants = require("../constants");
function get(host, uri, parameters, headers, callback) {
    if (callback === undefined) {
        callback = headers; ///
        headers = {
        };
    }
    var method = _constants.GET, body = null;
    guaranteeAccept(headers);
    request(host, uri, parameters, method, body, headers, callback);
}
function post(host, uri, parameters, body, headers, callback) {
    if (callback === undefined) {
        callback = headers; ///
        headers = {
        };
    }
    var method = _constants.POST;
    guaranteeAccept(headers);
    guaranteeContentType(headers);
    request(host, uri, parameters, method, body, headers, callback);
}
function request(host, uri, parameters, method, body, headers, callback) {
    var url = urlFromHostURIAndParameters(host, uri, parameters), accept = headers[_constants.ACCEPT] || null, contentType = headers[_constants.CONTENT_TYPE] || null, xmlHttpRequest = new XMLHttpRequest();
    if (contentType === _constants.APPLICATION_JSON) {
        var json = body, jsonString = JSON.stringify(json);
        body = jsonString; ///
    }
    xmlHttpRequest.onreadystatechange = function() {
        var readyState = xmlHttpRequest.readyState, status = xmlHttpRequest.status, responseText = xmlHttpRequest.responseText;
        if (readyState == 4) {
            var body1 = responseText;
            if (accept === _constants.APPLICATION_JSON) {
                try {
                    var jsonString = body1, json = JSON.parse(jsonString);
                    body1 = json; ///
                } catch (error) {
                    body1 = null;
                }
                callback(body1, status);
            }
        }
    };
    xmlHttpRequest.open(method, url);
    if (accept !== null) {
        xmlHttpRequest.setRequestHeader(_constants.ACCEPT, accept);
    }
    if (contentType !== null) {
        xmlHttpRequest.setRequestHeader(_constants.CONTENT_TYPE, contentType);
    }
    body !== null ? xmlHttpRequest.send(body) : xmlHttpRequest.send();
}
var _default = {
    get: get,
    post: post,
    request: request
};
exports.default = _default;
function guarantee(headers, name, value) {
    var propertyNames = Object.getOwnPropertyNames(headers), names = propertyNames.map(function(propertyName) {
        var lowerCasePropertyName = propertyName.toLowerCase(), name1 = lowerCasePropertyName; ///
        return name1;
    }), namesIncludesName = names.includes(name);
    if (!namesIncludesName) {
        headers[name] = value;
    }
}
function guaranteeAccept(headers) {
    var name = _constants.ACCEPT, value = _constants.APPLICATION_JSON; ///
    guarantee(headers, name, value);
}
function guaranteeContentType(headers) {
    var name = _constants.CONTENT_TYPE, value = _constants.APPLICATION_JSON; ///
    guarantee(headers, name, value);
}
function queryStringFromParameters(parameters) {
    var names = Object.keys(parameters), namesLength = names.length, lastIndex = namesLength - 1, queryString = names.reduce(function(queryString1, name, index) {
        var value = parameters[name], encodedName = encodeURIComponent(name), encodedValue = encodeURIComponent(value), ampersandOrNothing = index !== lastIndex ? "&" : "";
        queryString1 += "".concat(encodedName, "=").concat(encodedValue).concat(ampersandOrNothing);
        return queryString1;
    }, "");
    return queryString;
}
function urlFromHostURIAndParameters(host, uri, parameters) {
    var queryString = queryStringFromParameters(parameters), url = queryString === "" ? "".concat(host).concat(uri) : "".concat(host).concat(uri, "?").concat(queryString);
    return url;
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsaXRpZXMvYWpheC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IHsgR0VULFxuICAgICAgICAgUE9TVCxcbiAgICAgICAgIEFDQ0VQVCxcbiAgICAgICAgIENPTlRFTlRfVFlQRSxcbiAgICAgICAgIEFQUExJQ0FUSU9OX0pTT04gfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXQoaG9zdCwgdXJpLCBwYXJhbWV0ZXJzLCBoZWFkZXJzLCBjYWxsYmFjaykge1xuICBpZiAoY2FsbGJhY2sgPT09IHVuZGVmaW5lZCkge1xuICAgIGNhbGxiYWNrID0gaGVhZGVyczsgLy8vXG4gICAgaGVhZGVycyA9IHt9O1xuICB9XG5cbiAgY29uc3QgbWV0aG9kID0gR0VULFxuICAgICAgICBib2R5ID0gbnVsbDtcblxuICBndWFyYW50ZWVBY2NlcHQoaGVhZGVycyk7XG5cbiAgcmVxdWVzdChob3N0LCB1cmksIHBhcmFtZXRlcnMsIG1ldGhvZCwgYm9keSwgaGVhZGVycywgY2FsbGJhY2spO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcG9zdChob3N0LCB1cmksIHBhcmFtZXRlcnMsIGJvZHksIGhlYWRlcnMsIGNhbGxiYWNrKSB7XG4gIGlmIChjYWxsYmFjayA9PT0gdW5kZWZpbmVkKSB7XG4gICAgY2FsbGJhY2sgPSBoZWFkZXJzOyAvLy9cbiAgICBoZWFkZXJzID0ge307XG4gIH1cblxuICBjb25zdCBtZXRob2QgPSBQT1NUO1xuXG4gIGd1YXJhbnRlZUFjY2VwdChoZWFkZXJzKTtcblxuICBndWFyYW50ZWVDb250ZW50VHlwZShoZWFkZXJzKTtcblxuICByZXF1ZXN0KGhvc3QsIHVyaSwgcGFyYW1ldGVycywgbWV0aG9kLCBib2R5LCBoZWFkZXJzLCBjYWxsYmFjayk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXF1ZXN0KGhvc3QsIHVyaSwgcGFyYW1ldGVycywgbWV0aG9kLCBib2R5LCBoZWFkZXJzLCBjYWxsYmFjaykge1xuICBjb25zdCB1cmwgPSB1cmxGcm9tSG9zdFVSSUFuZFBhcmFtZXRlcnMoaG9zdCwgdXJpLCBwYXJhbWV0ZXJzKSxcbiAgICAgICAgYWNjZXB0ID0gaGVhZGVyc1tBQ0NFUFRdIHx8IG51bGwsXG4gICAgICAgIGNvbnRlbnRUeXBlID0gaGVhZGVyc1tDT05URU5UX1RZUEVdIHx8IG51bGwsXG4gICAgICAgIHhtbEh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgaWYgKGNvbnRlbnRUeXBlID09PSBBUFBMSUNBVElPTl9KU09OKSB7XG4gICAgY29uc3QganNvbiA9IGJvZHksICAvLy9cbiAgICAgICAgICBqc29uU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoanNvbik7XG5cbiAgICBib2R5ID0ganNvblN0cmluZzsgIC8vL1xuICB9XG5cbiAgeG1sSHR0cFJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgcmVhZHlTdGF0ZSwgc3RhdHVzLCByZXNwb25zZVRleHQgfSA9IHhtbEh0dHBSZXF1ZXN0O1xuXG4gICAgaWYgKHJlYWR5U3RhdGUgPT0gNCkge1xuICAgICAgbGV0IGJvZHkgPSByZXNwb25zZVRleHQ7XG5cbiAgICAgIGlmIChhY2NlcHQgPT09IEFQUExJQ0FUSU9OX0pTT04pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBqc29uU3RyaW5nID0gYm9keSwgIC8vL1xuICAgICAgICAgICAgICAgIGpzb24gPSBKU09OLnBhcnNlKGpzb25TdHJpbmcpO1xuXG4gICAgICAgICAgYm9keSA9IGpzb247ICAvLy9cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBib2R5ID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNhbGxiYWNrKGJvZHksIHN0YXR1cyk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHhtbEh0dHBSZXF1ZXN0Lm9wZW4obWV0aG9kLCB1cmwpO1xuXG4gIGlmIChhY2NlcHQgIT09IG51bGwpIHtcbiAgICB4bWxIdHRwUmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKEFDQ0VQVCwgYWNjZXB0KTtcbiAgfVxuXG4gIGlmIChjb250ZW50VHlwZSAhPT0gbnVsbCkge1xuICAgIHhtbEh0dHBSZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoQ09OVEVOVF9UWVBFLCBjb250ZW50VHlwZSk7XG4gIH1cblxuICAoYm9keSAhPT0gbnVsbCkgP1xuICAgIHhtbEh0dHBSZXF1ZXN0LnNlbmQoYm9keSkgOlxuICAgICAgeG1sSHR0cFJlcXVlc3Quc2VuZCgpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIGdldCxcbiAgcG9zdCxcbiAgcmVxdWVzdFxufVxuXG5mdW5jdGlvbiBndWFyYW50ZWUoaGVhZGVycywgbmFtZSwgdmFsdWUpIHtcbiAgY29uc3QgcHJvcGVydHlOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGhlYWRlcnMpLFxuICAgICAgICBuYW1lcyA9IHByb3BlcnR5TmFtZXMubWFwKChwcm9wZXJ0eU5hbWUpID0+IHtcbiAgICAgICAgICBjb25zdCBsb3dlckNhc2VQcm9wZXJ0eU5hbWUgPSBwcm9wZXJ0eU5hbWUudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICAgICAgICBuYW1lID0gbG93ZXJDYXNlUHJvcGVydHlOYW1lOyAvLy9cblxuICAgICAgICAgIHJldHVybiBuYW1lO1xuICAgICAgICB9KSxcbiAgICAgICAgbmFtZXNJbmNsdWRlc05hbWUgPSBuYW1lcy5pbmNsdWRlcyhuYW1lKTtcblxuICBpZiAoIW5hbWVzSW5jbHVkZXNOYW1lKSB7XG4gICAgaGVhZGVyc1tuYW1lXSA9IHZhbHVlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGd1YXJhbnRlZUFjY2VwdChoZWFkZXJzKSB7XG4gIGNvbnN0IG5hbWUgPSBBQ0NFUFQsICAvLy9cbiAgICAgICAgdmFsdWUgPSBBUFBMSUNBVElPTl9KU09OOyAvLy9cblxuICBndWFyYW50ZWUoaGVhZGVycywgbmFtZSwgdmFsdWUpO1xufVxuXG5mdW5jdGlvbiBndWFyYW50ZWVDb250ZW50VHlwZShoZWFkZXJzKSB7XG4gIGNvbnN0IG5hbWUgPSBDT05URU5UX1RZUEUsICAvLy9cbiAgICAgICAgdmFsdWUgPSBBUFBMSUNBVElPTl9KU09OOyAvLy9cblxuICBndWFyYW50ZWUoaGVhZGVycywgbmFtZSwgdmFsdWUpO1xufVxuXG5mdW5jdGlvbiBxdWVyeVN0cmluZ0Zyb21QYXJhbWV0ZXJzKHBhcmFtZXRlcnMpIHtcbiAgY29uc3QgbmFtZXMgPSBPYmplY3Qua2V5cyhwYXJhbWV0ZXJzKSxcbiAgICAgICAgbmFtZXNMZW5ndGggPSBuYW1lcy5sZW5ndGgsXG4gICAgICAgIGxhc3RJbmRleCA9IG5hbWVzTGVuZ3RoIC0gMSxcbiAgICAgICAgcXVlcnlTdHJpbmcgPSBuYW1lcy5yZWR1Y2UoKHF1ZXJ5U3RyaW5nLCBuYW1lLCBpbmRleCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHZhbHVlID0gcGFyYW1ldGVyc1tuYW1lXSxcbiAgICAgICAgICAgICAgICBlbmNvZGVkTmFtZSA9IGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSxcbiAgICAgICAgICAgICAgICBlbmNvZGVkVmFsdWUgPSBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpLFxuICAgICAgICAgICAgICAgIGFtcGVyc2FuZE9yTm90aGluZyA9IChpbmRleCAhPT0gbGFzdEluZGV4KSA/IFwiJlwiIDogXCJcIjtcbiAgXG4gICAgICAgICAgcXVlcnlTdHJpbmcgKz0gYCR7ZW5jb2RlZE5hbWV9PSR7ZW5jb2RlZFZhbHVlfSR7YW1wZXJzYW5kT3JOb3RoaW5nfWA7XG4gIFxuICAgICAgICAgIHJldHVybiBxdWVyeVN0cmluZztcbiAgICAgICAgfSwgXCJcIik7XG5cbiAgcmV0dXJuIHF1ZXJ5U3RyaW5nO1xufVxuXG5mdW5jdGlvbiB1cmxGcm9tSG9zdFVSSUFuZFBhcmFtZXRlcnMoaG9zdCwgdXJpLCBwYXJhbWV0ZXJzKSB7XG4gIGNvbnN0IHF1ZXJ5U3RyaW5nID0gcXVlcnlTdHJpbmdGcm9tUGFyYW1ldGVycyhwYXJhbWV0ZXJzKSxcbiAgICAgICAgdXJsID0gKHF1ZXJ5U3RyaW5nID09PSBcIlwiKSA/XG4gICAgICAgICAgICAgIGAke2hvc3R9JHt1cml9YCA6XG4gICAgICAgICAgICAgICAgYCR7aG9zdH0ke3VyaX0/JHtxdWVyeVN0cmluZ31gO1xuXG4gIHJldHVybiB1cmw7XG59XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkNBQUEsVUFBWTs7OztRQVFJLEdBQUcsR0FBSCxHQUFHO1FBY0gsSUFBSSxHQUFKLElBQUk7UUFlSixPQUFPLEdBQVAsT0FBTzs7SUEvQlUsVUFBYztTQUUvQixHQUFHLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLFFBQVE7UUFDdEQsUUFBUSxLQUFLLFNBQVM7UUFDeEIsUUFBUSxHQUFHLE9BQU8sQ0FBRSxDQUFHLEFBQUgsRUFBRyxBQUFILENBQUc7UUFDdkIsT0FBTzs7O1FBR0gsTUFBTSxHQVJtQixVQUFjLE1BU3ZDLElBQUksR0FBRyxJQUFJO0lBRWpCLGVBQWUsQ0FBQyxPQUFPO0lBRXZCLE9BQU8sQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxRQUFROztTQUdoRCxJQUFJLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxRQUFRO1FBQzdELFFBQVEsS0FBSyxTQUFTO1FBQ3hCLFFBQVEsR0FBRyxPQUFPLENBQUUsQ0FBRyxBQUFILEVBQUcsQUFBSCxDQUFHO1FBQ3ZCLE9BQU87OztRQUdILE1BQU0sR0F0Qm1CLFVBQWM7SUF3QjdDLGVBQWUsQ0FBQyxPQUFPO0lBRXZCLG9CQUFvQixDQUFDLE9BQU87SUFFNUIsT0FBTyxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFF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