"use strict";

import { underwrite, queryStringFromParameters } from "../utilities/http";
import { GET, POST, ACCEPT, CONTENT_TYPE, APPLICATION_JSON } from "../constants";
export function get(host, uri, parameters, headers, callback) {
  if (callback === undefined) {
    callback = headers; ///

    headers = {};
  }

  const method = GET,
        body = null;
  underwriteAccept(headers);
  request(host, uri, parameters, method, body, headers, callback);
}
export function post(host, uri, parameters, body, headers, callback) {
  if (callback === undefined) {
    callback = headers; ///

    headers = {};
  }

  const method = POST;
  underwriteAccept(headers);
  underwriteContentType(headers);
  request(host, uri, parameters, method, body, headers, callback);
}
export function request(host, uri, parameters, method, body, headers, callback) {
  const url = urlFromHostURIAndParameters(host, uri, parameters),
        accept = headers[ACCEPT] || null,
        contentType = headers[CONTENT_TYPE] || null,
        xmlHttpRequest = new XMLHttpRequest();

  if (contentType === APPLICATION_JSON) {
    const json = body,
          ///
    jsonString = JSON.stringify(json);
    body = jsonString; ///
  }

  xmlHttpRequest.onreadystatechange = () => {
    const {
      readyState,
      status,
      responseText
    } = xmlHttpRequest;

    if (readyState == 4) {
      let body = responseText;

      if (accept === APPLICATION_JSON) {
        try {
          const jsonString = body,
                ///
          json = JSON.parse(jsonString);
          body = json; ///
        } catch (error) {
          body = null;
        }

        callback(body, status);
      }
    }
  };

  xmlHttpRequest.open(method, url);

  if (accept !== null) {
    xmlHttpRequest.setRequestHeader(ACCEPT, accept);
  }

  if (contentType !== null) {
    xmlHttpRequest.setRequestHeader(CONTENT_TYPE, contentType);
  }

  body !== null ? xmlHttpRequest.send(body) : xmlHttpRequest.send();
}
export default {
  get,
  post,
  request
};

function underwriteAccept(headers) {
  const name = ACCEPT,
        ///
  value = APPLICATION_JSON; ///

  underwrite(headers, name, value);
}

function underwriteContentType(headers) {
  const name = CONTENT_TYPE,
        ///
  value = APPLICATION_JSON; ///

  underwrite(headers, name, value);
}

function urlFromHostURIAndParameters(host, uri, parameters) {
  const queryString = queryStringFromParameters(parameters),
        url = queryString === "" ? `${host}${uri}` : `${host}${uri}?${queryString}`;
  return url;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFqYXguanMiXSwibmFtZXMiOlsidW5kZXJ3cml0ZSIsInF1ZXJ5U3RyaW5nRnJvbVBhcmFtZXRlcnMiLCJHRVQiLCJQT1NUIiwiQUNDRVBUIiwiQ09OVEVOVF9UWVBFIiwiQVBQTElDQVRJT05fSlNPTiIsImdldCIsImhvc3QiLCJ1cmkiLCJwYXJhbWV0ZXJzIiwiaGVhZGVycyIsImNhbGxiYWNrIiwidW5kZWZpbmVkIiwibWV0aG9kIiwiYm9keSIsInVuZGVyd3JpdGVBY2NlcHQiLCJyZXF1ZXN0IiwicG9zdCIsInVuZGVyd3JpdGVDb250ZW50VHlwZSIsInVybCIsInVybEZyb21Ib3N0VVJJQW5kUGFyYW1ldGVycyIsImFjY2VwdCIsImNvbnRlbnRUeXBlIiwieG1sSHR0cFJlcXVlc3QiLCJYTUxIdHRwUmVxdWVzdCIsImpzb24iLCJqc29uU3RyaW5nIiwiSlNPTiIsInN0cmluZ2lmeSIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJyZXNwb25zZVRleHQiLCJwYXJzZSIsImVycm9yIiwib3BlbiIsInNldFJlcXVlc3RIZWFkZXIiLCJzZW5kIiwibmFtZSIsInZhbHVlIiwicXVlcnlTdHJpbmciXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLFNBQVNBLFVBQVQsRUFBcUJDLHlCQUFyQixRQUFzRCxtQkFBdEQ7QUFDQSxTQUFTQyxHQUFULEVBQWNDLElBQWQsRUFBb0JDLE1BQXBCLEVBQTRCQyxZQUE1QixFQUEwQ0MsZ0JBQTFDLFFBQWtFLGNBQWxFO0FBRUEsT0FBTyxTQUFTQyxHQUFULENBQWFDLElBQWIsRUFBbUJDLEdBQW5CLEVBQXdCQyxVQUF4QixFQUFvQ0MsT0FBcEMsRUFBNkNDLFFBQTdDLEVBQXVEO0FBQzVELE1BQUlBLFFBQVEsS0FBS0MsU0FBakIsRUFBNEI7QUFDMUJELElBQUFBLFFBQVEsR0FBR0QsT0FBWCxDQUQwQixDQUNOOztBQUNwQkEsSUFBQUEsT0FBTyxHQUFHLEVBQVY7QUFDRDs7QUFFRCxRQUFNRyxNQUFNLEdBQUdaLEdBQWY7QUFBQSxRQUNNYSxJQUFJLEdBQUcsSUFEYjtBQUdBQyxFQUFBQSxnQkFBZ0IsQ0FBQ0wsT0FBRCxDQUFoQjtBQUVBTSxFQUFBQSxPQUFPLENBQUNULElBQUQsRUFBT0MsR0FBUCxFQUFZQyxVQUFaLEVBQXdCSSxNQUF4QixFQUFnQ0MsSUFBaEMsRUFBc0NKLE9BQXRDLEVBQStDQyxRQUEvQyxDQUFQO0FBQ0Q7QUFFRCxPQUFPLFNBQVNNLElBQVQsQ0FBY1YsSUFBZCxFQUFvQkMsR0FBcEIsRUFBeUJDLFVBQXpCLEVBQXFDSyxJQUFyQyxFQUEyQ0osT0FBM0MsRUFBb0RDLFFBQXBELEVBQThEO0FBQ25FLE1BQUlBLFFBQVEsS0FBS0MsU0FBakIsRUFBNEI7QUFDMUJELElBQUFBLFFBQVEsR0FBR0QsT0FBWCxDQUQwQixDQUNOOztBQUNwQkEsSUFBQUEsT0FBTyxHQUFHLEVBQVY7QUFDRDs7QUFFRCxRQUFNRyxNQUFNLEdBQUdYLElBQWY7QUFFQWEsRUFBQUEsZ0JBQWdCLENBQUNMLE9BQUQsQ0FBaEI7QUFFQVEsRUFBQUEscUJBQXFCLENBQUNSLE9BQUQsQ0FBckI7QUFFQU0sRUFBQUEsT0FBTyxDQUFDVCxJQUFELEVBQU9DLEdBQVAsRUFBWUMsVUFBWixFQUF3QkksTUFBeEIsRUFBZ0NDLElBQWhDLEVBQXNDSixPQUF0QyxFQUErQ0MsUUFBL0MsQ0FBUDtBQUNEO0FBRUQsT0FBTyxTQUFTSyxPQUFULENBQWlCVCxJQUFqQixFQUF1QkMsR0FBdkIsRUFBNEJDLFVBQTVCLEVBQXdDSSxNQUF4QyxFQUFnREMsSUFBaEQsRUFBc0RKLE9BQXRELEVBQStEQyxRQUEvRCxFQUF5RTtBQUM5RSxRQUFNUSxHQUFHLEdBQUdDLDJCQUEyQixDQUFDYixJQUFELEVBQU9DLEdBQVAsRUFBWUMsVUFBWixDQUF2QztBQUFBLFFBQ01ZLE1BQU0sR0FBR1gsT0FBTyxDQUFDUCxNQUFELENBQVAsSUFBbUIsSUFEbEM7QUFBQSxRQUVNbUIsV0FBVyxHQUFHWixPQUFPLENBQUNOLFlBQUQsQ0FBUCxJQUF5QixJQUY3QztBQUFBLFFBR01tQixjQUFjLEdBQUcsSUFBSUMsY0FBSixFQUh2Qjs7QUFLQSxNQUFJRixXQUFXLEtBQUtqQixnQkFBcEIsRUFBc0M7QUFDcEMsVUFBTW9CLElBQUksR0FBR1gsSUFBYjtBQUFBLFVBQW9CO0FBQ2RZLElBQUFBLFVBQVUsR0FBR0MsSUFBSSxDQUFDQyxTQUFMLENBQWVILElBQWYsQ0FEbkI7QUFHQVgsSUFBQUEsSUFBSSxHQUFHWSxVQUFQLENBSm9DLENBSWhCO0FBQ3JCOztBQUVESCxFQUFBQSxjQUFjLENBQUNNLGtCQUFmLEdBQW9DLE1BQU07QUFDeEMsVUFBTTtBQUFFQyxNQUFBQSxVQUFGO0FBQWNDLE1BQUFBLE1BQWQ7QUFBc0JDLE1BQUFBO0FBQXRCLFFBQXVDVCxjQUE3Qzs7QUFFQSxRQUFJTyxVQUFVLElBQUksQ0FBbEIsRUFBcUI7QUFDbkIsVUFBSWhCLElBQUksR0FBR2tCLFlBQVg7O0FBRUEsVUFBSVgsTUFBTSxLQUFLaEIsZ0JBQWYsRUFBaUM7QUFDL0IsWUFBSTtBQUNGLGdCQUFNcUIsVUFBVSxHQUFHWixJQUFuQjtBQUFBLGdCQUEwQjtBQUNwQlcsVUFBQUEsSUFBSSxHQUFHRSxJQUFJLENBQUNNLEtBQUwsQ0FBV1AsVUFBWCxDQURiO0FBR0FaLFVBQUFBLElBQUksR0FBR1csSUFBUCxDQUpFLENBSVk7QUFDZixTQUxELENBS0UsT0FBT1MsS0FBUCxFQUFjO0FBQ2RwQixVQUFBQSxJQUFJLEdBQUcsSUFBUDtBQUNEOztBQUVESCxRQUFBQSxRQUFRLENBQUNHLElBQUQsRUFBT2lCLE1BQVAsQ0FBUjtBQUNEO0FBQ0Y7QUFDRixHQW5CRDs7QUFxQkFSLEVBQUFBLGNBQWMsQ0FBQ1ksSUFBZixDQUFvQnRCLE1BQXBCLEVBQTRCTSxHQUE1Qjs7QUFFQSxNQUFJRSxNQUFNLEtBQUssSUFBZixFQUFxQjtBQUNuQkUsSUFBQUEsY0FBYyxDQUFDYSxnQkFBZixDQUFnQ2pDLE1BQWhDLEVBQXdDa0IsTUFBeEM7QUFDRDs7QUFFRCxNQUFJQyxXQUFXLEtBQUssSUFBcEIsRUFBMEI7QUFDeEJDLElBQUFBLGNBQWMsQ0FBQ2EsZ0JBQWYsQ0FBZ0NoQyxZQUFoQyxFQUE4Q2tCLFdBQTlDO0FBQ0Q7O0FBRUFSLEVBQUFBLElBQUksS0FBSyxJQUFWLEdBQ0VTLGNBQWMsQ0FBQ2MsSUFBZixDQUFvQnZCLElBQXBCLENBREYsR0FFSVMsY0FBYyxDQUFDYyxJQUFmLEVBRko7QUFHRDtBQUVELGVBQWU7QUFDYi9CLEVBQUFBLEdBRGE7QUFFYlcsRUFBQUEsSUFGYTtBQUdiRCxFQUFBQTtBQUhhLENBQWY7O0FBTUEsU0FBU0QsZ0JBQVQsQ0FBMEJMLE9BQTFCLEVBQW1DO0FBQ2pDLFFBQU00QixJQUFJLEdBQUduQyxNQUFiO0FBQUEsUUFBc0I7QUFDaEJvQyxFQUFBQSxLQUFLLEdBQUdsQyxnQkFEZCxDQURpQyxDQUVEOztBQUVoQ04sRUFBQUEsVUFBVSxDQUFDVyxPQUFELEVBQVU0QixJQUFWLEVBQWdCQyxLQUFoQixDQUFWO0FBQ0Q7O0FBRUQsU0FBU3JCLHFCQUFULENBQStCUixPQUEvQixFQUF3QztBQUN0QyxRQUFNNEIsSUFBSSxHQUFHbEMsWUFBYjtBQUFBLFFBQTRCO0FBQ3RCbUMsRUFBQUEsS0FBSyxHQUFHbEMsZ0JBRGQsQ0FEc0MsQ0FFTjs7QUFFaENOLEVBQUFBLFVBQVUsQ0FBQ1csT0FBRCxFQUFVNEIsSUFBVixFQUFnQkMsS0FBaEIsQ0FBVjtBQUNEOztBQUVELFNBQVNuQiwyQkFBVCxDQUFxQ2IsSUFBckMsRUFBMkNDLEdBQTNDLEVBQWdEQyxVQUFoRCxFQUE0RDtBQUMxRCxRQUFNK0IsV0FBVyxHQUFHeEMseUJBQXlCLENBQUNTLFVBQUQsQ0FBN0M7QUFBQSxRQUNNVSxHQUFHLEdBQUlxQixXQUFXLEtBQUssRUFBakIsR0FDQyxHQUFFakMsSUFBSyxHQUFFQyxHQUFJLEVBRGQsR0FFRyxHQUFFRCxJQUFLLEdBQUVDLEdBQUksSUFBR2dDLFdBQVksRUFIM0M7QUFLQSxTQUFPckIsR0FBUDtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCB7IHVuZGVyd3JpdGUsIHF1ZXJ5U3RyaW5nRnJvbVBhcmFtZXRlcnMgfSBmcm9tIFwiLi4vdXRpbGl0aWVzL2h0dHBcIjtcbmltcG9ydCB7IEdFVCwgUE9TVCwgQUNDRVBULCBDT05URU5UX1RZUEUsIEFQUExJQ0FUSU9OX0pTT04gfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXQoaG9zdCwgdXJpLCBwYXJhbWV0ZXJzLCBoZWFkZXJzLCBjYWxsYmFjaykge1xuICBpZiAoY2FsbGJhY2sgPT09IHVuZGVmaW5lZCkge1xuICAgIGNhbGxiYWNrID0gaGVhZGVyczsgLy8vXG4gICAgaGVhZGVycyA9IHt9O1xuICB9XG5cbiAgY29uc3QgbWV0aG9kID0gR0VULFxuICAgICAgICBib2R5ID0gbnVsbDtcblxuICB1bmRlcndyaXRlQWNjZXB0KGhlYWRlcnMpO1xuXG4gIHJlcXVlc3QoaG9zdCwgdXJpLCBwYXJhbWV0ZXJzLCBtZXRob2QsIGJvZHksIGhlYWRlcnMsIGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBvc3QoaG9zdCwgdXJpLCBwYXJhbWV0ZXJzLCBib2R5LCBoZWFkZXJzLCBjYWxsYmFjaykge1xuICBpZiAoY2FsbGJhY2sgPT09IHVuZGVmaW5lZCkge1xuICAgIGNhbGxiYWNrID0gaGVhZGVyczsgLy8vXG4gICAgaGVhZGVycyA9IHt9O1xuICB9XG5cbiAgY29uc3QgbWV0aG9kID0gUE9TVDtcblxuICB1bmRlcndyaXRlQWNjZXB0KGhlYWRlcnMpO1xuXG4gIHVuZGVyd3JpdGVDb250ZW50VHlwZShoZWFkZXJzKTtcblxuICByZXF1ZXN0KGhvc3QsIHVyaSwgcGFyYW1ldGVycywgbWV0aG9kLCBib2R5LCBoZWFkZXJzLCBjYWxsYmFjayk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXF1ZXN0KGhvc3QsIHVyaSwgcGFyYW1ldGVycywgbWV0aG9kLCBib2R5LCBoZWFkZXJzLCBjYWxsYmFjaykge1xuICBjb25zdCB1cmwgPSB1cmxGcm9tSG9zdFVSSUFuZFBhcmFtZXRlcnMoaG9zdCwgdXJpLCBwYXJhbWV0ZXJzKSxcbiAgICAgICAgYWNjZXB0ID0gaGVhZGVyc1tBQ0NFUFRdIHx8IG51bGwsXG4gICAgICAgIGNvbnRlbnRUeXBlID0gaGVhZGVyc1tDT05URU5UX1RZUEVdIHx8IG51bGwsXG4gICAgICAgIHhtbEh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgaWYgKGNvbnRlbnRUeXBlID09PSBBUFBMSUNBVElPTl9KU09OKSB7XG4gICAgY29uc3QganNvbiA9IGJvZHksICAvLy9cbiAgICAgICAgICBqc29uU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoanNvbik7XG5cbiAgICBib2R5ID0ganNvblN0cmluZzsgIC8vL1xuICB9XG5cbiAgeG1sSHR0cFJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgcmVhZHlTdGF0ZSwgc3RhdHVzLCByZXNwb25zZVRleHQgfSA9IHhtbEh0dHBSZXF1ZXN0O1xuXG4gICAgaWYgKHJlYWR5U3RhdGUgPT0gNCkge1xuICAgICAgbGV0IGJvZHkgPSByZXNwb25zZVRleHQ7XG5cbiAgICAgIGlmIChhY2NlcHQgPT09IEFQUExJQ0FUSU9OX0pTT04pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBqc29uU3RyaW5nID0gYm9keSwgIC8vL1xuICAgICAgICAgICAgICAgIGpzb24gPSBKU09OLnBhcnNlKGpzb25TdHJpbmcpO1xuXG4gICAgICAgICAgYm9keSA9IGpzb247ICAvLy9cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBib2R5ID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNhbGxiYWNrKGJvZHksIHN0YXR1cyk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHhtbEh0dHBSZXF1ZXN0Lm9wZW4obWV0aG9kLCB1cmwpO1xuXG4gIGlmIChhY2NlcHQgIT09IG51bGwpIHtcbiAgICB4bWxIdHRwUmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKEFDQ0VQVCwgYWNjZXB0KTtcbiAgfVxuXG4gIGlmIChjb250ZW50VHlwZSAhPT0gbnVsbCkge1xuICAgIHhtbEh0dHBSZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoQ09OVEVOVF9UWVBFLCBjb250ZW50VHlwZSk7XG4gIH1cblxuICAoYm9keSAhPT0gbnVsbCkgP1xuICAgIHhtbEh0dHBSZXF1ZXN0LnNlbmQoYm9keSkgOlxuICAgICAgeG1sSHR0cFJlcXVlc3Quc2VuZCgpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIGdldCxcbiAgcG9zdCxcbiAgcmVxdWVzdFxufVxuXG5mdW5jdGlvbiB1bmRlcndyaXRlQWNjZXB0KGhlYWRlcnMpIHtcbiAgY29uc3QgbmFtZSA9IEFDQ0VQVCwgIC8vL1xuICAgICAgICB2YWx1ZSA9IEFQUExJQ0FUSU9OX0pTT047IC8vL1xuXG4gIHVuZGVyd3JpdGUoaGVhZGVycywgbmFtZSwgdmFsdWUpO1xufVxuXG5mdW5jdGlvbiB1bmRlcndyaXRlQ29udGVudFR5cGUoaGVhZGVycykge1xuICBjb25zdCBuYW1lID0gQ09OVEVOVF9UWVBFLCAgLy8vXG4gICAgICAgIHZhbHVlID0gQVBQTElDQVRJT05fSlNPTjsgLy8vXG5cbiAgdW5kZXJ3cml0ZShoZWFkZXJzLCBuYW1lLCB2YWx1ZSk7XG59XG5cbmZ1bmN0aW9uIHVybEZyb21Ib3N0VVJJQW5kUGFyYW1ldGVycyhob3N0LCB1cmksIHBhcmFtZXRlcnMpIHtcbiAgY29uc3QgcXVlcnlTdHJpbmcgPSBxdWVyeVN0cmluZ0Zyb21QYXJhbWV0ZXJzKHBhcmFtZXRlcnMpLFxuICAgICAgICB1cmwgPSAocXVlcnlTdHJpbmcgPT09IFwiXCIpID9cbiAgICAgICAgICAgICAgYCR7aG9zdH0ke3VyaX1gIDpcbiAgICAgICAgICAgICAgICBgJHtob3N0fSR7dXJpfT8ke3F1ZXJ5U3RyaW5nfWA7XG5cbiAgcmV0dXJuIHVybDtcbn1cbiJdfQ==