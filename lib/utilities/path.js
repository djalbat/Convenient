'use strict';

var arrayUtilities = require('../utilities/array');

var first = arrayUtilities.first,
    second = arrayUtilities.second,
    last = arrayUtilities.last;


function isPathName(path) {
  path = path.replace(/^\//, '').replace(/\/$/, ''); ///

  var pathName = /\//.test(path) === true;

  return pathName;
}

function isPathTopmostName(path) {
  var pathName = isPathName(path),
      pathAbsolutePath = isPathAbsolutePath(path),
      pathTopmostName = pathName && pathAbsolutePath;

  return pathTopmostName;
}

function isPathRelativePath(path) {
  var pathRelativePath = !/^\//.test(path);

  return pathRelativePath;
}

function isPathAbsolutePath(path) {
  var pathAbsolutePath = /^\//.test(path);

  return pathAbsolutePath;
}

function isTopmostNameInAbsolutePath(topmostName, absolutePath) {
  var regExp = new RegExp('^' + topmostName + '(?:\\/.+)?$'),
      topmostNameInAbsolutePath = regExp.test(absolutePath);

  return topmostNameInAbsolutePath;
}

function combinePaths(path, relativePath) {
  var combinedPath = null;

  var pathNames = path.split('/'),
      relativePathNames = relativePath.split('/');

  var lastPath1Name = void 0,
      firstPath2Name = first(relativePathNames);

  if (firstPath2Name === '.') {
    relativePathNames.shift();
  }

  firstPath2Name = first(relativePathNames);
  lastPath1Name = last(pathNames);

  while (firstPath2Name === '..' && lastPath1Name !== undefined) {
    relativePathNames.shift();
    pathNames.pop();

    firstPath2Name = first(relativePathNames);
    lastPath1Name = last(pathNames);
  }

  if (lastPath1Name !== undefined) {
    var _pathNames = [].concat(_pathNames).concat(relativePathNames);

    combinedPath = _pathNames.join('/');
  }

  return combinedPath;
}

function concatenatePaths(path, relativePath) {
  path = path.replace(/\/$/, ''); ///

  var concatenatedPath = path + '/' + relativePath;

  return concatenatedPath;
}

function bottommostNameFromPath(path) {
  var bottommostName = null;

  var matches = path.match(/^.*\/([^\/]+\/?)$/);

  if (matches !== null) {
    var secondMatch = second(matches);

    bottommostName = secondMatch; ///
  }

  return bottommostName;
}

function topmostDirectoryPathFromPath(path) {
  var matches = path.match(/^(.+)\/[^\/]+\/?$/),
      secondMatch = second(matches),
      topmostDirectoryPath = secondMatch; ///

  return topmostDirectoryPath;
}

function topmostDirectoryNameFromPath(path) {
  var topmostDirectoryName = null;

  var matches = path.match(/^([^\/]+)\/.+$/);

  if (matches !== null) {
    var secondMatch = second(matches);

    topmostDirectoryName = secondMatch; ///
  }

  return topmostDirectoryName;
}

function pathWithoutBottommostNameFromPath(path) {
  var pathWithoutBottommostName = null;

  var matches = path.match(/^(.*)\/[^\/]+\/?$/);

  if (matches !== null) {
    var secondMatch = second(matches);

    pathWithoutBottommostName = secondMatch; ///
  }

  return pathWithoutBottommostName;
}

function pathWithoutTopmostDirectoryNameFromPath(path) {
  var pathWithoutTopmostDirectoryName = null;

  var matches = path.match(/^[^\/]+\/(.+)$/);

  if (matches !== null) {
    var secondMatch = second(matches);

    pathWithoutTopmostDirectoryName = secondMatch;
  }

  return pathWithoutTopmostDirectoryName;
}

module.exports = {
  isPathName: isPathName,
  isPathTopmostName: isPathTopmostName,
  isPathRelativePath: isPathRelativePath,
  isPathAbsolutePath: isPathAbsolutePath,
  isTopmostNameInAbsolutePath: isTopmostNameInAbsolutePath,
  combinePaths: combinePaths,
  concatenatePaths: concatenatePaths,
  bottommostNameFromPath: bottommostNameFromPath,
  topmostDirectoryPathFromPath: topmostDirectoryPathFromPath,
  topmostDirectoryNameFromPath: topmostDirectoryNameFromPath,
  pathWithoutBottommostNameFromPath: pathWithoutBottommostNameFromPath,
  pathWithoutTopmostDirectoryNameFromPath: pathWithoutTopmostDirectoryNameFromPath
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsaXRpZXMvcGF0aC5qcyJdLCJuYW1lcyI6WyJhcnJheVV0aWxpdGllcyIsInJlcXVpcmUiLCJmaXJzdCIsInNlY29uZCIsImxhc3QiLCJpc1BhdGhOYW1lIiwicGF0aCIsInJlcGxhY2UiLCJwYXRoTmFtZSIsInRlc3QiLCJpc1BhdGhUb3Btb3N0TmFtZSIsInBhdGhBYnNvbHV0ZVBhdGgiLCJpc1BhdGhBYnNvbHV0ZVBhdGgiLCJwYXRoVG9wbW9zdE5hbWUiLCJpc1BhdGhSZWxhdGl2ZVBhdGgiLCJwYXRoUmVsYXRpdmVQYXRoIiwiaXNUb3Btb3N0TmFtZUluQWJzb2x1dGVQYXRoIiwidG9wbW9zdE5hbWUiLCJhYnNvbHV0ZVBhdGgiLCJyZWdFeHAiLCJSZWdFeHAiLCJ0b3Btb3N0TmFtZUluQWJzb2x1dGVQYXRoIiwiY29tYmluZVBhdGhzIiwicmVsYXRpdmVQYXRoIiwiY29tYmluZWRQYXRoIiwicGF0aE5hbWVzIiwic3BsaXQiLCJyZWxhdGl2ZVBhdGhOYW1lcyIsImxhc3RQYXRoMU5hbWUiLCJmaXJzdFBhdGgyTmFtZSIsInNoaWZ0IiwidW5kZWZpbmVkIiwicG9wIiwiY29uY2F0Iiwiam9pbiIsImNvbmNhdGVuYXRlUGF0aHMiLCJjb25jYXRlbmF0ZWRQYXRoIiwiYm90dG9tbW9zdE5hbWVGcm9tUGF0aCIsImJvdHRvbW1vc3ROYW1lIiwibWF0Y2hlcyIsIm1hdGNoIiwic2Vjb25kTWF0Y2giLCJ0b3Btb3N0RGlyZWN0b3J5UGF0aEZyb21QYXRoIiwidG9wbW9zdERpcmVjdG9yeVBhdGgiLCJ0b3Btb3N0RGlyZWN0b3J5TmFtZUZyb21QYXRoIiwidG9wbW9zdERpcmVjdG9yeU5hbWUiLCJwYXRoV2l0aG91dEJvdHRvbW1vc3ROYW1lRnJvbVBhdGgiLCJwYXRoV2l0aG91dEJvdHRvbW1vc3ROYW1lIiwicGF0aFdpdGhvdXRUb3Btb3N0RGlyZWN0b3J5TmFtZUZyb21QYXRoIiwicGF0aFdpdGhvdXRUb3Btb3N0RGlyZWN0b3J5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QVQsQ0FBaUQxQyxJQUFqRCxFQUF1RDtBQUNyRCxNQUFJMkMsa0NBQWtDLElBQXRDOztBQUVBLE1BQU1WLFVBQVVqQyxLQUFLa0MsS0FBTCxDQUFXLGdCQUFYLENBQWhCOztBQUVBLE1BQUlELFlBQVksSUFBaEIsRUFBc0I7QUFDcEIsUUFBTUUsY0FBY3RDLE9BQU9vQyxPQUFQLENBQXBCOztBQUVBVSxzQ0FBa0NSLFdBQWxDO0FBQ0Q7O0FBRUQsU0FBT1EsK0JBQVA7QUFDRDs7QUFFREMsT0FBT0MsT0FBUCxHQUFpQjtBQUNmOUMsd0JBRGU7QUFFZkssc0NBRmU7QUFHZkksd0NBSGU7QUFJZkYsd0NBSmU7QUFLZkksMERBTGU7QUFNZk0sNEJBTmU7QUFPZmEsb0NBUGU7QUFRZkUsZ0RBUmU7QUFTZkssNERBVGU7QUFVZkUsNERBVmU7QUFXZkUsc0VBWGU7QUFZZkU7QUFaZSxDQUFqQiIsImZpbGUiOiJwYXRoLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBhcnJheVV0aWxpdGllcyA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9hcnJheScpO1xuXG5jb25zdCB7IGZpcnN0LCBzZWNvbmQsIGxhc3QgfSA9IGFycmF5VXRpbGl0aWVzO1xuXG5mdW5jdGlvbiBpc1BhdGhOYW1lKHBhdGgpIHtcbiAgcGF0aCA9IHBhdGgucmVwbGFjZSgvXlxcLy8sJycpLnJlcGxhY2UoL1xcLyQvLCAnJyk7IC8vL1xuXG4gIGNvbnN0IHBhdGhOYW1lID0gKC9cXC8vLnRlc3QocGF0aCkgPT09IHRydWUpO1xuXG4gIHJldHVybiBwYXRoTmFtZTtcbn1cblxuZnVuY3Rpb24gaXNQYXRoVG9wbW9zdE5hbWUocGF0aCkge1xuICBjb25zdCBwYXRoTmFtZSA9IGlzUGF0aE5hbWUocGF0aCksXG4gICAgICAgIHBhdGhBYnNvbHV0ZVBhdGggPSBpc1BhdGhBYnNvbHV0ZVBhdGgocGF0aCksXG4gICAgICAgIHBhdGhUb3Btb3N0TmFtZSA9IChwYXRoTmFtZSAmJiBwYXRoQWJzb2x1dGVQYXRoKTtcblxuICByZXR1cm4gcGF0aFRvcG1vc3ROYW1lO1xufVxuXG5mdW5jdGlvbiBpc1BhdGhSZWxhdGl2ZVBhdGgocGF0aCkge1xuICBjb25zdCBwYXRoUmVsYXRpdmVQYXRoID0gIS9eXFwvLy50ZXN0KHBhdGgpO1xuXG4gIHJldHVybiBwYXRoUmVsYXRpdmVQYXRoO1xufVxuXG5mdW5jdGlvbiBpc1BhdGhBYnNvbHV0ZVBhdGgocGF0aCkge1xuICBjb25zdCBwYXRoQWJzb2x1dGVQYXRoID0gL15cXC8vLnRlc3QocGF0aCk7XG5cbiAgcmV0dXJuIHBhdGhBYnNvbHV0ZVBhdGg7XG59XG5cbmZ1bmN0aW9uIGlzVG9wbW9zdE5hbWVJbkFic29sdXRlUGF0aCh0b3Btb3N0TmFtZSwgYWJzb2x1dGVQYXRoKSB7XG4gIGNvbnN0IHJlZ0V4cCA9IG5ldyBSZWdFeHAoYF4ke3RvcG1vc3ROYW1lfSg/OlxcXFwvLispPyRgKSxcbiAgICAgICAgdG9wbW9zdE5hbWVJbkFic29sdXRlUGF0aCA9IHJlZ0V4cC50ZXN0KGFic29sdXRlUGF0aCk7XG5cbiAgcmV0dXJuIHRvcG1vc3ROYW1lSW5BYnNvbHV0ZVBhdGhcbn1cblxuZnVuY3Rpb24gY29tYmluZVBhdGhzKHBhdGgsIHJlbGF0aXZlUGF0aCkge1xuICBsZXQgY29tYmluZWRQYXRoID0gbnVsbDtcblxuICBjb25zdCBwYXRoTmFtZXMgPSBwYXRoLnNwbGl0KCcvJyksXG4gICAgICAgIHJlbGF0aXZlUGF0aE5hbWVzID0gcmVsYXRpdmVQYXRoLnNwbGl0KCcvJyk7XG5cbiAgbGV0IGxhc3RQYXRoMU5hbWUsXG4gICAgICBmaXJzdFBhdGgyTmFtZSA9IGZpcnN0KHJlbGF0aXZlUGF0aE5hbWVzKTtcblxuICBpZiAoZmlyc3RQYXRoMk5hbWUgPT09ICcuJykge1xuICAgIHJlbGF0aXZlUGF0aE5hbWVzLnNoaWZ0KCk7XG4gIH1cblxuICBmaXJzdFBhdGgyTmFtZSA9IGZpcnN0KHJlbGF0aXZlUGF0aE5hbWVzKTtcbiAgbGFzdFBhdGgxTmFtZSA9IGxhc3QocGF0aE5hbWVzKTtcblxuICB3aGlsZSAoKGZpcnN0UGF0aDJOYW1lID09PSAnLi4nKSAmJiAobGFzdFBhdGgxTmFtZSAhPT0gdW5kZWZpbmVkKSkge1xuICAgIHJlbGF0aXZlUGF0aE5hbWVzLnNoaWZ0KCk7XG4gICAgcGF0aE5hbWVzLnBvcCgpO1xuXG4gICAgZmlyc3RQYXRoMk5hbWUgPSBmaXJzdChyZWxhdGl2ZVBhdGhOYW1lcyk7XG4gICAgbGFzdFBhdGgxTmFtZSA9IGxhc3QocGF0aE5hbWVzKTtcbiAgfVxuXG4gIGlmIChsYXN0UGF0aDFOYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICBjb25zdCBwYXRoTmFtZXMgPSBbXS5jb25jYXQocGF0aE5hbWVzKS5jb25jYXQocmVsYXRpdmVQYXRoTmFtZXMpO1xuXG4gICAgY29tYmluZWRQYXRoID0gcGF0aE5hbWVzLmpvaW4oJy8nKTtcbiAgfVxuXG4gIHJldHVybiBjb21iaW5lZFBhdGg7XG59XG5cbmZ1bmN0aW9uIGNvbmNhdGVuYXRlUGF0aHMocGF0aCwgcmVsYXRpdmVQYXRoKSB7XG4gIHBhdGggPSBwYXRoLnJlcGxhY2UoL1xcLyQvLCAnJyk7ICAvLy9cblxuICBjb25zdCBjb25jYXRlbmF0ZWRQYXRoID0gYCR7cGF0aH0vJHtyZWxhdGl2ZVBhdGh9YDtcblxuICByZXR1cm4gY29uY2F0ZW5hdGVkUGF0aDtcbn1cblxuZnVuY3Rpb24gYm90dG9tbW9zdE5hbWVGcm9tUGF0aChwYXRoKSB7XG4gIGxldCBib3R0b21tb3N0TmFtZSA9IG51bGw7XG5cbiAgY29uc3QgbWF0Y2hlcyA9IHBhdGgubWF0Y2goL14uKlxcLyhbXlxcL10rXFwvPykkLyk7XG5cbiAgaWYgKG1hdGNoZXMgIT09IG51bGwpIHtcbiAgICBjb25zdCBzZWNvbmRNYXRjaCA9IHNlY29uZChtYXRjaGVzKTtcblxuICAgIGJvdHRvbW1vc3ROYW1lID0gc2Vjb25kTWF0Y2g7ICAvLy9cbiAgfVxuXG4gIHJldHVybiBib3R0b21tb3N0TmFtZTtcbn1cblxuZnVuY3Rpb24gdG9wbW9zdERpcmVjdG9yeVBhdGhGcm9tUGF0aChwYXRoKSB7XG4gIGNvbnN0IG1hdGNoZXMgPSBwYXRoLm1hdGNoKC9eKC4rKVxcL1teXFwvXStcXC8/JC8pLFxuICAgICAgICBzZWNvbmRNYXRjaCA9IHNlY29uZChtYXRjaGVzKSxcbiAgICAgICAgdG9wbW9zdERpcmVjdG9yeVBhdGggPSBzZWNvbmRNYXRjaDsgLy8vXG5cbiAgcmV0dXJuIHRvcG1vc3REaXJlY3RvcnlQYXRoO1xufVxuXG5mdW5jdGlvbiB0b3Btb3N0RGlyZWN0b3J5TmFtZUZyb21QYXRoKHBhdGgpIHtcbiAgbGV0IHRvcG1vc3REaXJlY3RvcnlOYW1lID0gbnVsbDtcblxuICBjb25zdCBtYXRjaGVzID0gcGF0aC5tYXRjaCgvXihbXlxcL10rKVxcLy4rJC8pO1xuXG4gIGlmIChtYXRjaGVzICE9PSBudWxsKSB7XG4gICAgY29uc3Qgc2Vjb25kTWF0Y2ggPSBzZWNvbmQobWF0Y2hlcyk7XG5cbiAgICB0b3Btb3N0RGlyZWN0b3J5TmFtZSA9IHNlY29uZE1hdGNoOyAgLy8vXG4gIH1cblxuICByZXR1cm4gdG9wbW9zdERpcmVjdG9yeU5hbWU7XG59XG5cbmZ1bmN0aW9uIHBhdGhXaXRob3V0Qm90dG9tbW9zdE5hbWVGcm9tUGF0aChwYXRoKSB7XG4gIGxldCBwYXRoV2l0aG91dEJvdHRvbW1vc3ROYW1lID0gbnVsbDtcblxuICBjb25zdCBtYXRjaGVzID0gcGF0aC5tYXRjaCgvXiguKilcXC9bXlxcL10rXFwvPyQvKTtcblxuICBpZiAobWF0Y2hlcyAhPT0gbnVsbCkge1xuICAgIGNvbnN0IHNlY29uZE1hdGNoID0gc2Vjb25kKG1hdGNoZXMpO1xuXG4gICAgcGF0aFdpdGhvdXRCb3R0b21tb3N0TmFtZSA9IHNlY29uZE1hdGNoOyAvLy9cbiAgfVxuXG4gIHJldHVybiBwYXRoV2l0aG91dEJvdHRvbW1vc3ROYW1lO1xufVxuXG5mdW5jdGlvbiBwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lRnJvbVBhdGgocGF0aCkge1xuICBsZXQgcGF0aFdpdGhvdXRUb3Btb3N0RGlyZWN0b3J5TmFtZSA9IG51bGw7XG5cbiAgY29uc3QgbWF0Y2hlcyA9IHBhdGgubWF0Y2goL15bXlxcL10rXFwvKC4rKSQvKTtcblxuICBpZiAobWF0Y2hlcyAhPT0gbnVsbCkge1xuICAgIGNvbnN0IHNlY29uZE1hdGNoID0gc2Vjb25kKG1hdGNoZXMpO1xuXG4gICAgcGF0aFdpdGhvdXRUb3Btb3N0RGlyZWN0b3J5TmFtZSA9IHNlY29uZE1hdGNoO1xuICB9XG5cbiAgcmV0dXJuIHBhdGhXaXRob3V0VG9wbW9zdERpcmVjdG9yeU5hbWU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpc1BhdGhOYW1lLFxuICBpc1BhdGhUb3Btb3N0TmFtZSxcbiAgaXNQYXRoUmVsYXRpdmVQYXRoLFxuICBpc1BhdGhBYnNvbHV0ZVBhdGgsXG4gIGlzVG9wbW9zdE5hbWVJbkFic29sdXRlUGF0aCxcbiAgY29tYmluZVBhdGhzLFxuICBjb25jYXRlbmF0ZVBhdGhzLFxuICBib3R0b21tb3N0TmFtZUZyb21QYXRoLFxuICB0b3Btb3N0RGlyZWN0b3J5UGF0aEZyb21QYXRoLFxuICB0b3Btb3N0RGlyZWN0b3J5TmFtZUZyb21QYXRoLFxuICBwYXRoV2l0aG91dEJvdHRvbW1vc3ROYW1lRnJvbVBhdGgsXG4gIHBhdGhXaXRob3V0VG9wbW9zdERpcmVjdG9yeU5hbWVGcm9tUGF0aFxufTtcbiJdfQ==