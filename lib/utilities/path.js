'use strict';

var arrayUtilities = require('../utilities/array');

var first = arrayUtilities.first,
    second = arrayUtilities.second,
    last = arrayUtilities.last;


function isPathName(path) {
  path = path.replace(/^\//, '').replace(/\/$/, ''); ///

  var pathName = /\//.test(path) === false;

  return pathName;
}

function isPathTopmostName(path) {
  var pathName = isPathName(path),
      pathAbsolutePath = isPathAbsolutePath(path),
      pathTopmostName = pathName && pathAbsolutePath;

  return pathTopmostName;
}

function isPathRelativePath(path) {
  var pathRelativePath = !/^\//.test(path);

  return pathRelativePath;
}

function isPathAbsolutePath(path) {
  var pathAbsolutePath = /^\//.test(path);

  return pathAbsolutePath;
}

function isTopmostNameInAbsolutePath(topmostName, absolutePath) {
  var regExp = new RegExp('^' + topmostName + '(?:\\/.+)?$'),
      topmostNameInAbsolutePath = regExp.test(absolutePath);

  return topmostNameInAbsolutePath;
}

function combinePaths(path, relativePath) {
  var combinedPath = null;

  var pathNames = path.split('/'),
      relativePathNames = relativePath.split('/');

  var lastPathName = void 0,
      firstRelativePathName = first(relativePathNames);

  if (firstRelativePathName === '.') {
    relativePathNames.shift();
  }

  firstRelativePathName = first(relativePathNames);
  lastPathName = last(pathNames);

  while (firstRelativePathName === '..' && lastPathName !== undefined) {
    relativePathNames.shift();
    pathNames.pop();

    firstRelativePathName = first(relativePathNames);
    lastPathName = last(pathNames);
  }

  if (lastPathName !== undefined) {
    var combinedPathNames = [].concat(pathNames).concat(relativePathNames);

    combinedPath = combinedPathNames.join('/');
  }

  return combinedPath;
}

function concatenatePaths(path, relativePath) {
  path = path.replace(/\/$/, ''); ///

  var concatenatedPath = path + '/' + relativePath;

  return concatenatedPath;
}

function bottommostNameFromPath(path) {
  var bottommostName = null;

  var matches = path.match(/^.*\/([^\/]+\/?)$/);

  if (matches !== null) {
    var secondMatch = second(matches);

    bottommostName = secondMatch; ///
  }

  return bottommostName;
}

function topmostDirectoryPathFromPath(path) {
  var matches = path.match(/^(.+)\/[^\/]+\/?$/),
      secondMatch = second(matches),
      topmostDirectoryPath = secondMatch; ///

  return topmostDirectoryPath;
}

function topmostDirectoryNameFromPath(path) {
  var topmostDirectoryName = null;

  var matches = path.match(/^([^\/]+)\/.+$/);

  if (matches !== null) {
    var secondMatch = second(matches);

    topmostDirectoryName = secondMatch; ///
  }

  return topmostDirectoryName;
}

function pathWithoutBottommostNameFromPath(path) {
  var pathWithoutBottommostName = null;

  var matches = path.match(/^(.*)\/[^\/]+\/?$/);

  if (matches !== null) {
    var secondMatch = second(matches);

    pathWithoutBottommostName = secondMatch; ///
  }

  return pathWithoutBottommostName;
}

function pathWithoutTopmostDirectoryNameFromPath(path) {
  var pathWithoutTopmostDirectoryName = null;

  var matches = path.match(/^[^\/]+\/(.+)$/);

  if (matches !== null) {
    var secondMatch = second(matches);

    pathWithoutTopmostDirectoryName = secondMatch;
  }

  return pathWithoutTopmostDirectoryName;
}

module.exports = {
  isPathName: isPathName,
  isPathTopmostName: isPathTopmostName,
  isPathRelativePath: isPathRelativePath,
  isPathAbsolutePath: isPathAbsolutePath,
  isTopmostNameInAbsolutePath: isTopmostNameInAbsolutePath,
  combinePaths: combinePaths,
  concatenatePaths: concatenatePaths,
  bottommostNameFromPath: bottommostNameFromPath,
  topmostDirectoryPathFromPath: topmostDirectoryPathFromPath,
  topmostDirectoryNameFromPath: topmostDirectoryNameFromPath,
  pathWithoutBottommostNameFromPath: pathWithoutBottommostNameFromPath,
  pathWithoutTopmostDirectoryNameFromPath: pathWithoutTopmostDirectoryNameFromPath
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsaXRpZXMvcGF0aC5qcyJdLCJuYW1lcyI6WyJhcnJheVV0aWxpdGllcyIsInJlcXVpcmUiLCJmaXJzdCIsInNlY29uZCIsImxhc3QiLCJpc1BhdGhOYW1lIiwicGF0aCIsInJlcGxhY2UiLCJwYXRoTmFtZSIsInRlc3QiLCJpc1BhdGhUb3Btb3N0TmFtZSIsInBhdGhBYnNvbHV0ZVBhdGgiLCJpc1BhdGhBYnNvbHV0ZVBhdGgiLCJwYXRoVG9wbW9zdE5hbWUiLCJpc1BhdGhSZWxhdGl2ZVBhdGgiLCJwYXRoUmVsYXRpdmVQYXRoIiwiaXNUb3Btb3N0TmFtZUluQWJzb2x1dGVQYXRoIiwidG9wbW9zdE5hbWUiLCJhYnNvbHV0ZVBhdGgiLCJyZWdFeHAiLCJSZWdFeHAiLCJ0b3Btb3N0TmFtZUluQWJzb2x1dGVQYXRoIiwiY29tYmluZVBhdGhzIiwicmVsYXRpdmVQYXRoIiwiY29tYmluZWRQYXRoIiwicGF0aE5hbWVzIiwic3BsaXQiLCJyZWxhdGl2ZVBhdGhOYW1lcyIsImxhc3RQYXRoTmFtZSIsImZpcnN0UmVsYXRpdmVQYXRoTmFtZSIsInNoaWZ0IiwidW5kZWZpbmVkIiwicG9wIiwiY29tYmluZWRQYXRoTmFtZXMiLCJjb25jYXQiLCJqb2luIiwiY29uY2F0ZW5hdGVQYXRocyIsImNvbmNhdGVuYXRlZFBhdGgiLCJib3R0b21tb3N0TmFtZUZyb21QYXRoIiwiYm90dG9tbW9zdE5hbWUiLCJtYXRjaGVzIiwibWF0Y2giLCJzZWNvbmRNYXRjaCIsInRvcG1vc3REaXJlY3RvcnlQYXRoRnJvbVBhdGgiLCJ0b3Btb3N0RGlyZWN0b3J5UGF0aCIsInRvcG1vc3REaXJlY3RvcnlOYW1lRnJvbVBhdGgiLCJ0b3Btb3N0RGlyZWN0b3J5TmFtZSIsInBhdGhXaXRob3V0Qm90dG9tbW9zdE5hbWVGcm9tUGF0aCIsInBhdGhXaXRob3V0Qm90dG9tbW9zdE5hbWUiLCJwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lRnJvbVBhdGgiLCJw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T00seUJBQVA7QUFDRDs7QUFFRCxTQUFTQyx1Q0FBVCxDQUFpRDNDLElBQWpELEVBQXVEO0FBQ3JELE1BQUk0QyxrQ0FBa0MsSUFBdEM7O0FBRUEsTUFBTVYsVUFBVWxDLEtBQUttQyxLQUFMLENBQVcsZ0JBQVgsQ0FBaEI7O0FBRUEsTUFBSUQsWUFBWSxJQUFoQixFQUFzQjtBQUNwQixRQUFNRSxjQUFjdkMsT0FBT3FDLE9BQVAsQ0FBcEI7O0FBRUFVLHNDQUFrQ1IsV0FBbEM7QUFDRDs7QUFFRCxTQUFPUSwrQkFBUDtBQUNEOztBQUVEQyxPQUFPQyxPQUFQLEdBQWlCO0FBQ2YvQyx3QkFEZTtBQUVmSyxzQ0FGZTtBQUdmSSx3Q0FIZTtBQUlmRix3Q0FKZTtBQUtmSSwwREFMZTtBQU1mTSw0QkFOZTtBQU9mYyxvQ0FQZTtBQVFmRSxnREFSZTtBQVNmSyw0REFUZTtBQVVmRSw0REFWZTtBQVdmRSxzRUFYZTtBQVlmRTtBQVplLENBQWpCIiwiZmlsZSI6InBhdGguanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IGFycmF5VXRpbGl0aWVzID0gcmVxdWlyZSgnLi4vdXRpbGl0aWVzL2FycmF5Jyk7XG5cbmNvbnN0IHsgZmlyc3QsIHNlY29uZCwgbGFzdCB9ID0gYXJyYXlVdGlsaXRpZXM7XG5cbmZ1bmN0aW9uIGlzUGF0aE5hbWUocGF0aCkge1xuICBwYXRoID0gcGF0aC5yZXBsYWNlKC9eXFwvLywnJykucmVwbGFjZSgvXFwvJC8sICcnKTsgLy8vXG5cbiAgY29uc3QgcGF0aE5hbWUgPSAoL1xcLy8udGVzdChwYXRoKSA9PT0gZmFsc2UpO1xuXG4gIHJldHVybiBwYXRoTmFtZTtcbn1cblxuZnVuY3Rpb24gaXNQYXRoVG9wbW9zdE5hbWUocGF0aCkge1xuICBjb25zdCBwYXRoTmFtZSA9IGlzUGF0aE5hbWUocGF0aCksXG4gICAgICAgIHBhdGhBYnNvbHV0ZVBhdGggPSBpc1BhdGhBYnNvbHV0ZVBhdGgocGF0aCksXG4gICAgICAgIHBhdGhUb3Btb3N0TmFtZSA9IChwYXRoTmFtZSAmJiBwYXRoQWJzb2x1dGVQYXRoKTtcblxuICByZXR1cm4gcGF0aFRvcG1vc3ROYW1lO1xufVxuXG5mdW5jdGlvbiBpc1BhdGhSZWxhdGl2ZVBhdGgocGF0aCkge1xuICBjb25zdCBwYXRoUmVsYXRpdmVQYXRoID0gIS9eXFwvLy50ZXN0KHBhdGgpO1xuXG4gIHJldHVybiBwYXRoUmVsYXRpdmVQYXRoO1xufVxuXG5mdW5jdGlvbiBpc1BhdGhBYnNvbHV0ZVBhdGgocGF0aCkge1xuICBjb25zdCBwYXRoQWJzb2x1dGVQYXRoID0gL15cXC8vLnRlc3QocGF0aCk7XG5cbiAgcmV0dXJuIHBhdGhBYnNvbHV0ZVBhdGg7XG59XG5cbmZ1bmN0aW9uIGlzVG9wbW9zdE5hbWVJbkFic29sdXRlUGF0aCh0b3Btb3N0TmFtZSwgYWJzb2x1dGVQYXRoKSB7XG4gIGNvbnN0IHJlZ0V4cCA9IG5ldyBSZWdFeHAoYF4ke3RvcG1vc3ROYW1lfSg/OlxcXFwvLispPyRgKSxcbiAgICAgICAgdG9wbW9zdE5hbWVJbkFic29sdXRlUGF0aCA9IHJlZ0V4cC50ZXN0KGFic29sdXRlUGF0aCk7XG5cbiAgcmV0dXJuIHRvcG1vc3ROYW1lSW5BYnNvbHV0ZVBhdGhcbn1cblxuZnVuY3Rpb24gY29tYmluZVBhdGhzKHBhdGgsIHJlbGF0aXZlUGF0aCkge1xuICBsZXQgY29tYmluZWRQYXRoID0gbnVsbDtcblxuICBjb25zdCBwYXRoTmFtZXMgPSBwYXRoLnNwbGl0KCcvJyksXG4gICAgICAgIHJlbGF0aXZlUGF0aE5hbWVzID0gcmVsYXRpdmVQYXRoLnNwbGl0KCcvJyk7XG5cbiAgbGV0IGxhc3RQYXRoTmFtZSxcbiAgICAgIGZpcnN0UmVsYXRpdmVQYXRoTmFtZSA9IGZpcnN0KHJlbGF0aXZlUGF0aE5hbWVzKTtcblxuICBpZiAoZmlyc3RSZWxhdGl2ZVBhdGhOYW1lID09PSAnLicpIHtcbiAgICByZWxhdGl2ZVBhdGhOYW1lcy5zaGlmdCgpO1xuICB9XG5cbiAgZmlyc3RSZWxhdGl2ZVBhdGhOYW1lID0gZmlyc3QocmVsYXRpdmVQYXRoTmFtZXMpO1xuICBsYXN0UGF0aE5hbWUgPSBsYXN0KHBhdGhOYW1lcyk7XG5cbiAgd2hpbGUgKChmaXJzdFJlbGF0aXZlUGF0aE5hbWUgPT09ICcuLicpICYmIChsYXN0UGF0aE5hbWUgIT09IHVuZGVmaW5lZCkpIHtcbiAgICByZWxhdGl2ZVBhdGhOYW1lcy5zaGlmdCgpO1xuICAgIHBhdGhOYW1lcy5wb3AoKTtcblxuICAgIGZpcnN0UmVsYXRpdmVQYXRoTmFtZSA9IGZpcnN0KHJlbGF0aXZlUGF0aE5hbWVzKTtcbiAgICBsYXN0UGF0aE5hbWUgPSBsYXN0KHBhdGhOYW1lcyk7XG4gIH1cblxuICBpZiAobGFzdFBhdGhOYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICBjb25zdCBjb21iaW5lZFBhdGhOYW1lcyA9IFtdLmNvbmNhdChwYXRoTmFtZXMpLmNvbmNhdChyZWxhdGl2ZVBhdGhOYW1lcyk7XG5cbiAgICBjb21iaW5lZFBhdGggPSBjb21iaW5lZFBhdGhOYW1lcy5qb2luKCcvJyk7XG4gIH1cblxuICByZXR1cm4gY29tYmluZWRQYXRoO1xufVxuXG5mdW5jdGlvbiBjb25jYXRlbmF0ZVBhdGhzKHBhdGgsIHJlbGF0aXZlUGF0aCkge1xuICBwYXRoID0gcGF0aC5yZXBsYWNlKC9cXC8kLywgJycpOyAgLy8vXG5cbiAgY29uc3QgY29uY2F0ZW5hdGVkUGF0aCA9IGAke3BhdGh9LyR7cmVsYXRpdmVQYXRofWA7XG5cbiAgcmV0dXJuIGNvbmNhdGVuYXRlZFBhdGg7XG59XG5cbmZ1bmN0aW9uIGJvdHRvbW1vc3ROYW1lRnJvbVBhdGgocGF0aCkge1xuICBsZXQgYm90dG9tbW9zdE5hbWUgPSBudWxsO1xuXG4gIGNvbnN0IG1hdGNoZXMgPSBwYXRoLm1hdGNoKC9eLipcXC8oW15cXC9dK1xcLz8pJC8pO1xuXG4gIGlmIChtYXRjaGVzICE9PSBudWxsKSB7XG4gICAgY29uc3Qgc2Vjb25kTWF0Y2ggPSBzZWNvbmQobWF0Y2hlcyk7XG5cbiAgICBib3R0b21tb3N0TmFtZSA9IHNlY29uZE1hdGNoOyAgLy8vXG4gIH1cblxuICByZXR1cm4gYm90dG9tbW9zdE5hbWU7XG59XG5cbmZ1bmN0aW9uIHRvcG1vc3REaXJlY3RvcnlQYXRoRnJvbVBhdGgocGF0aCkge1xuICBjb25zdCBtYXRjaGVzID0gcGF0aC5tYXRjaCgvXiguKylcXC9bXlxcL10rXFwvPyQvKSxcbiAgICAgICAgc2Vjb25kTWF0Y2ggPSBzZWNvbmQobWF0Y2hlcyksXG4gICAgICAgIHRvcG1vc3REaXJlY3RvcnlQYXRoID0gc2Vjb25kTWF0Y2g7IC8vL1xuXG4gIHJldHVybiB0b3Btb3N0RGlyZWN0b3J5UGF0aDtcbn1cblxuZnVuY3Rpb24gdG9wbW9zdERpcmVjdG9yeU5hbWVGcm9tUGF0aChwYXRoKSB7XG4gIGxldCB0b3Btb3N0RGlyZWN0b3J5TmFtZSA9IG51bGw7XG5cbiAgY29uc3QgbWF0Y2hlcyA9IHBhdGgubWF0Y2goL14oW15cXC9dKylcXC8uKyQvKTtcblxuICBpZiAobWF0Y2hlcyAhPT0gbnVsbCkge1xuICAgIGNvbnN0IHNlY29uZE1hdGNoID0gc2Vjb25kKG1hdGNoZXMpO1xuXG4gICAgdG9wbW9zdERpcmVjdG9yeU5hbWUgPSBzZWNvbmRNYXRjaDsgIC8vL1xuICB9XG5cbiAgcmV0dXJuIHRvcG1vc3REaXJlY3RvcnlOYW1lO1xufVxuXG5mdW5jdGlvbiBwYXRoV2l0aG91dEJvdHRvbW1vc3ROYW1lRnJvbVBhdGgocGF0aCkge1xuICBsZXQgcGF0aFdpdGhvdXRCb3R0b21tb3N0TmFtZSA9IG51bGw7XG5cbiAgY29uc3QgbWF0Y2hlcyA9IHBhdGgubWF0Y2goL14oLiopXFwvW15cXC9dK1xcLz8kLyk7XG5cbiAgaWYgKG1hdGNoZXMgIT09IG51bGwpIHtcbiAgICBjb25zdCBzZWNvbmRNYXRjaCA9IHNlY29uZChtYXRjaGVzKTtcblxuICAgIHBhdGhXaXRob3V0Qm90dG9tbW9zdE5hbWUgPSBzZWNvbmRNYXRjaDsgLy8vXG4gIH1cblxuICByZXR1cm4gcGF0aFdpdGhvdXRCb3R0b21tb3N0TmFtZTtcbn1cblxuZnVuY3Rpb24gcGF0aFdpdGhvdXRUb3Btb3N0RGlyZWN0b3J5TmFtZUZyb21QYXRoKHBhdGgpIHtcbiAgbGV0IHBhdGhXaXRob3V0VG9wbW9zdERpcmVjdG9yeU5hbWUgPSBudWxsO1xuXG4gIGNvbnN0IG1hdGNoZXMgPSBwYXRoLm1hdGNoKC9eW15cXC9dK1xcLyguKykkLyk7XG5cbiAgaWYgKG1hdGNoZXMgIT09IG51bGwpIHtcbiAgICBjb25zdCBzZWNvbmRNYXRjaCA9IHNlY29uZChtYXRjaGVzKTtcblxuICAgIHBhdGhXaXRob3V0VG9wbW9zdERpcmVjdG9yeU5hbWUgPSBzZWNvbmRNYXRjaDtcbiAgfVxuXG4gIHJldHVybiBwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgaXNQYXRoTmFtZSxcbiAgaXNQYXRoVG9wbW9zdE5hbWUsXG4gIGlzUGF0aFJlbGF0aXZlUGF0aCxcbiAgaXNQYXRoQWJzb2x1dGVQYXRoLFxuICBpc1RvcG1vc3ROYW1lSW5BYnNvbHV0ZVBhdGgsXG4gIGNvbWJpbmVQYXRocyxcbiAgY29uY2F0ZW5hdGVQYXRocyxcbiAgYm90dG9tbW9zdE5hbWVGcm9tUGF0aCxcbiAgdG9wbW9zdERpcmVjdG9yeVBhdGhGcm9tUGF0aCxcbiAgdG9wbW9zdERpcmVjdG9yeU5hbWVGcm9tUGF0aCxcbiAgcGF0aFdpdGhvdXRCb3R0b21tb3N0TmFtZUZyb21QYXRoLFxuICBwYXRoV2l0aG91dFRvcG1vc3REaXJlY3RvcnlOYW1lRnJvbVBhdGhcbn07XG4iXX0=